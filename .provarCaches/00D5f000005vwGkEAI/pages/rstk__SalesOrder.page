<apex:page id="pg" standardController="rstk__sohdr__c" extensions="rstk.ControllerExtnSalesOrder,rstk.ControllerExtnSalesOrderHelper,rstk.ControllerJobStatus" 
    action="{!doBeforePageLoad}" sideBar="false">
    <apex:variable var="o" value="{!sohdr}" />
    <apex:variable var="f" value="{!$ObjectType.rstk__sohdr__c.fields}" />
    <apex:variable var="f_extn" value="{!$ObjectType.rstk__sohdrextn__c.fields}" />
    <apex:variable var="f_sl" value="{!$ObjectType.rstk__soline__c.fields}" />
    <apex:variable var="f_slextn" value="{!$ObjectType.rstk__solineextn__c.fields}" />
    <apex:variable var="f_socust" value="{!$ObjectType.rstk__socust__c.fields}" />
    <apex:variable var="f_soaddr" value="{!$ObjectType.rstk__soaddr__c.fields}" />
    <apex:variable var="f_socaddr" value="{!$ObjectType.rstk__socaddr__c.fields}" />
    <apex:variable var="f_issue" value="{!$ObjectType.rstk__woiss__c.fields}" />
    <apex:variable var="f_dimvals" value="{!$ObjectType.rstk__dimvals__c.fields}" />
    <apex:variable var="f_icitemsiteproj" value="{!$ObjectType.rstk__icitemsiteproj__c.fields}" />
    <apex:variable var="f_socontainel" value="{!$ObjectType.rstk__socontainel__c.fields}" />
    <apex:variable var="f_socontainer" value="{!$ObjectType.rstk__socontainer__c.fields}" />
    <apex:variable var="f_soshipline" value="{!$ObjectType.rstk__soshipline__c.fields}" />
    <apex:variable var="f_soprod" value="{!$ObjectType.rstk__soprod__c.fields}" />
    <apex:variable var="f_soprod" value="{!$ObjectType.rstk__soprod__c.fields}" />
    <apex:variable var="f_pkg" value="{!$ObjectType.rstk__sopackage__c.fields}" />
    <apex:variable var="f_ctype" value="{!$ObjectType.rstk__socontype__c.fields}" />
    <apex:variable var="f_customext" value="{!$ObjectType.rstk__customext__c.fields}" />
      
    <c:sohdr_cli_labels />
    <style>
            td.pbTitle { width:0% !important; }
    </style>
    <script>var pageOptions = {!pageOptionsJSON};</script>
    <c:standardHeader cntr="{!controller}" title="{!IF(isQuote,$Label.rstk__quote,$Label.rstk__sales_order)}" displayListLink="true" enableAutocomplete="true"/>
    <script>var standalone_sohdr={!isStandaloneHeader};</script>
    <apex:includeScript value="{!$Resource.rstk__sublist}"/>
    <apex:includeScript value="{!$Resource.rstk__sohdr_cli}"/>
    <apex:includeScript value="{!$Resource.rstk__jquerytoolsoverlay}" />
    <apex:stylesheet value="{!$Resource.rstk__ModalPopup_css}"/>
    <apex:includeScript value="{!$Resource.rstk__RowHandler_js}"/>
    <apex:includeScript value="{!$Resource.rstk__geoservices_cli}"/>
    
    <style>
            .modal {
                background-color:#fff;
                display:none;
                width:800px;
                padding:15px;
                text-align:left;
                font-size:1em;
                border:2px solid #333;
            
                opacity:1.0;
                -moz-border-radius:6px;
                -webkit-border-radius:6px;
                -moz-box-shadow: 0 0 50px #ccc;
                -webkit-box-shadow: 0 0 50px #ccc;
            }
            
            .modal h2 {
                margin:0px;
                padding:10px 0 10px 45px;
                font-size:16px;
            }
            
            .modalComponents {
                color:#efefef;
                height:600px;
                width:900px;
                z-index:100;
            }
            
            /* container for external content. uses vertical scrollbar, if needed */
            .contentWrap {
              height:441px;
              overflow-y:auto;
              z-index:100;
            }
                
            div.hideCurrDate span.dateInput span.dateFormat{
                display:none;
            }
            
            .issueComments {
                width: 250px;
                height: 60px;
                border: 3px solid #cccccc;
                padding: 5px;
                font-family: Tahoma, sans-serif;
            }
            
            #datePicker .datePicker
            {
                z-index: 10012;
            }
            
            input[readonly="readonly"]
            {
                border:none;
                background-color:transparent;
                padding:0px;
                font-size:100%;
                margin:0px;
            }
            
            .helpText
            {
                z-index:11000;
            }

            .topFrame
            {
                z-index:20100;
            }
                        
            .largerLabel td { width:50% !important; }
            
        .modalPopup{
            background-color: white;
            border-style: solid;
            border-width: 3px;
            padding:1px;
            position: absolute;
            z-index: 10011;
            width: 650px;
            top:100px;
            overflow:auto;
        }
        .topPopup{
            background-color: transparent;
            border-style: none;
            position: absolute;
            z-index: 20001;
            width: 50px;
            top:100px;
        }
        .popupBackground{
            background-color:black;
            opacity: 0.20;
            position:absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 10010;
        }
        .topPopupBackground{
            background-color:green;
            opacity: 0.10;
            position:absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 20000;
        }
 
       input.elwarning {
         }

       span.spwarning {
           color:#FF6347;
           font-size:90%;
           padding-left: 6px; 
        }
        .ac_results {
            z-index: 12000;
            background-color: #eee;
        }
    </style>
    
    <script>
        var isNew = {!isNew};
        var socustId = "{!o.rstk__sohdr_custno__c}";
        var sohdrId = "{!o.Id}";
        var divId = "{!o.rstk__sohdr_div__c}";
        var cmpId = "{!currDivision.sydiv_cmpno__c}";
        var custId = "{!o.rstk__sohdr_custno__c}";
        var defaultProductType = "{!socust.socust_dfltprodtype__c}";
        var maintenanceCurrencySymbol = '{!maintenanceCurrencySymbol}';
        var socaddr = {!socaddr};
        var lineAddresses = {!LineAddresses};
        var soaddrTemplate = {!soaddrTemplate};
        var SolineExtns = {!SolineExtns};
        var lineCustomFields = new Object();
        var editingProductNames = {!editingProductNames};
        var editingProjectNames = {!editingProjectNames};
        var addressVerificationEnabled = {!geoStatus.addressVerification};
        var taxLookupEnabled = {!geoStatus.taxLookup};
        var taxLookupAuto = {!geoStatus.auto};
        var lookupExcluded = {!geoStatus.excluded};
        var taxCodes = {!geoTaxCodesJSON};
        var isQuote = {!isQuote};
        var wasQuote = {!wasQuote};
        var validateAddr = new GeoService();
        validateAddr.setTax = setValidatedTax;
        validateAddr.init(divId, 'soaddr');
        var projOptions = {!projectOptionsJSON};
        var socntl = {!socntlJSON};
        var numDims = {!numDims};
        var projectDimensions = {!projectDimensionsJSON};
        var templateOverride = {!templateOverride};
        var defaultTemplate = '{!defaultTemplate}';
        var anyLinesPackaged = {!anyLinesPackaged};
        var complexOpRequired = {!complexOpRequired};
        var andNewFlag = {!andNewFlag};
        var readOnlyUser = {!readOnlyUser};
        var maxGlobalLineUpdates = {!maxGlobalLineUpdates};
        var excessGlobalLinesMessage = {!excessGlobalLinesMessage};
        var solineMetaData = new MetaData({!solineMetadata});
        var sohdrMetaData = new MetaData({!sohdrMetadata});
        var isRootStockFinancials = "{!isRootStockFinancials}";
        var rsfnsp = "{!rsfnsp}";
        var wbsActive = {!isChargeCodeActive};
        var minimumProductCharacters = {!ProdMinCharForAutoComplete};
        var allowDecoupleAccess = {!soh.AllowDecoupleAccess };
        var isRootDox = {!isRootDox};// RSTK-1274
        var isRootDoxforPL = {!isRootDoxforPL};// RSTK-1274
        var defaultTemplateForDox = '{!defaultTemplateForDox}';// RSTK-1274
        var customMinCharForAutoComplete = {!customMinCharForAutoComplete};
        var printDOXTeamplateVar;
        var isZipCodeRequired = {!isZipCodeRequired};
        var MaxSOLines = {!MaxSOLines};
		var sohdr_custcurrency = "{!o.rstk__sohdr_custcurrency__c}";
    	var SYFOREXSCHEDNO_Schedtype_3 = "{!SYFOREXSCHEDNO_Schedtype_3}";
        var SYFOREXSCHEDNO_Schedtype_Override_Rate = "{!SYFOREXSCHEDNO_Schedtype_Override_Rate}";

        function addAfterEvent(func) {
          var oldafter = window.afterPageLoad;
          if (typeof window.afterPageLoad != 'function') {
            window.afterPageLoad = func;
          } else {
            window.afterPageLoad = function() {
              if (oldafter) {
                oldafter();
              }
              func();
            }
          }
        }   
        sforce.connection.sessionId = __sfdcSessionId;
        
        function jqueryOnReady() {
            getSOLineRows().each(function(index, node) {
                var classAttr = node.getAttribute('class');
                if (classAttr != null && classAttr.indexOf('first') < 0) {
                    if (jQuery(node).find('[name*="soline_removeind__c"]').val() == 'true') {
                        node.style.display = "none";
                    }
                }
            });
            
            if (addressVerificationEnabled) {
                jQuery("input.addressField").change(addressInputChanged);
            }
            
            try {
                lineCustomFields = {!linecustomfieldString};
                lineCustomFieldTypes = {!lineCustomFieldTypesJSON};
            } catch(Exception) {}
            
            jQuery("button[rel*=popup]").overlay({
            
                top: "10%",
            
                // some mask tweaks suitable for modal dialogs
                mask: {
                    color: '#ebecff',
                    loadSpeed: 200,
                    opacity: 0.8
                },
            
                fixed:false,
                
                closeOnClick: false
            });
            
            jQuery("button[rel*=win]").overlay({
                mask: {
                    color: '#ebecff',
                    loadSpeed: 200,
                    opacity: 0.8
                },
                
                fixed:false,
                closeOnClick: false,
                
                onBeforeLoad: function(e) {
                    var winId = e.target.getTrigger().attr('class').substring(3);
                    var content = jQuery("#"+winId+'Frame');
                    var blockWin =content.closest('div');
  
                    var src = null;

                    if (winId == 'PopupComponents')
                    {
                        var componentLine = sfffGetFieldValue('component_lineid__c');
                        src = "/apex/salesorderComponents?actionType=view&noredirect=1&id=" + componentLine;
                    }
                    else if (winId == 'PopupATP')
                    {
                        src = "/apex/SupDmdRev?rsparms=H~" + icitemid + "~~MONTHLY~12";
                    }
                    else if (winId == 'PopupNotesAttachments')
                    {
                        var notesLine = sfffGetFieldValue('notes_lineid__c');
                        //src = "/apex/solinenotes?id=" + notesLine;
                        src = "/apex/Notesandattachments?objname=soline__c&id=" + notesLine;
                    }
                    else if (winId == 'PopupSerials')
                    {
                        var notesLine = sfffGetFieldValue('notes_lineid__c');
                        src = "/apex/SOLineSers?id=" + notesLine;
                    }
                    else if (winId == 'PopupPayment')
                    {
                        src = "/apex/sopayment?id=" + sohdrId;
                    }
                                        
                    if (src != null)
                    {
                        blockWin.block({
                            message: '',
                            centerX: true, 
                            centerY: true,
                            css: { 
                                border: 'none', 
                                padding: '15px', 
                                cursor: 'wait',
                                opacity: .5, 
                                textAlign: 'center'
                            }
                        });
                        content[0].src = src;
                        
                        content.load(function() { blockWin.unblock(); });
                    }
                }
            });
        }
        function getJobFailMessage(processLog) {
          displayProcessErrorsAsPageMessage("{!$Label.errors}:", processLog); return null; 
        }
        
        function getJobSuccessMessage(processLog) {
          // The job message will be displayed in the info section, nothing to do here
          
          return null;
        }

    </script>
        
    <apex:form id="fm" rendered="{!displayPageContent}" style="{!IF(complexOpRequired,'display:none;', '')}">
        <apex:actionFunction name="doSave" action="{!save}" rerender="pageMessages,statusPanel" oncomplete="if ({!soh.saveAsBatchJob}) { checkJobStatus(); } else { unblockUI();checkForReSubmit(); }"/>
        <apex:actionFunction name="doNew" action="{!newSO}" immediate="true"/>
        <apex:actionFunction name="doView" action="{!view}" immediate="true"/>
        <apex:actionFunction name="loadAdditionalLines" action="{!loadAdditionalLines}" 
            oncomplete="unblockUI();initLines();" rerender="pageMessages, pbt_lineitems" immediate="false" />
        <apex:actionFunction name="firmLines" action="{!firmLines}" oncomplete="unblockUI();" rerender="pageMessages" />
        <apex:actionFunction name="issueOrder" action="{!issueOrder}" oncomplete="unblockUI();" rerender="pageMessages" />
        <apex:actionFunction name="validateDateAgainstCalendar" id="validateDateAgainstCalendar" immediate="true" action="{!validateDateAgainstCalendar}" rerender="pageMessages">
             <apex:param name="divId" value=""/>
             <apex:param name="date" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="doConvertQuoteToOrder" action="{!convertQuoteToOrder}" immediate="false" oncomplete="unblockUI();" rerender="pageMessages"/>
        <apex:actionFunction name="fnChangeCustomer" id="fnChangeCustomer" immediate="true" action="{!changeCustomer}" rerender="pageMessages" oncomplete="unblockUI();">
             <apex:param name="newCustomer" value=""/>
             <apex:param name="updateCustomerDefaults" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="fnSoImport" id="fnSoImport" immediate="false" action="{!soImport}"/>
        <apex:actionFunction name="doAddNewProduct" action="{!addNewProduct}" immediate="false" oncomplete="addProductCompleted();" rerender="pageMessages, addProductPanel"/>
        <apex:actionFunction name="performDealPriceAllocation" action="{!performDealPriceAllocation}" oncomplete="closeTopDialog();" rerender="pageMessages"/>
        <apex:actionFunction name="fnSetDueDateOnLines" id="fnSetDueDateOnLines" immediate="true" action="{!setDueDateOnLines}" 
          rerender="pageMessages" oncomplete="unblockUI();">
             <apex:param name="dueDate" value=""/>
             <apex:param name="dueDatePartials" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="doAutoCreateSOPicklist" id="autoCreateSOPicklist" immediate="true" action="{!autoCreateSOPicklist}" oncomplete="checkJobStatus();" rerender="pageMessages,statusPanel, autuCreateSoPicklistVars" />
        <apex:actionFunction name="globalLineUpdate" action="{!globalLineUpdate}" status="pleaseWaitStatus" immediate="true" reRender="">
             <apex:param name="caseId" value=""/>
             <apex:param name="carrierId" value=""/>
             <apex:param name="shipviaId" value=""/>
             <apex:param name="fobId" value=""/>
             <apex:param name="ftermsId" value=""/>
             <apex:param name="sydivaddrId" value=""/>
             <apex:param name="dimvVals" value=""/>
             <apex:param name="dimLines" value=""/>
             <apex:param name="caseLines" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="updateAllTaxLinesOnServer" id="updateAllTaxLinesOnServer" immediate="true" action="{!updateAllTaxLinesOnServer}" rerender="pageMessages" oncomplete="unblockUI();"/>
        <apex:actionFunction name="doDecoupleWorkOrder" id="doDecoupleWorkOrder" immediate="true" action="{!doDecoupleWorkOrder}" rerender="pageMessages" oncomplete="unblockUI();">
             <apex:param name="lineNum" value="0"/>
        </apex:actionFunction>
        <apex:actionFunction name="doReloadPage" id="doReloadPage" immediate="true" action="{!reloadPage}" rerender="pageMessages" oncomplete="unblockUI();">
             <apex:param name="warningsText" value=""/>
             <apex:param name="sohdrId" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="buildPrintRecords" id="buildPrintRecords" immediate="false" action="{!buildPrintRecords}" rerender="pageMessages" oncomplete="unblockUI();doxPrint();" />
        <apex:actionFunction name="checkForOverrideExchangePopUp" id="checkForOverrideExchangePopUp" immediate="false" action="{!checkForOverrideExchangePopUp}" rerender="pageMessages,op_ovrExch" oncomplete="showOverrideexchratePopup();" />
        <apex:actionFunction name="exchrateScheduleChanged" action="{!exchrateScheduleChanged}" rerender="pageMessages,so_override_schedule__c" immediate="false" status="pleaseWaitStatus" oncomplete="unblockPopupUI('pleaseWaitPopup');">
        	<apex:param name="exchrate_schedule" assignTo="{!customext.rstk__so_exchrate_schedule__c}" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="overrideScheduleChanged" action="{!overrideScheduleChanged}" rerender="pageMessages,so_override_exchrate" immediate="false" status="pleaseWaitStatus" oncomplete="unblockPopupUI('pleaseWaitPopup'); overideScheduleComplete();">
        	<apex:param name="override_schedule" assignTo="{!customext.rstk__so_override_schedule__c}" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="saveOverrideRate" action="{!saveOverrideRate}" rerender="pageMessages,ovrExchSaveResultString" immediate="false" status="pleaseWaitStatus" oncomplete="postSaveOverrideRate();">
        	<apex:param name="exchrate_schedule" assignTo="{!customext.rstk__so_exchrate_schedule__c}" value=""/>
            <apex:param name="override_schedule" assignTo="{!customext.rstk__so_override_schedule__c}" value=""/>
            <apex:param name="override_exchrate" assignTo="{!customext.rstk__so_override_exchrate__c}" value=""/>
            <apex:param name="isReverse" assignTo="{!isReverseExchRate}" value=""/>
        </apex:actionFunction>
        <apex:outputPanel id="op_ovrExch">
            <script>
                var ovrOrLockSyfoexs = "{!ovrOrLockSyfoexs}";   
            	var lockInSyforexschedNoMapSize = "{!lockInSyforexschedNoMapSize}"; 
            	var overrideSyforexschedNoMapSize = "{!overrideSyforexschedNoMapSize}"; 
                var isSyForexOtherThanCurrSpotRate = "{!isSyForexOtherThanCurrSpotRate}";
            </script>
        </apex:outputPanel>
        <input name="isSubmit" type="hidden"/>
        <input name="locNums" type="hidden"/>
        <input name="customerNo" type="hidden"/>
        <input name="solineaddrstring" type="hidden" />
        <input name="solineextnstring" type="hidden" />
        <input name="linecustomfieldstring" type="hidden" />
        <apex:inputHidden id="ovrExchSaveResultString" value="{!ovrExchSaveResultString}" />
        <apex:inputHidden id="editingProductNames" value="{!editingProductNames}"/>
        <apex:inputHidden id="editingProjectNames" value="{!editingProjectNames}"/>
        <apex:inputHidden id="projectDimValues" value="{!projectDimValues}"/>
        <apex:inputHidden id="productUpdates" value="{!productUpdates}"/>
        <apex:inputHidden id="fname" value="{!fname}"/>
        <apex:inputHidden id="ftext" value="{!ftext}"/>
        <apex:inputHidden id="firmAllLines" value="{!firmAllLines}"/>
        <apex:inputHidden id="sohdr_triggercount__c" value="{!o.rstk__triggercount__c}" />
        <apex:outputText id="initial_sohdr_ordertotal__c" value="{!o.rstk__sohdr_ordertotal__c}" style="display:none;"/>
        <apex:outputText id="initial_sohdr_equipSale__c" value="{!o.rstk__sohdr_equipsale__c}" style="display:none;"/>
        <apex:outputText id="initial_sohdr_discountable__c" value="{!o.rstk__sohdr_discountable__c}" style="display:none;"/>
        <apex:outputpanel style="display:none;">
           <span id="initial_sohdr_billtoaddr__c">{!o.rstk__sohdr_billtoaddr__c}</span>
           <span id="initial_sohdr_shiptoaddr__c">{!o.rstk__sohdr_shiptoaddr__c}</span>
           <span id="initial_sohdr_ackaddr__c">{!o.rstk__sohdr_ackaddr__c}</span>
           <span id="initial_sohdr_installaddr__c">{!o.rstk__sohdr_installaddr__c}</span>
        </apex:outputpanel>
        <button style="visibility:hidden" class="btnPopupAddresses" rel="#popupAddresses"></button>
        
        <apex:outputPanel id="statusPanel" style="display:none;">
           resubmit=<apex:outputText id="reSubmitRequired" value="{!reSubmitRequired}"/><br/>
           andNewFlag=<apex:outputText id="andNewFlag" value="{!andNewFlag}"/><br/>
            <input type="hidden" id="processlogId" value="{!soh.processlogId}"/>
        </apex:outputPanel>
        
        <apex:outputPanel id="autuCreateSoPicklistVars">
            <input type="hidden" id="sopickhid" value="{!soh.sopickhid}"/>
            <input type="hidden" id="showPreselectedLocationsOnly" value="{!soh.showPreselectedLocationsOnly}"/>
            <input type="hidden" id="picklistSequence" value="{!soh.picklistSequence}"/>
            <input type="hidden" id="displayInPickSequence" value="{!soh.displayInPickSequence}"/>
            <input type="hidden" id="printSOLineInternalNotes" value="{!soh.printSOLineInternalNotes}"/>
            <input type="hidden" id="printSOLineExternalNotes" value="{!soh.printSOLineExternalNotes}"/>
            <input type="hidden" id="printCustProdNameAndDesc" value="{!soh.printCustProdNameAndDesc}"/>
            <input type="hidden" id="printEnhancedCustInfoInHdr" value="{!soh.printEnhancedCustInfoInHdr}"/>
            <input type="hidden" id="printItemDescription" value="{!soh.printItemDescription}"/>
        </apex:outputPanel>

        <c:Popup popupId="trackPopup" title="{!$Label.rstk__pagepopup_salesorder_salesordershippingdetail}" cancelCaption="{!$Label.rstk__sales_order_close}" rendered="{!o.Id != null}">
            <iframe id="trackFrame" height="400px" width="800px" frameborder="0" src="/apex/SalesOrderTrack?Id={!o.Id}"></iframe>
             <!-- c:FrameGrid height="400px" preLoad="false" jsController="track" page="/apex/SalesOrderTrack" rootId="{!o.Id}"/ -->
        </c:Popup>
        
        <apex:outputPanel id="addProductPanel" style="display:none">
            <apex:inputHidden id="soprod__c" value="{!soprod.rstk__soprod_shiplocid__c}" />
        </apex:outputPanel>
        
        <apex:outputPanel rendered="{!pageOptions.addNewProductEnabled}">    
            <c:Popup popupId="newProductPopup" title="{!$Label.rstk__pagepopup_salesorder_createnewproduct}" okCaption="Create Product" 
                    onOk="createNewProduct();" rendered="{!pageOptions.addNewProductEnabled}">
                    <apex:pageBlockSection columns="1">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!f_soprod.rstk__soprod_comcod__c.label}"/>
                            <apex:outputPanel >
                                <c:LocalSelect id="soprod_comcod__c" value="{!soprod.rstk__soprod_comcod__c}" />
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!f_soprod.rstk__soprod_prodtype__c.label}"/>
                            <apex:outputText id="product_type__c" value="{!soprod.rstk__soprod_prodtype__c}"></apex:outputText>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$Label.rstk__inventorydivision}"/>
                            <c:LocalSelect id="soprod_shipdiv__c" value="{!soprod.rstk__soprod_shipdiv__c}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$Label.rstk__itemnumber}"/>
                            <apex:inputText id="soprod_prod__c" value="{!soprod.rstk__soprod_prod__c}" maxlength="50" style="width:250px"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$Label.rstk__itemdescription}"/>
                            <apex:inputText id="soprod_descr__c" value="{!soprod.rstk__soprod_descr__c}" maxlength="100" style="width:250px"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$Label.rstk__inventorycommoditycode1}"/>
                            <c:LocalSelect id="soprod_iccomcod__c" value="{!soprod.rstk__soprod_shiplocid__c}"/>
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
            </c:Popup>
        </apex:outputPanel>

        <button style="visibility: hidden" class="btnSelectTemplate"
            rel="#winEmailTemplate"></button>
        <div class="modal" id="winEmailTemplate" style="width:450px">
        <h1>{!$Label.rstk__pagetab_salesorder_emailtemplates}</h1>
        <apex:pageBlock >
            <apex:pageBlockSection columns="1">
                <apex:pageBlockSectionItem >
                    <select size="1" id="selected_template__c" style="width:250px;">
                        <option value=""> </option>
                    </select>
                </apex:pageBlockSectionItem>
               </apex:pageBlockSection>
        </apex:pageBlock>
        <button type="button" onclick="template_ok()">{!$Label.salesorder_pagebtn_OK}</button>
        <button type="button" class="close" onclick="template_cancel()">{!$Label.salesorder_pagebtn_Cancel}</button>
        </div>
        
        <div class="modal" id="popupAddresses">
            <h2>{!$Label.salesOrder_Sales_Order_Addresses}</h2>
            <apex:pageBlock >   
                <apex:tabPanel tabClass="activeTab" switchType="client" id="soaddresses">
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_bill_to}" id="tabBillTo">
                        <apex:outputPanel >
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ovrbill__c.inlineHelpText}">
                                    <apex:inputField id="sohdr_ovrbill__c" value="{!o.rstk__sohdr_ovrbill__c}" />
                                    <apex:outputLabel value="{!f.rstk__sohdr_ovrbill__c.label}"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_billtoaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!$Label.rstk__customeraddresses}"/>
                                    <c:LocalSelect id="sohdr_billtoaddr__c" value="{!o.rstk__sohdr_billtoaddr__c}"/>
                                 </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="billto_soaddr_address1__c" value="{!soaddrBill.rstk__soaddr_address1__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                                <apex:inputField id="billto_soaddr_name__c" value="{!soaddrBill.rstk__soaddr_name__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="billto_soaddr_address2__c" value="{!soaddrBill.rstk__soaddr_address2__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                                <apex:inputField id="billto_soaddr_phone__c" value="{!soaddrBill.rstk__soaddr_phone__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="billto_soaddr_address3__c" value="{!soaddrBill.rstk__soaddr_address3__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                                <apex:inputField id="billto_soaddr_fax__c" value="{!soaddrBill.rstk__soaddr_fax__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                                <apex:inputField styleclass="addressField" id="billto_soaddr_city__c" value="{!soaddrBill.rstk__soaddr_city__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                                <apex:inputField id="billto_soaddr_email__c" value="{!soaddrBill.rstk__soaddr_email__c}" onchange="validateEmailField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                                <apex:inputField styleclass="addressField" id="billto_soaddr_state__c" value="{!soaddrBill.rstk__soaddr_state__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                                <c:LocalSelect id="billto_soaddr_socontact__c" value="{!soaddrBill.rstk__soaddr_socontact__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                                <apex:outputPanel >
                                    <apex:inputField styleclass="addressField" id="billto_soaddr_country__c" value="{!soaddrBill.rstk__soaddr_country__c}" />
                                    &nbsp;<apex:inputField styleclass="addressField" id="billto_soaddr_isocountry__c" value="{!soaddrBill.rstk__soaddr_isocountry__c}" onchange="setCounytryField(this)"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                                <apex:inputField id="billto_soaddr_conmethod__c" value="{!soaddrBill.rstk__soaddr_conmethod__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                                <apex:inputField styleclass="addressField" id="billto_soaddr_zip__c" value="{!soaddrBill.rstk__soaddr_zip__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="billto_validation" rendered="{!geoStatus.addressVerification}">
                            <apex:pageBlockSectionItem helpText="Validate Address">
                                <input type="button" id="billto_validate__c" value="{!$Label.salesorder_pagebtn_Validate}" onclick="validateAddr.doValidateAddress('billto', false, getValidationData(false));"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel layout="none">
                                    <apex:inputfield id="billto_soaddr_verified__c" value="{!soaddrBill.rstk__soaddr_verified__c}" />
                                    <script>jQuery(document.getElementById("{!$Component.billto_soaddr_verified__c}")).attr('disabled', 'disabled');</script>
                                </apex:outputPanel> 
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_verified__c.label}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_ship_to}" id="tabShipTo">
                        <apex:outputPanel >
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ovrship__c.inlineHelpText}">
                                    <apex:inputField id="sohdr_ovrship__c" value="{!o.rstk__sohdr_ovrship__c}" />
                                    <apex:outputLabel value="{!f.rstk__sohdr_ovrship__c.label}"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_shiptoaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!$Label.rstk__customeraddresses}"/>
                                    <c:LocalSelect id="sohdr_shiptoaddr__c" value="{!o.rstk__sohdr_shiptoaddr__c}"/>
                                 </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="shipto_soaddr_address1__c" value="{!soaddrShip.rstk__soaddr_address1__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                                <apex:inputField id="shipto_soaddr_name__c" value="{!soaddrShip.rstk__soaddr_name__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="shipto_soaddr_address2__c" value="{!soaddrShip.rstk__soaddr_address2__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                                <apex:inputField id="shipto_soaddr_phone__c" value="{!soaddrShip.rstk__soaddr_phone__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="shipto_soaddr_address3__c" value="{!soaddrShip.rstk__soaddr_address3__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                                <apex:inputField id="shipto_soaddr_fax__c" value="{!soaddrShip.rstk__soaddr_fax__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                                <apex:inputField styleclass="addressField" id="shipto_soaddr_city__c" value="{!soaddrShip.rstk__soaddr_city__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                                <apex:inputField id="shipto_soaddr_email__c" value="{!soaddrShip.rstk__soaddr_email__c}" onchange="validateEmailField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                                <apex:inputField styleclass="addressField" id="shipto_soaddr_state__c" value="{!soaddrShip.rstk__soaddr_state__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                                <c:LocalSelect id="shipto_soaddr_socontact__c" value="{!soaddrShip.rstk__soaddr_socontact__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                                <apex:outputPanel >
                                    <apex:inputField styleclass="addressField" id="shipto_soaddr_country__c" value="{!soaddrShip.rstk__soaddr_country__c}" />
                                    &nbsp;<apex:inputField styleclass="addressField" id="shipto_soaddr_isocountry__c" value="{!soaddrShip.rstk__soaddr_isocountry__c}"  onchange="setCounytryField(this)" />
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                                <apex:inputField id="shipto_soaddr_conmethod__c" value="{!soaddrShip.rstk__soaddr_conmethod__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                                <apex:inputField styleclass="addressField" id="shipto_soaddr_zip__c" value="{!soaddrShip.rstk__soaddr_zip__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_taxloc__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_taxloc__c.label}"/>
                                <c:LocalSelect id="shipto_soaddr_taxloc__c" value="{!soaddrShip.rstk__soaddr_taxloc__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__when_shipping_address_is_validated_the_current_tax_rate_will_be_shown_here}" rendered="{!geoStatus.taxLookup}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_ovrtaxrate__c.label}"/>
                                <apex:inputField id="shipto_soaddr_ovrtaxrate__c" value="{!soaddrShip.rstk__soaddr_ovrtaxrate__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!!geoStatus.taxLookup}"/>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_vatexempt__c.inlineHelpText}" rendered="{!vatActive}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_vatexempt__c.label}"/>
                                <apex:inputField styleclass="addressField" id="shipto_soaddr_vatexempt__c" value="{!soaddrShip.rstk__soaddr_vatexempt__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="shipto_validation" rendered="{!geoStatus.addressVerification}">
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__validate_address}">
                                <input type="button" id="shipto_validate__c" value="{!$Label.salesorder_pagebtn_Validate}" onclick="validateAddr.doValidateAddress('shipto', true, getValidationData(false));"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel layout="none">
                                    <apex:inputfield id="shipto_soaddr_verified__c" value="{!soaddrShip.rstk__soaddr_verified__c}" />
                                    <script>jQuery(document.getElementById("{!$Component.shipto_soaddr_verified__c}")).attr('disabled', 'disabled');</script>
                                </apex:outputPanel> 
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_verified__c.label}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel style="display:none;">
                                    <apex:inputText id="shipto_soaddr_ovrsocust__c" value="{!soaddrShip.rstk__soaddr_ovrsocust__c}"/>
                                    <apex:inputText id="shipto_soaddr_ovrsocaddr__c" value="{!soaddrShip.rstk__soaddr_ovrsocaddr__c}"/>
                                </apex:outputPanel>
                                <input type="button" class="btn" name="SelectRelatedCustomerAddress"
                                   value="{!$Label.pagebutton_SelectRelatedCustomerAddress}" onclick="showRelatedCustomerAddressPopup(addressTypeShipTo); return false;"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_acknowledgement}" id="tabAck">
                        <apex:outputPanel >
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ovrack__c.inlineHelpText}">
                                    <apex:inputField id="sohdr_ovrack__c" value="{!o.rstk__sohdr_ovrack__c}" />
                                    <apex:outputLabel value="{!f.rstk__sohdr_ovrack__c.label}"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ackaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!$Label.rstk__customeraddresses}"/>
                                    <c:LocalSelect id="sohdr_ackaddr__c" value="{!o.rstk__sohdr_ackaddr__c}"/>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="ack_soaddr_address1__c" value="{!soaddrAck.rstk__soaddr_address1__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                                <apex:inputField id="ack_soaddr_name__c" value="{!soaddrAck.rstk__soaddr_name__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="ack_soaddr_address2__c" value="{!soaddrAck.rstk__soaddr_address2__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                                <apex:inputField id="ack_soaddr_phone__c" value="{!soaddrAck.rstk__soaddr_phone__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="ack_soaddr_address3__c" value="{!soaddrAck.rstk__soaddr_address3__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                                <apex:inputField id="ack_soaddr_fax__c" value="{!soaddrAck.rstk__soaddr_fax__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                                <apex:inputField styleclass="addressField" id="ack_soaddr_city__c" value="{!soaddrAck.rstk__soaddr_city__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                                <apex:inputField id="ack_soaddr_email__c" value="{!soaddrAck.rstk__soaddr_email__c}" onchange="validateEmailField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                                <apex:inputField styleclass="addressField" id="ack_soaddr_state__c" value="{!soaddrAck.rstk__soaddr_state__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                                <c:LocalSelect id="ack_soaddr_socontact__c" value="{!soaddrAck.rstk__soaddr_socontact__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                                <apex:outputPanel >
                                    <apex:inputField styleclass="addressField" id="ack_soaddr_country__c" value="{!soaddrAck.rstk__soaddr_country__c}" />
                                    &nbsp;<apex:inputField styleclass="addressField" id="ack_soaddr_isocountry__c" value="{!soaddrAck.rstk__soaddr_isocountry__c}"  onchange="setCounytryField(this)" />
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                                <apex:inputField id="ack_soaddr_conmethod__c" value="{!soaddrAck.rstk__soaddr_conmethod__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                                <apex:inputField styleclass="addressField" id="ack_soaddr_zip__c" value="{!soaddrAck.rstk__soaddr_zip__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="ack_validation" rendered="{!geoStatus.addressVerification}">
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__validate_address}">
                                <input type="button" id="ack_validate__c" value="{!$Label.salesorder_pagebtn_Validate}" onclick="validateAddr.doValidateAddress('ack', false, getValidationData(false));"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel layout="none">
                                    <apex:inputfield id="ack_soaddr_verified__c" value="{!soaddrAck.rstk__soaddr_verified__c}" />
                                    <script>jQuery(document.getElementById("{!$Component.ack_soaddr_verified__c}")).attr('disabled', 'disabled');</script>
                                </apex:outputPanel> 
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_verified__c.label}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_installation}" id="tabInstall">
                        <apex:outputPanel >
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_installcust__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstk__sohdr_installcust__c.label}"/>
                                    <c:LocalSelect id="sohdr_installcust__c" value="{!o.rstk__sohdr_installcust__c}" width="200px"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_installaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!$Label.rstk__customeraddresses}"/>
                                    <c:LocalSelect id="sohdr_installaddr__c" value="{!o.rstk__sohdr_installaddr__c}" />
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="install_soaddr_address1__c" value="{!soaddrInstall.rstk__soaddr_address1__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                                <apex:inputField id="install_soaddr_name__c" value="{!soaddrInstall.rstk__soaddr_name__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="install_soaddr_address2__c" value="{!soaddrInstall.rstk__soaddr_address2__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                                <apex:inputField id="install_soaddr_phone__c" value="{!soaddrInstall.rstk__soaddr_phone__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                                <apex:inputField styleclass="addressField addrLineField" id="install_soaddr_address3__c" value="{!soaddrInstall.rstk__soaddr_address3__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                                <apex:inputField id="install_soaddr_fax__c" value="{!soaddrInstall.rstk__soaddr_fax__c}" onchange="validatePhoneField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                                <apex:inputField styleclass="addressField" id="install_soaddr_city__c" value="{!soaddrInstall.rstk__soaddr_city__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                                <apex:inputField id="install_soaddr_email__c" value="{!soaddrInstall.rstk__soaddr_email__c}" onchange="validateEmailField(this)"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                                <apex:inputField styleclass="addressField" id="install_soaddr_state__c" value="{!soaddrInstall.rstk__soaddr_state__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                                <apex:outputPanel >
                                    <apex:outputField id="install_soaddr_socontactlink__c" value="{!soaddrInstall.rstk__soaddr_socontact__c}"/>
                                    <input name="install_soaddr_socontacttext__c" id="install_soaddr_socontacttext__c" width="200px" style="display:none;"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                                <apex:outputPanel >
                                    <apex:inputField styleclass="addressField" id="install_soaddr_country__c" value="{!soaddrInstall.rstk__soaddr_country__c}" />
                                    &nbsp;<apex:inputField styleclass="addressField" id="install_soaddr_isocountry__c" value="{!soaddrInstall.rstk__soaddr_isocountry__c}"  onchange="setCounytryField(this)" />
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                                <!-- apex:inputField id="install_soaddr_conmethod__c" value="{!soaddrInstall.soaddr_conmethod__c}" /> -->
                                <input name="install_soaddr_conmethodtext__c" id="install_soaddr_conmethodtext__c" width="200px" value="{!soaddrInstall.soaddr_conmethod__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                                <apex:inputField styleclass="addressField" id="install_soaddr_zip__c" value="{!soaddrInstall.rstk__soaddr_zip__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="install_validation" rendered="{!geoStatus.addressVerification}">
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__validate_address}">
                                <input type="button" id="install_validate__c" value="{!$Label.salesorder_pagebtn_Validate}" onclick="validateAddr.doValidateAddress('ack', false, getValidationData(false));"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputPanel layout="none">
                                    <apex:inputfield id="install_soaddr_verified__c" value="{!soaddrInstall.rstk__soaddr_verified__c}" />
                                    <script>jQuery(document.getElementById("{!$Component.install_soaddr_verified__c}")).attr('disabled', 'disabled');</script>
                                </apex:outputPanel> 
                                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_verified__c.label}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                </apex:tabPanel>
            </apex:pageBlock>

            <apex:outputPanel rendered="{!!readOnlyUser}"><button type="button" onclick="addressModal_ok(); return false;">{!$Label.salesorder_pagebtn_OK}</button></apex:outputPanel>
            <button type="button" class="close" style="display:none;">{!$Label.rstk__salesorder_pagebtn_close}</button>
            <button type="button" onclick="addressModal_cancel(); return false;">{!$Label.salesorder_pagebtn_Cancel}</button>
        </div>

        <button style="visibility:hidden" class="btnPopupCommission" rel="#popupCommission"></button>
        <div class="modal" id="popupCommission">
            <apex:pageBlock >   
                <apex:tabPanel tabClass="activeTab" id="commission">
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_salesordercommission}" id="tabCommission">
                    </apex:tab>
                </apex:tabPanel>
            </apex:pageBlock>   

            <button type="button" onclick="commissionModal_ok()">{!$Label.salesorder_pagebtn_OK}</button>
            <button type="button" class="close">{!$Label.salesorder_pagebtn_Cancel}</button>
        </div>
        
        <button style="visibility:hidden" class="btnPopupIssue" rel="#popupIssue"></button>
        <div class="modal" id="popupIssue">
            <h2>{!$Label.salesOrder_Sales_Order_Fulfillment}</h2>
                <apex:pageBlock mode="edit" >
                    <div id="issueSection1" style="width:400px;float:left">
                    <apex:pageBlockSection columns="1">
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!f_issue.rstk__soiss_ovrshipdate__c.label}"/>
                            <apex:inputField id="soiss_ovrshipdate__c" value="{!woissue.rstk__soiss_ovrshipdate__c}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!f_issue.rstk__soiss_transcomments__c.label}"/>
                            <apex:inputField id="soiss_transcomments__c" value="{!woissue.rstk__soiss_transcomments__c}" />
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                    </div>
                    <div id="issueSection2" style="width:200px;float:left">
                    <apex:pageBlockSection id="issueSection2" columns="1">
                        <apex:pageBlockSectionItem >
                            <apex:inputField id="soiss_pick__c" value="{!woissue.rstk__soiss_pick__c}"/>
                            <apex:outputLabel value="{!f_issue.rstk__soiss_pick__c.label}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:inputField id="soiss_package__c" value="{!woissue.rstk__soiss_package__c}"/>
                            <apex:outputLabel value="{!f_issue.rstk__soiss_package__c.label}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:inputField id="soiss_ship__c" value="{!woissue.rstk__soiss_ship__c}"/>
                            <apex:outputLabel value="{!f_issue.rstk__soiss_ship__c.label}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:inputField id="soiss_createinvoice__c" value="{!woissue.rstk__soiss_createinvoice__c}"/>
                            <apex:outputLabel value="{!f_issue.rstk__soiss_createinvoice__c.label}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:inputField id="soiss_addinvoicebatch__c" value="{!woissue.rstk__soiss_addinvoicebatch__c}"/>
                            <apex:outputLabel value="{!f_issue.rstk__soiss_addinvoicebatch__c.label}" />
                        </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                    </div>
                </apex:pageBlock>

            <div id="issueBtns" style="clear:both">
                <button type="button" onclick="issueModal_ok()">{!$Label.salesorder_pagebtn_ProcessOrderLines}</button>
                <button type="button" class="close">{!$Label.salesorder_pagebtn_Cancel}</button>
            </div>
        </div>
        
        <button style="visibility:hidden" class="btnPopupLineDetails" rel="#popupLineDetails"></button>
        <div class="modal" id="popupLineDetails">
            <h2>{!$Label.salesOrder_Sales_Order_Line}</h2>
            <apex:pageBlock >
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_div__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_div__c.label}"/>
                        <apex:outputField value="{!o.rstk__sohdr_div__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_order__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_order__c.label}"/>
                        <apex:outputText value="{!o.rstk__sohdr_order__c}" />
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_line__c.inlineHelpText}">
                        <apex:outputLabel value="{!f_sl.rstk__soline_line__c.label}"/>
                        <span id="dsp_soline_line__c"></span>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_qtypickpackship__c.inlineHelpText}" rendered="{!!o.rstk__sohdr_isquote__c}">
                        <apex:outputLabel value="{!f_sl.rstk__soline_qtypickpackship__c.label}"/>
                        <span id="modal_soline_qtypickpackship__c"/>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <br />
                <apex:outputPanel rendered="{!!readOnlyUser}"><button type="button" class="btn" onclick="lineModal_ok()">{!$Label.salesorder_pagebtn_OK}</button></apex:outputPanel>
                <button type="button" class="btn close">{!$Label.salesorder_pagebtn_Cancel}</button>
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_commissiondetail}" onclick="return orderOvrCommbyLine();" rendered="{!AND(o.Id != null, !pageOptions.hideCommission)}" />
                <button id="atpBtn" type="button" class="btn" onclick="return showATP();">{!$Label.salesorder_pagebtn_ATP}</button>
                <button id="modal_btnConfsess" type="button" class="btn" onclick="return openProductConfigurator(true);">{!$Label.salesorder_pagebtn_ConfigurationSession}</button>
                <apex:commandbutton id="btnChangeProductNumber" value="{!$Label.rstk__salesorder_pagebtn_changeproductnumber}" onclick="return showChangeProductNumber();" rendered="{!prodConvertable}"/>
                <button id="componentATPBtn" type="button" class="btn" onclick="return showComponentATP();" >{!$Label.salesorder_pagebtn_ComponentATP}</button>
                <br />
                <br />
                <apex:tabPanel tabClass="activeTab" switchType="client" id="inventory">
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_ship_tosettings}" id="tabLineShipping">
                            <apex:pageBlockSection >
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shiptomethod__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_shiptomethod__c.label}"/>
                                    <apex:selectlist id="modal_soline_shiptomethod__c" value="{!currentSoline.rstk__soline_shiptomethod__c}"  size="1" style="width:200px">
                                        <apex:selectOptions value="{!ShiptoMethods}"/>
                                    </apex:selectlist>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem >
                                    <apex:outputPanel >
                                        <apex:outputLabel id="modal_soline_shiptoaddr_label" value="{!f_sl.rstk__soline_shiptoaddr__c.label}"/>
                                        <apex:outputLabel id="modal_soline_shiptoaltline_label" value="{!f_sl.rstk__soline_shiptoaltline__c.label}"/>
                                    </apex:outputPanel>
                                    <apex:outputPanel >
                                        <c:LocalSelect id="modal_soline_shiptoaddr__c" value="{!currentSoline.rstk__soline_shiptoaddr__c}" width="200px"/>
                                        <apex:selectlist id="modal_soline_shiptoaltline__c" value="{!currentSoline.rstk__soline_shiptoaltline__c}" size="1" style="width:200px">
                                            <apex:selectOptions value="{!AltLines}"/>
                                        </apex:selectlist>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_installaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_installaddr__c.label}"/>
                                    <apex:outputpanel >
                                        <c:LocalSelect id="modal_soline_installaddr__c" value="{!currentSoline.rstk__soline_installaddr__c}" width="200px"/>
                                        <a name='installLineinfo' href="#" onclick="showModalInstallAddress(); return false;" title='{!$Label.Click_to_see_the_Installation_Address_details}'>
                                            <img height="8" width="8" src="/img/msg_icons/info16.png"/>
                                        </a>
                                    </apex:outputpanel>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem ><div></div></apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_fob__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_fob__c.label}"/>
                                    <c:LocalSelect id="modal_soline_fob__c" value="{!currentSoline.rstk__soline_fob__c}" width="200px"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_carrier__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_carrier__c.label}"/>
                                    <c:LocalSelect id="modal_soline_carrier__c" value="{!currentSoline.rstk__soline_carrier__c}" width="200px"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_fterms__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_fterms__c.label}"/>
                                    <c:LocalSelect id="modal_soline_fterms__c" value="{!currentSoline.rstk__soline_fterms__c}" width="200px"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shipvia__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_shipvia__c.label}"/>
                                    <c:LocalSelect id="modal_soline_shipvia__c" value="{!currentSoline.rstk__soline_shipvia__c}" width="200px"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_sydivaddr__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_slextn.rstk__solineextn_sydivaddr__c.label}"/>
                                    <c:LocalSelect id="modal_solineextn_sydivaddr__c" value="{!currentSolineExtn.rstk__solineextn_sydivaddr__c}"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_syvatclass__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_syvatclass__c.label}"/>
                                    <apex:selectlist id="modal_soline_syvatclass__c" value="{!currentSoline.rstk__soline_syvatclass__c}" size="1" style="width:200px">
                                        <apex:selectOptions value="{! SyvatclassSelectOptionList}"/>
                                    </apex:selectlist>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                            
                            <apex:pageBlock id="lineAddressBlock">
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_name__c" value="{!soaddrLine.rstk__soaddr_name__c}" />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                                        <apex:inputField id="soline_soaddr_phone__c" value="{!soaddrLine.rstk__soaddr_phone__c}" onchange="validatePhoneField(this)"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_address1__c" value="{!soaddrLine.rstk__soaddr_address1__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                                        <apex:inputField id="soline_soaddr_fax__c" value="{!soaddrLine.rstk__soaddr_fax__c}" onchange="validatePhoneField(this)"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_address2__c" value="{!soaddrLine.rstk__soaddr_address2__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                                        <apex:inputField id="soline_soaddr_email__c" value="{!soaddrLine.rstk__soaddr_email__c}" onchange="validateEmailField(this)"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_address3__c" value="{!soaddrLine.rstk__soaddr_address3__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                                        <c:LocalSelect id="soline_soaddr_socontact__c" value="{!soaddrLine.rstk__soaddr_socontact__c}"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_city__c" value="{!soaddrLine.rstk__soaddr_city__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                                        <apex:inputField id="soline_soaddr_conmethod__c" value="{!soaddrLine.rstk__soaddr_conmethod__c}"  />
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_state__c" value="{!soaddrLine.rstk__soaddr_state__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_taxloc__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_taxloc__c.label}"/>
                                        <c:LocalSelect id="soline_soaddr_taxloc__c" value="{!soaddrLine.rstk__soaddr_taxloc__c}" width="150px"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                                        <apex:outputPanel >
                                            <apex:inputField styleclass="addressField" id="soline_soaddr_country__c" value="{!soaddrLine.rstk__soaddr_country__c}"  />
                                            &nbsp;<apex:inputField styleclass="addressField" id="soline_soaddr_isocountry__c" value="{!soaddrLine.rstk__soaddr_isocountry__c}"  onchange="setCounytryField(this)"  />
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_nopartials__c.inlineHelpText}">
                                         <apex:inputField id="modal_soline_nopartials__c" value="{!currentSoline.rstk__soline_nopartials__c}"/>
                                         <apex:outputLabel value="{!f_sl.rstk__soline_nopartials__c.label}"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_zip__c" value="{!soaddrLine.rstk__soaddr_zip__c}"  />
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_nopartialset__c.inlineHelpText}">
                                        <apex:inputField id="modal_soline_nopartialset__c" value="{!currentSoline.rstk__soline_nopartialset__c}"/>
                                        <apex:outputLabel value="{!f_sl.rstk__soline_nopartialset__c.label}"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_sozone__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_sozone__c.label}"/>
                                        <span id="modalstatic_soline_sozone__c"/>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shipsetid__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_shipsetid__c.label}"/>
                                        <apex:inputField id="modal_soline_shipsetid__c" value="{!currentSoline.rstk__soline_shipsetid__c}"/>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem />
                                    <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_vatexempt__c.inlineHelpText}" rendered="{!vatActive}">
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_vatexempt__c.label}"/>
                                        <apex:inputField styleclass="addressField" id="soline_soaddr_vatexempt__c" value="{!soaddrShip.rstk__soaddr_vatexempt__c}" />
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection rendered="{!geoStatus.addressVerification}">
                                    <apex:outputpanel id="soline_validation">
                                    <apex:pageBlockSectionItem helpText="Validate Address">
                                        <input type="button" id="soline_validate__c" value="{!$Label.salesorder_pagebtn_Validate}" onclick="validateAddr.doValidateAddress('soline', true, getValidationData(true));"/>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem >
                                        <apex:outputPanel layout="none">
                                            <apex:inputfield id="soline_soaddr_verified__c" value="{!soaddrLine.rstk__soaddr_verified__c}" />
                                            <script>jQuery(document.getElementById("{!$Component.soline_soaddr_verified__c}")).attr('disabled', 'disabled');</script>
                                        </apex:outputPanel> 
                                        <apex:outputLabel value="{!f_soaddr.rstk__soaddr_verified__c.label}"/>
                                    </apex:pageBlockSectionItem>
                                    </apex:outputpanel>
                                </apex:pageBlockSection>
                                <apex:pageBlockSection rendered="{!geoStatus.taxLookup}">
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_ovrtaxrate__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_ovrtaxrate__c.label}" style="width:120px"/>
                                        <input type="text" readonly="readonly" id="modal_soline_ovrtaxrate__c" value="{!currentSoline.soline_ovrtaxrate__c}" />
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_ovrtax__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_ovrtax__c.label}" style="width:120px"/>
                                        <input type="text" readonly="readonly" id="modal_soline_ovrtax__c" value="{!currentSoline.soline_ovrtax__c}" />
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_ovrshippingtax__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_ovrshippingtax__c.label}" style="width:120px"/>
                                        <input type="text" readonly="readonly" id="modal_soline_ovrshippingtax__c" value="{!currentSoline.soline_ovrshippingtax__c}" />
                                    </apex:pageBlockSectionItem>            
                                </apex:pageBlockSection>
                                <apex:pageBlockSection >
                                    <apex:pageBlockSectionItem >
                                        <apex:outputPanel style="display:none;">
                                            <apex:inputText id="soline_soaddr_ovrsocust__c" value="{!soaddrLine.rstk__soaddr_ovrsocust__c}"/>
                                            <apex:inputText id="soline_soaddr_ovrsocaddr__c" value="{!soaddrLine.rstk__soaddr_ovrsocaddr__c}"/>
                                        </apex:outputPanel>
                                        <input type="button" class="btn" name="SelectRelatedCustomerAddress"
                                           value="{!$Label.pagebutton_SelectRelatedCustomerAddress}" onclick="showRelatedCustomerAddressPopup(addressTypeLine); return false;"/>
                                    </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                            </apex:pageBlock>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_charges}" id="tabLineCharges">
                        <div class="largerLabel" id="chargeBlock1" style="border:1px solid #dddddd;border-radius:5px;width:370px;height:118px;float:left">
                            <apex:pageBlockSection columns="1">
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_freightamt__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_freightamt__c.label}"/>
                                        <apex:inputField id="modal_soline_freightamt__c" value="{!currentSoline.rstk__soline_freightamt__c}" />
                                    </apex:pageBlockSectionItem>            
                                                    
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_packageamt__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_packageamt__c.label}"/>
                                        <apex:inputField id="modal_soline_packageamt__c" value="{!currentSoline.rstk__soline_packageamt__c}" />
                                    </apex:pageBlockSectionItem>            

                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_handlingamt__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_handlingamt__c.label}"/>
                                        <apex:inputField id="modal_soline_handlingamt__c" value="{!currentSoline.rstk__soline_handlingamt__c}" />
                                    </apex:pageBlockSectionItem>            

                            </apex:pageBlockSection>
                        </div>
                        <div class="largerLabel" id="chargeBlock2" style="border:1px solid #dddddd;border-radius:5px;width:370px;height:118px;float:left">
                            <apex:pageBlockSection columns="1">
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_freightcost__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_freightcost__c.label}" />
                                        <span id="modal_soline_freightcost__c"></span>
                                    </apex:pageBlockSectionItem>            

                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_taxexempt__c.inlineHelpText}">
                                        <apex:inputField id="modal_soline_taxexempt__c" value="{!currentSoline.rstk__soline_taxexempt__c}" />
                                        <apex:outputLabel value="{!f_sl.rstk__soline_taxexempt__c.label}" />
                                    </apex:pageBlockSectionItem>            

                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_taxoverride__c.inlineHelpText}" rendered="{!!geoStatus.taxLookup}">
                                        <apex:inputField id="modal_soline_taxoverride__c" value="{!currentSoline.rstk__soline_taxoverride__c}" />
                                        <apex:outputLabel value="{!f_sl.rstk__soline_taxoverride__c.label}" style="width:120px"/>
                                    </apex:pageBlockSectionItem>            

                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_taxamount__c.inlineHelpText}" rendered="{!!geoStatus.taxLookup}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_taxamount__c.label}" style="width:120px"/>
                                        <apex:inputField id="modal_soline_taxamount__c" value="{!currentSoline.rstk__soline_taxamount__c}" />
                                    </apex:pageBlockSectionItem>            

                            </apex:pageBlockSection>
                        </div>
                        <div class="largerLabel" id="chargeBlock3" style="border:1px solid #dddddd;border-radius:5px;width:370px;height:240px;float:left">
                            <apex:pageBlockSection columns="1">
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_salesacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_sl.rstk__soline_salesacct__c.label}" style="width:120px"/>
                                            <apex:selectlist id="modal_soline_salesacct__c" value="{!currentSoline.rstk__soline_salesacct__c}" size="1" style="width:200px">
                                                <apex:selectOptions value="{!salesAccounts}"/>
                                            </apex:selectlist>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_cospendacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_sl.rstk__soline_cospendacct__c.label}" style="width:120px"/>
                                            <apex:selectlist id="modal_soline_cospendacct__c" value="{!currentSoline.rstk__soline_cospendacct__c}" size="1" style="width:200px">
                                                <apex:selectOptions value="{!COSPendAccounts}"/>
                                            </apex:selectlist>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_cosacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_sl.rstk__soline_cosacct__c.label}" style="width:120px"/>
                                            <apex:selectlist id="modal_soline_cosacct__c" value="{!currentSoline.rstk__soline_cosacct__c}" size="1" style="width:200px">
                                                <apex:selectOptions value="{!cosAccounts}"/>
                                            </apex:selectlist>
                                    </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                            <apex:outputPanel style="{!IF(isQuote,'display:none;','')}">
                                <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_cospendamt__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_sl.rstk__soline_cospendamt__c.label}" style="width:120px;"/>
                                            <input type="text" readonly="readonly" id="modal_soline_cospendamt__c" value="{!currentSoline.soline_cospendamt__c}"/>
                                        </apex:pageBlockSectionItem>            
                                        <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_cosamt__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_sl.rstk__soline_cosamt__c.label}" style="width:120px;"/>
                                            <input type="text" readonly="readonly"  id="modal_soline_cosamt__c" value="{!currentSoline.soline_cosamt__c}"/>
                                        </apex:pageBlockSectionItem>
                                </apex:pageBlockSection>
                            </apex:outputPanel>
                        </div>
                        <div class="largerLabel" id="chargeBlock4" style="border:1px solid #dddddd;border-radius:5px;width:370px;height:240px;float:left">
                            <apex:pageBlockSection columns="1">
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_price__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_price__c.label}" style="width:120px"/>
                                        <apex:outputText id="dsp_soline_price__c" />
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_sysprice__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_sysprice__c.label}" style="width:120px"/>
                                        <input type="text" readonly="readonly" id="modal_soline_sysprice__c" value="{!currentSoline.soline_sysprice__c}"/>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricesrce__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_pricesrce__c.label}" style="width:120px"/>
                                        <input type="text" readonly="readonly" id="modal_soline_pricesrce__c" value="{!currentSoline.soline_pricesrce__c}"/>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricebook__c.inlineHelpText}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_pricebook__c.label}" style="width:120px"/>
                                        <c:LocalSelect id="modal_soline_pricebook__c" value="{!currentSoline.rstk__soline_pricebook__c}" style="width:225"/>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_altprice1__c.inlineHelpText}" rendered="{!pageOptions.showAltPricing}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_altprice1__c.label}"/>
                                        <apex:outputPanel >
                                            <apex:inputField id="modal_soline_altprice1__c" value="{!currentSoline.rstk__soline_altprice1__c}"/>
                                            <span name="maintenanceCurrencySymbol">{!maintenanceCurrencySymbol}</span>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>            
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_altprice2__c.inlineHelpText}" rendered="{!pageOptions.showAltPricing}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_altprice2__c.label}"/>
                                        <apex:outputPanel >
                                            <apex:inputField id="modal_soline_altprice2__c" value="{!currentSoline.rstk__soline_altprice2__c}" />
                                            <span name="maintenanceCurrencySymbol">{!maintenanceCurrencySymbol}</span>
                                        </apex:outputPanel>
                                    </apex:pageBlockSectionItem>
                                    <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_wbs__c.inlineHelpText}" rendered="{!isChargeCodeActive}">
                                        <apex:outputLabel value="{!f_sl.rstk__soline_wbs__c.label}"/>
                                        <c:LocalSelect id="modal_soline_wbs__c" value="{!currentSoline.rstk__soline_wbs__c}" link="true"/>
                                    </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </div>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_inventorysettings}" id="tabInventory">
                        <apex:pageBlockSection columns="2">
                            <apex:pageBlockSectionItem />
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_weight__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_weight__c.label}"/>
                                <apex:inputField id="modal_soline_weight__c" value="{!currentSoline.rstk__soline_weight__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_uomcf__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_uomcf__c.label}"/>
                                <input type="text" readonly="readonly"  id="modal_soline_uomcf__c" value="{!currentSoline.soline_uomcf__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_height__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_height__c.label}"/>
                                <apex:inputField id="modal_soline_height__c" value="{!currentSoline.rstk__soline_height__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shipsite__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_shipsite__c.label}"/>
                                <select size="1" id="modal_soline_shipsite__c" style="width:250px;">
                                    <option value=""> </option>
                                </select>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_width__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_width__c.label}"/>
                                <apex:inputField id="modal_soline_width__c" value="{!currentSoline.rstk__soline_width__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shiplocid__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_shiplocid__c.label}"/>
                                <select size="1" id="modal_soline_shiplocid__c" style="width:250px;">
                                    <option value=""> </option>
                                </select>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_length__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_length__c.label}"/>
                                <apex:inputField id="modal_soline_length__c" value="{!currentSoline.rstk__soline_length__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shiplocnum__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_shiplocnum__c.label}"/>
                                <apex:outputPanel >
                                    <select size="1" id="modal_select_soline_shiplocnum__c" style="width:250px;">
                                        <option value=""> </option>
                                    </select>
                                    <apex:inputField id="modal_free_soline_shiplocnum__c" value="{!currentSoline.rstk__soline_shiplocnum__c}" style="width:250px"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                             <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_intersystem__c.inlineHelpText}" rendered="{!pageOptions.interSystem}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_intersystem__c.label}"/>
                                <apex:inputField id="modal_soline_intersystem__c" value="{!currentSoline.rstk__soline_intersystem__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!!pageOptions.interSystem}"/>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_useconfig__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_useconfig__c.label}"/>
                                <apex:inputField id="modal_soline_useconfig__c" value="{!currentSoline.rstk__soline_useconfig__c}" />
                            </apex:pageBlockSectionItem>
                             <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_intracompany__c.inlineHelpText}" rendered="{!pageOptions.interSystem}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_intracompany__c.label}"/>
                                <apex:inputField id="modal_soline_intracompany__c" value="{!currentSoline.rstk__soline_intracompany__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!!pageOptions.interSystem}"/>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_usestock__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_usestock__c.label}"/>
                                <apex:inputField id="modal_soline_usestock__c" value="{!currentSoline.rstk__soline_usestock__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_extweight__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_extweight__c.label}"/>
                                <input type="text" readonly="readonly" id="modal_soline_extweight__c" value="{!currentSoline.soline_extweight__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:outputPanel >
                            <apex:pageBlockSection columns="2">
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_wocstordno__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_wocstordno__c.label}"/>
                                    <a id="modal_soline_wocstordno__c" href="#"></a>
                               </apex:pageBlockSectionItem>
                               <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_estind__c.inlineHelpText}">
                                        <apex:outputLabel id="estindlabel" value="{!f_sl.rstk__soline_estind__c.label}"/>
                                        <apex:inputField id="modal_soline_estind__c" value="{!currentSoline.rstk__soline_estind__c}"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_wotype__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_wotype__c.label}"/>
                                    <apex:inputField id="modal_soline_wotype__c" value="{!currentSoline.rstk__soline_wotype__c}" />
                               </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="1">
                                <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_sorma__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_slextn.rstk__solineextn_sorma__c.label}"/>
                                    <a id="modal_solineextn_sorma__c" href="#"></a>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                            <apex:pageBlockSection columns="2">
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_icitem__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_icitem__c.label}"/>
                                    <a id="modal_soline_icitem__c" href="#"></a>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_nopickifnorcpt__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_nopickifnorcpt__c.label}"/>
                                    <apex:inputField id="modal_soline_nopickifnorcpt__c" value="{!currentSoline.rstk__soline_nopickifnorcpt__c}" />
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_nopickifnorcpt__c.inlineHelpText}">
                                    <apex:outputLabel value=" "/>
                                    <input class="btn" type="Button" value="{!$Label.Decouple_Work_Order}" id="decoupleWorkOrder" onclick="attemptDecoupleWorkOrder(); return false;"/>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_nopickifnoalloc__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_nopickifnoalloc__c.label}"/>
                                    <apex:inputField id="modal_soline_nopickifnoalloc__c" value="{!currentSoline.rstk__soline_nopickifnoalloc__c}" />
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_configuredorderpricing}" id="tabLaborOrderPricing">
                        <apex:pageBlockSection columns="2">
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_configlabor__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_configlabor__c.label}"/>
                                <apex:inputField id="modal_soline_configlabor__c" value="{!currentSoline.rstk__soline_configlabor__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_useactuals__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_useactuals__c.label}"/>
                                <apex:inputField id="modal_soline_useactuals__c" value="{!currentSoline.rstk__soline_useactuals__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_mtlmarkuppct__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_mtlmarkuppct__c.label}"/>
                                <apex:inputField id="modal_soline_mtlmarkuppct__c" value="{!currentSoline.rstk__soline_mtlmarkuppct__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_labmarkuppct__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_labmarkuppct__c.label}"/>
                                <apex:inputField id="modal_soline_labmarkuppct__c" value="{!currentSoline.rstk__soline_labmarkuppct__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem />
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_labprice__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_labprice__c.label}"/>
                                <apex:inputField id="modal_soline_labprice__c" value="{!currentSoline.rstk__soline_labprice__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricemethmtl__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_pricemethmtl__c.label}"/>
                                <apex:inputField id="modal_soline_pricemethmtl__c" value="{!currentSoline.rstk__soline_pricemethmtl__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricemethlab__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_pricemethlab__c.label}"/>
                                <apex:inputField id="modal_soline_pricemethlab__c" value="{!currentSoline.rstk__soline_pricemethlab__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_itemizemtl__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_itemizemtl__c.label}"/>
                                <apex:inputField id="modal_soline_itemizemtl__c" value="{!currentSoline.rstk__soline_itemizemtl__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_itemizelab__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_itemizelab__c.label}"/>
                                <apex:inputField id="modal_soline_itemizelab__c" value="{!currentSoline.rstk__soline_itemizelab__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_ignorerollup__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_ignorerollup__c.label}"/>
                                <apex:inputField id="modal_soline_ignorerollup__c" value="{!currentSoline.rstk__soline_ignorerollup__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_references}" id="tabReference">
                        <apex:pageBlockSection columns="2">
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_orgid__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_orgid__c.label}"/>
                                <c:LocalSelect id="modal_soline_orgid__c" value="{!currentSoline.rstk__soline_orgid__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_custrequestdate__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_custrequestdate__c.label}"/>
                                <apex:inputField id="modal_soline_custrequestdate__c" value="{!currentSoline.rstk__soline_custrequestdate__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_case__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_case__c.label}"/>
                                <apex:selectlist id="modal_soline_case__c" value="{!currentSoline.rstk__soline_case__c}" size="1" style="width:250px">
                                    <apex:selectOptions value="{!cases}"/>
                                </apex:selectlist>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_agreement__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_agreement__c.label}"/>
                                <c:LocalSelect id="modal_soline_agreement__c" value="{!currentSoline.rstk__soline_agreement__c}" width="250px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_ustat__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_ustat__c.label}"/>
                                <c:LocalSelect id="modal_soline_ustat__c" value="{!currentSoline.rstk__soline_ustat__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_confsess__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_confsess__c.label}"/>
                                <a id="modal_soline_confsess__c" href="#"></a>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_covereditem__c.inlineHelpText}" rendered="{!!ISNULL(sohdr.rstk__sohdr_contract__c)}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_covereditem__c.label}"/>
                                <apex:outputpanel >
                                    <apex:inputText id="modal_soline_covereditem__c" value="{!currentSoline.rstk__soline_covereditem__c}" style="display:none"/>
                                    <apex:inputText id="modal_soline_textcovereditem__c" styleClass="ac_input" style="width:250px;"/>
                                    <script>
                                      var acId    = document.getElementById('{!$Component.modal_soline_covereditem__c}');
                                      var acInput = jQuery(document.getElementById('{!$Component.modal_soline_textcovereditem__c}'));
                                      setupAutocompleteFieldData(acInput[0],acId, []);
                                    </script>
                                </apex:outputpanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!ISNULL(sohdr.rstk__sohdr_contract__c)}"/>
                            
                           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_povend__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_sl.rstk__soline_povend__c.label}"/>
                                <c:autocomplete id="modal_soline_povend__c" ref="soline_povend__c" cntr="{!controller}" required="false" slDesc="" objKey="solineCurrent"
                                    query="select id, name from povend__c where povend_onetimeind__c = false" queryParms="[]"/>
                            </apex:pageBlockSectionItem>

                        </apex:pageBlockSection>
                        <apex:outputPanel style="{!IF(isQuote,'display:none;','')}">
                            <apex:pageBlockSection columns="1">
                                <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_hold__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_sl.rstk__soline_hold__c.label}"/>
                                    <apex:inputField id="modal_soline_hold__c" value="{!currentSoline.rstk__soline_hold__c}"/>
                                </apex:pageBlockSectionItem>
                            </apex:pageBlockSection>
                        </apex:outputPanel>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_comments}" id="tabLineComments">
                        <div style="width:700px">
                            <c:HelpLabel label="{!f_sl.rstk__soline_intcomment__c.label}" helpText="{!f_sl.rstk__soline_intcomment__c.inlineHelpText}"/>
                            <apex:inputTextarea id="modal_soline_intcomment__c" value="{!currentSoline.rstk__soline_intcomment__c}" rows="6" richtext="true" disabled="{!readOnlyUser}"/>
                            <br></br>
                            <c:HelpLabel label="{!f_sl.rstk__soline_extcomment__c.label}" helpText="{!f_sl.rstk__soline_extcomment__c.inlineHelpText}"/>
                            <apex:inputTextarea id="modal_soline_extcomment__c" value="{!currentSoline.rstk__soline_extcomment__c}" rows="6" richtext="true" disabled="{!readOnlyUser}"/>
                        </div>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_modelservicecost}" id="tabModelServiceCost" rendered="{!pageOptions.showEntitlements}">
                        <apex:pageBlockSection id="pbs_ModelServiceCost" showHeader="false" columns="1">
                             <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_srvcostcol__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_srvcostcol__c.label}"/>
                                <apex:inputfield id="modal_solineextn_srvcostcol__c" value="{!currentSolineExtn.rstk__solineextn_srvcostcol__c}"/>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_srvcostbw__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_srvcostbw__c.label}"/>
                                <apex:inputfield id="modal_solineextn_srvcostbw__c" value="{!currentSolineExtn.rstk__solineextn_srvcostbw__c}"/>
                            </apex:pageBlockSectionItem>
    
                            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_srvcostscan__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_srvcostscan__c.label}"/>
                                <apex:inputfield id="modal_solineextn_srvcostscan__c" value="{!currentSolineExtn.rstk__solineextn_srvcostscan__c}"/>
                            </apex:pageBlockSectionItem>
    
                            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_antvolcol__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_antvolcol__c.label}"/>
                                <apex:inputfield id="modal_solineextn_antvolcol__c" value="{!currentSolineExtn.rstk__solineextn_antvolcol__c}"/>
                            </apex:pageBlockSectionItem>
    
                            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_antvolbw__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_antvolbw__c.label}"/>
                                <apex:inputfield id="modal_solineextn_antvolbw__c" value="{!currentSolineExtn.rstk__solineextn_antvolbw__c}"/>
                            </apex:pageBlockSectionItem>
    
                            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_antvolscan__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_slextn.rstk__solineextn_antvolscan__c.label}"/>
                                <apex:inputfield id="modal_solineextn_antvolscan__c" value="{!currentSolineExtn.rstk__solineextn_antvolscan__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_dimensions}" name="Dimensions" id="Dimensions">
                        <apex:pageBlockSection id="pbs_Dimensions" showHeader="false" columns="1">
                             <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval1__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval1__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval1__c"></span>
                                            <select size="1" id="modal_dimvals_dimval1__c" style="width:400px;"/> 
                                   </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval2__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval2__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval2__c"></span>
                                            <select size="1" id="modal_dimvals_dimval2__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval3__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval3__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval3__c"></span>
                                            <select size="1" id="modal_dimvals_dimval3__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval4__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval4__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval4__c"></span>
                                            <select size="1" id="modal_dimvals_dimval4__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval5__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval5__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval5__c"></span>
                                            <select size="1" id="modal_dimvals_dimval5__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval6__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval6__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval6__c"></span>
                                            <select size="1" id="modal_dimvals_dimval6__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval7__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval7__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval7__c"></span>
                                            <select size="1" id="modal_dimvals_dimval7__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval8__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f_dimvals.rstk__dimval8__c.label}"/>
                                    <apex:outputPanel >
                                            <span id="modalstatic_dimvals_dimval8__c"></span>
                                            <select size="1" id="modal_dimvals_dimval8__c" style="width:400px;"/> 
                                    </apex:outputPanel>
                            </apex:pageBlockSectionItem>                        
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!customFieldTabName}" name="tab_cfline" id="tab_cfline" rendered="{!hasLineCustomFields}">
                        <apex:pageblocksection columns="2" id="pbsLineRSF">
                            <apex:repeat value="{!lineCustomFields}" var="lcf">  
                                 <apex:pageblocksectionItem >
                                    <apex:outputLabel html-lcf="{!lcf.FieldPath}" value="{!lcf.Label}"/>
                                    <apex:outputPanel >
                                        <apex:inputfield value="{!currentSoline[lcf.fieldPath]}" required="{!OR(lcf.required, lcf.dbrequired)}" styleClass="linecustom"
                                            onchange="customFieldChanged('{!currentSoline.rstk__soline_line__c}', '{!lcf.fieldPath}', this);"
                                             rendered="{!LEN(lineCustomFieldTypes[lcf.fieldPath]) == 0}"/>  
                                        <apex:outputPanel rendered="{!LEN(lineCustomFieldTypes[lcf.fieldPath]) > 0}">
                                         <select id="{!lcf.fieldPath}" name="{!lcf.fieldPath}"  value="" class="linecustom"
                                            onchange="customFieldChanged('{!currentSoline.rstk__soline_line__c}', '{!lcf.fieldPath}', this);">
                                            <option></option>
                                        </select>
                                        </apex:outputPanel> 
                                    </apex:outputPanel>
                                </apex:pageblocksectionItem>
                            </apex:repeat>  
                        </apex:pageblocksection>
                    </apex:tab>
                </apex:tabPanel>
            </apex:pageBlock>   

            <apex:outputPanel rendered="{!!readOnlyUser}"><button type="button" onclick="lineModal_ok()">{!$Label.salesorder_pagebtn_OK}</button></apex:outputPanel>
            <button type="button" class="close" onclick="lineModal_cancel()">{!$Label.salesorder_pagebtn_Cancel}</button>
        </div>
        
        <button style="visibility:hidden" class="btnPopupComponents" rel="#winPComponents"></button>
        <div class="modal" id="winPComponents" style="height:560px;width:1350px" >
            <apex:inputHidden id="component_lineid__c" />
            <h2>{!$Label.salesOrder_Sales_Order_Line_Components}</h2>
            <!-- the external content is loaded inside this tag <div class="contentWrap"> -->
            <iframe id="PopupComponentsFrame" height="520px" width="100%" frameborder="0" src="about:blank"></iframe>
            <button id="btnPopupComponentsClose" type="button" class="close" onclick="component_close()">{!$Label.rstk__salesorder_pagebtn_close}</button>
        </div>
        
        <button style="visibility:hidden" class="btnPopupATP" rel="#winATP"></button>
        <div class="modal" id="winATP" style="height:560px;width:900px;z-index:20000" >
            <h2>{!$Label.ATP_Not_functional_as_a_popup_will_redirect_to_a_full_page_instead}</h2>
            <apex:inputHidden id="atp_icitem__c" />
            <iframe id="PopupATPFrame" height="520px" width="100%" frameborder="0" src="about:blank"></iframe>
            <button type="button" onclick="atp_ok()">{!$Label.salesorder_pagebtn_OK}</button>
            <button id="btnPopupATPClose" type="button" class="close" onclick="atp_close()">{!$Label.salesorder_pagebtn_Cancel}</button>
        </div>
        
        <button style="visibility:hidden" class="btnPopupNotesAttachments" rel="#winNotesAttachments"></button>
        <div class="modal" id="winNotesAttachments" style="height:560px;width:900px" >
            <apex:inputHidden id="notes_lineid__c" />
            <h2>{!$Label.Sales_Order_Line_Notes_and_Attachments}</h2>
            <!-- the external content is loaded inside this tag <div class="contentWrap"> -->
            <iframe id="PopupNotesAttachmentsFrame" height="520px" width="100%" frameborder="0" src="about:blank"></iframe>
            <button id="btnPopupNotesAttachmentsClose" type="button" class="close" onclick="notes_close()">{!$Label.rstk__salesorder_pagebtn_close}</button>
        </div>

        <button style="visibility:hidden" class="btnPopupPayment" rel="#winPayment"></button>
        <div class="modal" id="winPayment" style="height:560px;width:900px" >
            <h2>{!$Label.rstk__processauthorizationsandpayments}</h2>
            <!-- the external content is loaded inside this tag <div class="contentWrap"> -->
            <iframe id="PopupPaymentFrame" height="520px" width="100%" frameborder="0" src="about:blank"></iframe>
            <button id="btnPopupPaymentClose" type="button" class="close" onclick="payment_close()">{!$Label.rstk__salesorder_pagebtn_close}</button>
        </div>

        <button style="visibility:hidden" class="btnPopupSerials" rel="#winSerials"></button>
        <div class="modal" id="winSerials" style="height:560px;width:900px" >
            <h2>{!$Label.Sales_Order_Serial_Details}</h2>
             <iframe id="PopupSerialsFrame" height="520px" width="100%" frameborder="0" src="about:blank"></iframe>
            <button id="btnPopupSerialsClose" type="button" class="close">{!$Label.rstk__salesorder_pagebtn_close}</button>
        </div>
                        
        <apex:pageBlock id="pb" mode="detail">
            <apex:outputPanel rendered="{!AND(transactionsInBackground, !readOnlyUser)}">
                   <apex:image value="/img/msg_icons/warning16.png"/>
                    <apex:outputLabel value="{!$Label.rstk__transactionsrunninginbackgroundmayaffectthisorder}"/>
                    <apex:commandbutton value="{!$Label.rstk__pagebtn_poreceipt_refreshpage}" onclick="doView();return false;"/>
            </apex:outputPanel>
            <apex:pageBlockButtons >
                <apex:commandButton onclick="doPagePreSave();return false;" value="{!$Label.rstk__pagebtn_save}" rendered="{!AND(isEditable,!readOnlyUser)}" style="width:50px"/>
                <c:standardButtons cntr="{!controller}" disableSave="true"/>
                <apex:outputPanel rendered="{!!readOnlyUser}"><apex:commandbutton value="{!IF(isQuote,$Label.rstk__salesorder_add_new_quote,$Label.rstk__salesorder_add_new_order)}" onclick="blockUI(); return doNew();" /></apex:outputPanel>
                <input type="button" class="btn addressesBtn" value="{!$Label.salesorder_pagebtn_Addresses}" onclick="showAddresses();" disabled="disabled" />
                <apex:outputPanel rendered="{!!readOnlyUser}"><apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_firmalllines}" onclick="return firm();" rendered="{!o.Id != null && !isQuote}" /></apex:outputPanel>
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_customeraccountinquiry}" onclick="return custacctInquiry();" rendered="{!o.Id != null}" />
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_commissiondetail}" onclick="return orderOvrComm();" rendered="{!AND(o.Id != null, !pageOptions.hideCommission)}" />
                <apex:outputPanel rendered="{!!readOnlyUser}"><apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_orderfulfillment}" onclick="return fulFillment();" rendered="{!o.Id != null && !isQuote}" /></apex:outputPanel>
                <apex:commandbutton value="{!IF(isQuote,$Label.rstk__salesorder_quote_print,$Label.rstk__salesorder_order_review)}" onclick="return printAcknowledgement();" rendered="{!o.Id != null}" />
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_trackshipments}" onclick="_showDialog('trackPopup',900);return false;" rendered="{!o.Id != null && !isQuote}" />
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_convertquotetoorder}" onclick="return convertQuoteToOrder();" rendered="{!o.Id != null && isQuote}" />
                <apex:outputPanel rendered="{!!readOnlyUser}">
                  <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_clone}" onclick="return cloneOrder();" rendered="{!o.Id != null}" />
                  <apex:commandbutton id="dealPriceAllocationButton" value="{!$Label.rstk__pagebtn_contract_dealpriceallocation}" onclick="return doDealPriceAllocation();" rendered="{!pageOptions.showDealPriceAllocation}"/>
                  <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_quickentry}" onclick="return showQuickEntryGrid();" rendered="{!!isNew}" />
                  <apex:commandbutton value="{!$Label.rstk__setduedateonalllinesbuttontext}" onclick="return setDueDateOnAllLines();" rendered="{!!isNew}" />
                </apex:outputPanel>
                <apex:commandbutton value="{!$Label.rstk__salesorder_pagebtn_createpicklist}" onclick="blockUI();doAutoCreateSOPicklist(); return false;" rendered="{!showPickListButton}"/>
                <apex:commandbutton value="{!$Label.rstk__processauthorizationsandpayments}" onclick="showAuthAndPaymentPopup(); return false;" 
                  rendered="{!AND(sogatewayId != null, OR(!syusr.rstk__syusr_opaylimited__c, syusr.rstk__syusr_opayaccess__c))}"/>
                 <apex:outputpanel rendered="{!AND(!isNew, geoStatus.taxLookup, isStandaloneHeader)}">
                    <input type="button" class="btn"  value="{!$Label.saleorder_pagebtn_CalculateTax}" onclick="return updateAllTaxLines();" style="width:100px;"/>
                 </apex:outputpanel>
                <script>
                  function cloneOrder()
                  {
                    if ({!numLines} > 200) {
                      alert("{!$Label.rstk__salesorder_cannot_clone_orders_with_more_than_200_lines}");
                    } else {
                      window.open("/apex/OrderQuoteCopy?Id={!o.Id}");
                    }
                    return false;
                  }
                </script>
            </apex:pageBlockButtons>
            
            <script>
                function doAfterJobComplete(pl) {
                    displayProcessWarningsAsPageMessage("{!$Label.rstk__pagepopup_salesordercomponents_warning}:", pl);
                    if(pl.iserror__c)
                        unblockUI();
                    else {
                        if (pl.output__c == 'SAVE_SALES_ORDER') {
                          // need to reload the page
                          doReloadPage(pl.warningmessage__c, pl.substatus__c);
                          
                        } else {
                            // Open the new picklist (if one was created)
                            var sopickhid = document.getElementById('sopickhid').value; 
                            var icdmdpicklocs = execQuery("select id from icdmdpickloc__c where icdmdpickloc_sopickh__c = '" + sopickhid + "' Limit 1", true);
                            if(icdmdpicklocs.length > 0) {
                                doCreatePicklistReport();
                            }
                            else {
                                alert("{!$Label.rstk__salesorder_no_lines_on_the_order_qualify_for_picklist_detail}");
                            }
                            unblockUI();
                        }
                    }
                    disableReadOnlyFields();
                  }
                
                  function doCreatePicklistReport() {
                    try {
                        var sopickhid = document.getElementById('sopickhid').value;
                        if(isRootDoxforPL){
                            var rootFormTemplate = socntl.socntl_picktemplate__c;
                            if(rootFormTemplate){
                                window.open('/apex/printDOX?oid='+sopickhid+'&t=' + rootFormTemplate );
                            }else{
                                alert('{!$Label.rstk__invalidtemplateid}');
                            }
                        }else{
                            var picklistSequence = document.getElementById('picklistSequence').value;
                            var printSOLineInternalNotes = document.getElementById('printSOLineInternalNotes').value;
                            var printSOLineExternalNotes = document.getElementById('printSOLineExternalNotes').value;
                            var printCustProdNameAndDesc = document.getElementById('printCustProdNameAndDesc').value;
                            var printEnhancedCustInfoInHdr = document.getElementById('printEnhancedCustInfoInHdr').value;
                            var printItemDescription = document.getElementById('printItemDescription').value;
                            
                            if(socntl.socntl_templatepicklist__c) {
                                window.open('/apex/SOPicklistPrint?id=' + sfffGetRecordId() + '&sopickhid=' + sopickhid +'&barcode=true&picklistSequence=' + picklistSequence + 
                                        '&printSOLineInternalNotes=' + printSOLineInternalNotes + 
                                        '&printSOLineExternalNotes=' + printSOLineExternalNotes + 
                                        '&printCustProdNameAndDesc=' + printCustProdNameAndDesc + 
                                        '&printItemDescription=' + printItemDescription + 
                                        '&printEnhancedCustInfoInHdr=' + printEnhancedCustInfoInHdr, 'toolbar=0,resizeable=0');
                            }
                            else {
                                window.open('/apex/SOPicklistPdf?sopickhid='+ sopickhid +'&barcode=true&picklistSequence=' + picklistSequence + 
                                        '&printSOLineInternalNotes=' + printSOLineInternalNotes + 
                                        '&printSOLineExternalNotes=' + printSOLineExternalNotes + 
                                        '&printCustProdNameAndDesc=' + printCustProdNameAndDesc + 
                                        '&printItemDescription=' + printItemDescription + 
                                        '&printEnhancedCustInfoInHdr=' + printEnhancedCustInfoInHdr, 'toolbar=0,resizeable=0');
                             }
                        }
                    } catch (e) {
                        alert(e);
                        console.log(e.stack);
                    } finally {
                        return false;
                    }
                }
            </script>
            <div style="float:left;width:15%">
                <apex:image value="{!CustomerImage}" alt="Logo" style="align:center;max-width:160px;max-height:160px;width:auto;height:auto;"/>
            </div>
            <div id="detailBlock1" style="width:55%;float:left">
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_div__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_div__c.label}"/>
                        <apex:outputField value="{!o.rstk__sohdr_div__c}" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_otype__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_otype__c.label}"/>
                        <c:LocalSelect id="sohdr_otype__c" value="{!o.rstk__sohdr_otype__c}" width="150px"/>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_order__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_order__c.label}"/>
                        <apex:outputPanel >
                            <apex:inputField id="sohdr_order__c" value="{!o.rstk__sohdr_order__c}" />
                            <apex:outputPanel rendered="{!AND(isNew, socntl.rstk__socntl_autoorder__c)}">
                                <apex:inputCheckbox id="autoOrderNumber" value="{!autoOrderNumber}" rendered="{!!socntl.rstk__socntl_onlyautoorder__c}"
                                   onchange="autoOrderNumberChanged(); return false;"/>
                                {!$Label.rstk__autoassignonsave}
                            </apex:outputPanel>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ustat__c.inlineHelpText}">
                        <apex:outputlabel value="{!f.rstk__sohdr_ustat__c.label}"/>
                        <c:LocalSelect id="sohdr_ustat__c" value="{!o.rstk__sohdr_ustat__c}" width="200px"/>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custno__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_custno__c.label}"/>
                        <apex:outputPanel >
                            <apex:outputText id="customername" value="{!o.sohdr_custno__r.Name}" style="display:none;"/>
                            <apex:outputField id="custlink" value="{!o.rstk__sohdr_custno__c}" rendered="{!!isNew}"/>
                            <apex:inputHidden id="socust_custno__c" value="{!o.sohdr_custno__r.rstk__socust_custno__c}"/>
                            <apex:inputHidden id="socust_resalecert__c" value="{!o.sohdr_custno__r.rstk__socust_resalecert__c}"/>
                            <c:autocomplete id="sohdr_custno__c" cntr="{!controller}" slDesc="" required="true" minChars="{!CustMinCharForAutoComplete}"
                               query="select id, name from socust__c where socust_inactive__c = false" queryParms="[]"  rendered="{!isNew}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custpo__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_custpo__c.label}"/>
                        <apex:inputField id="sohdr_custpo__c" value="{!o.rstk__sohdr_custpo__c}" />
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_orderdate__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_orderdate__c.label}"/>
                        <apex:inputField id="sohdr_orderdate__c" value="{!o.rstk__sohdr_orderdate__c}" required="true"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custref__c.inlineHelpText}">
                        <apex:outputLabel value="{!f.rstk__sohdr_custref__c.label}"/>
                        <apex:inputField id="sohdr_custref__c" value="{!o.rstk__sohdr_custref__c}" />
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
                <apex:pageBlockSection >
                     <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_proj__c.inlineHelpText}">
                         <apex:outputLabel value="{!f.rstk__sohdr_proj__c.label}"/>
                         <apex:outputPanel >
                           <apex:inputHidden id="sohdr_proj__c" value="{!o.rstk__sohdr_proj__c}"/>
                           <apex:inputText id="sohdr_textproj__c" styleClass="ac_input" style="width:250px"  tabindex="130"/>
                           <script>
                             var acId    = document.getElementById('{!$Component.sohdr_proj__c}');
                             var acInput = jQuery(document.getElementById('{!$Component.sohdr_textproj__c}'));
                             setupAutocompleteFieldData(acInput[0],acId, []);
                             acInput.val(editingProjectNames[acId.value]);
                           </script>
                       </apex:outputPanel>
                     </apex:pageBlockSectionItem>
                     <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_contract__c.inlineHelpText}" rendered="{!pageOptions.showContract}">
                        <apex:outputLabel value="{!f.rstk__sohdr_contract__c.label}"/>
                        <apex:outputPanel >
                            <apex:outputField value="{!o.rstk__sohdr_contract__c}" rendered="{!AND(ISNULL(pageOptions.editableContractMode), !ISNULL(o.rstk__sohdr_contract__c))}"/>
                            <apex:outputPanel rendered="{!AND(ISNULL(o.rstk__sohdr_contract__c), pageOptions.editableContractMode == 'CREATE')}">
                            <a id="sohdr_contract__c_link" href="#" onclick="openContractPopup(); return false;">{!$Label.salesOrder_Create_Contract}</a>
                            </apex:outputPanel>
                            <select size="1" id="sohdr_textsocontract__c" style="width:250px;{!IF(pageOptions.editableContractMode == 'SELECT','','display:none')}">
                                <option value=""> </option>
                            </select>
                            <apex:inputHidden id="sohdr_contract__c" value="{!o.rstk__sohdr_contract__c}"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
            </div>
            
            <div style="width:15%;float:left;">
                <div id="detailBlock2" style="border:1px solid #dddddd;border-radius:5px;width:100%;float:left;{!IF(isQuote,'visibility:hidden;','')}">
                    <apex:pageBlockSection columns="1">
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_closed__c.inlineHelpText}">
                            <apex:outputField id="sohdr_closed__c" value="{!o.rstk__sohdr_closed__c}" />
                            <apex:outputLabel value="{!f.rstk__sohdr_closed__c.label}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_cancelled__c.inlineHelpText}">
                            <apex:outputField id="sohdr_cancelled__c" value="{!o.rstk__sohdr_cancelled__c}" />
                            <apex:outputLabel value="{!f.rstk__sohdr_cancelled__c.label}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_credithold__c.inlineHelpText}">
                            <apex:outputField id="sohdr_credithold__c" value="{!o.rstk__sohdr_credithold__c}" />
                            <apex:outputLabel value="{!f.rstk__sohdr_credithold__c.label}"/>
                    </apex:pageBlockSectionItem>
                     <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_hold__c.inlineHelpText}">
                            <apex:outputField id="sohdr_hold__c" value="{!o.rstk__sohdr_hold__c}" />
                            <apex:outputLabel value="{!f.rstk__sohdr_hold__c.label}"/>
                    </apex:pageBlockSectionItem>
                    </apex:pageBlockSection>
                </div>
                <apex:pageBlockSection columns="1">
                   <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_equipsale__c.inlineHelpText}" rendered="{!pageOptions.showEquip}">
                       <apex:outputLabel value="{!f.rstk__sohdr_equipsale__c.label}"/>
                       <apex:outputPanel >
                        <apex:inputField id="sohdr_equipsale__c" value="{!o.rstk__sohdr_equipsale__c}" rendered="{!pageOptions.editableEquipSales}"/>
                        <apex:outputField value="{!o.rstk__sohdr_equipsale__c}" rendered="{!!pageOptions.editableEquipSales}"/>
                       </apex:outputPanel>
                   </apex:pageBlockSectionItem>
                 </apex:pageBlockSection>
            </div>
            
            <div id="divider" style="clear:both"></div>
            <apex:pageBlockSection id="advancedBlock" title="{!$Label.rstk__pagetab_salesorder_advanced}" showHeader="true" collapsible="true" columns="1">
                <apex:tabPanel switchType="client" id="pbs_tp">
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_reference}">
                        <div style="width:800px">
                        <apex:pageBlockSection columns="3">
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_agreement__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_agreement__c.label}"/>
                                <c:LocalSelect id="sohdr_agreement__c" value="{!o.rstk__sohdr_agreement__c}" width="250px"/>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_quote__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_quote__c.label}"/>
                                <apex:inputField id="sohdr_quote__c" value="{!o.rstk__sohdr_quote__c}" />
                            </apex:pageBlockSectionItem>
                                                        
                            <apex:pageBlockSectionItem />
                            
                            <!-- Column Break -->
                                                        
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custrev__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_custrev__c.label}"/>
                                <apex:inputField id="sohdr_custrev__c" value="{!o.rstk__sohdr_custrev__c}" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_resp__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_resp__c.label}"/>
                                <c:LocalSelect id="sohdr_resp__c" value="{!o.rstk__sohdr_resp__c}" width="150px"/>
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_pricingcust__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_pricingcust__c.label}"/>
                                <c:LocalSelect id="sohdr_pricingcust__c" value="{!o.rstk__sohdr_pricingcust__c}" width="250px"/>
                            </apex:pageBlockSectionItem>
                            
                            <!-- Column Break -->
                            
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_quotesf__c.inlineHelpText}" rendered="{!!isQuote}">
                                <apex:outputLabel value="{!f.rstk__sohdr_quotesf__c.label}"/>
                                <apex:outputField id="sohdr_quotesf__c" value="{!o.rstk__sohdr_quotesf__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_quotesf__c.inlineHelpText}" rendered="{!isQuote}"/>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_opportunity__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_opportunity__c.label}"/>
                                <apex:outputField id="sohdr_opportunity__c" value="{!o.rstk__sohdr_opportunity__c}" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_povend__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_povend__c.label}"/>
                                <c:autocomplete id="sohdr_povend__c" cntr="{!controller}" required="false" slDesc="{!o.sohdr_povend__r.Name}"
                                    query="select id, name from povend__c where povend_onetimeind__c = false" queryParms="[]"/>
                            </apex:pageBlockSectionItem>
                            
                            <!-- Column Break -->

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_confsess__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_confsess__c.label}"/>
                                <apex:outputField id="sohdr_confsess__c" value="{!o.rstk__sohdr_confsess__c}" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_doclanguage__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_doclanguage__c.label}"/>
                                <apex:inputField id="sohdr_doclanguage__c" value="{!o.rstk__sohdr_doclanguage__c}" />
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem />
                        </apex:pageBlockSection>
                        </div>
                    </apex:tab>
                    
                    <apex:tab id="shippingTab" label="{!$Label.rstk__pagetab_salesorder_shipping}">
                        <div style="width:800px">
                        <apex:pageBlockSection columns="3">
                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_fob__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_fob__c.label}"/>
                                <c:LocalSelect id="sohdrextn_fob__c" value="{!sohdrextn.rstk__sohdrextn_fob__c}" width="200px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_soregion__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_soregion__c.label}"/>
                                <c:LocalSelect id="sohdrextn_soregion__c" value="{!sohdrextn.rstk__sohdrextn_soregion__c}"/>
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_nopartials__c.inlineHelpText}">
                                <apex:outputPanel >
                                    <apex:inputField id="sohdr_nopartials__c" value="{!o.rstk__sohdr_nopartials__c}" rendered="{!!anyLinesPackaged}"/>
                                    <apex:outputField value="{!o.rstk__sohdr_nopartials__c}" rendered="{!anyLinesPackaged}"/>
                                </apex:outputPanel>
                                <apex:outputLabel value="{!f.rstk__sohdr_nopartials__c.label}"/>
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_fterms__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_fterms__c.label}"/>
                                <c:LocalSelect id="sohdrextn_fterms__c" value="{!sohdrextn.rstk__sohdrextn_fterms__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_taxfreight__c.inlineHelpText}">
                                <apex:inputField id="sohdr_taxfreight__c" value="{!o.rstk__sohdr_taxfreight__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_taxfreight__c.label}"/>
                            </apex:pageBlockSectionItem>
 
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_totalweight__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_totalweight__c.label}"/>
                                <apex:outputField id="sohdr_totalweight__c" value="{!o.rstk__sohdr_totalweight__c}" />
                            </apex:pageBlockSectionItem>
 
                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_carrier__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_carrier__c.label}"/>
                                <c:LocalSelect id="sohdrextn_carrier__c" value="{!sohdrextn.rstk__sohdrextn_carrier__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_taxpackaging__c.inlineHelpText}">
                                <apex:inputField id="sohdr_taxpackaging__c" value="{!o.rstk__sohdr_taxpackaging__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_taxpackaging__c.label}"/>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem />

                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_shipvia__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_shipvia__c.label}" />
                                <c:LocalSelect id="sohdrextn_shipvia__c" value="{!sohdrextn.rstk__sohdrextn_shipvia__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_taxhandling__c.inlineHelpText}">
                                <apex:inputField id="sohdr_taxhandling__c" value="{!o.rstk__sohdr_taxhandling__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_taxhandling__c.label}"/>
                            </apex:pageBlockSectionItem>

                            <apex:pageBlockSectionItem />
                            
                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_sydivaddr__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_sydivaddr__c.label}"/>
                                <c:LocalSelect id="sohdrextn_sydivaddr__c" value="{!sohdrextn.rstk__sohdrextn_sydivaddr__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_usecustcarr__c.inlineHelpText}">
                                <apex:inputField id="sohdr_usecustcarr__c" value="{!o.rstk__sohdr_usecustcarr__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_usecustcarr__c.label}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custcarracct__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_custcarracct__c.label}"/>
                                <apex:inputField id="sohdr_custcarracct__c" value="{!o.rstk__sohdr_custcarracct__c}" />
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_frtmarkuppct__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_frtmarkuppct__c.label}" />
                               <apex:inputField id="sohdr_frtmarkuppct__c" value="{!o.rstk__sohdr_frtmarkuppct__c}" />
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem rendered="{!!isNew}">
                              <input class="btn" type="Button" value="{!$Label.salesorder_pagebtn_CalculateFreightCharges}" onclick="onCalculateFreightCharges(); return false;" width="200px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!isNew}"/>
                            
                            <apex:pageBlockSectionItem rendered="{!!isNew}">
                              <input class="btn" type="Button" value="{!$Label.salesorder_pagebtn_OrderPackageDetail}" onclick="onOrderPackageDetail(); return false;" width="200px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!isNew}"/>
                            
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_verifiedshiptax__c.inlineHelpText}" rendered="{!geoStatus.taxLookup}">
                                <apex:outputLabel value="{!f.rstk__sohdr_verifiedshiptax__c.label}" style="width:120px"/>
                                <apex:outputpanel >
                                <apex:inputField id="sohdr_verifiedshiptax__c" value="{!o.rstk__sohdr_verifiedshiptax__c}" />
                                <script>jQuery(document.getElementById("{!$Component.sohdr_verifiedshiptax__c}")).attr('disabled', 'disabled');</script>
                                <apex:inputHidden id="sohdr_verifiedtaxind__c" value="{!o.rstk__sohdr_verifiedtaxind__c}" />
                                </apex:outputpanel>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem rendered="{!!geoStatus.taxLookup}"/>

                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_loadid__c.inlineHelpText}" rendered="{!pageOptions.revenova}">
                                <apex:outputLabel value="{!f.rstk__sohdr_loadid__c.label}"/>
                                <a target="_blank" id="static_sohdr_loadid__c"></a>
                            </apex:pageBlockSectionItem>

                        </apex:pageBlockSection>
                        </div>
                    </apex:tab>
                    
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_charges}">
                        <table width="100%">
                            <tr width="100%">
                                <td width="33%" style="border:1px solid #dddddd;border-radius:5px;">
                                    <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_sumfrt__c.inlineHelpText}">
                                            <apex:inputField id="sohdr_sumfrt__c" value="{!o.rstk__sohdr_sumfrt__c}" />
                                            <apex:outputLabel value="{!f.rstk__sohdr_sumfrt__c.label}"/>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_freightamt__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_freightamt__c.label}"/>
                                            <apex:inputField id="sohdr_freightamt__c" value="{!o.rstk__sohdr_freightamt__c}" />
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_freightacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_extn.rstk__sohdrextn_freightacct__c.label}"/>
                                            <apex:selectList id="sohdrextn_freightacct__c" value="{!sohdrextn.rstk__sohdrextn_freightacct__c}" 
                                                size="1" style="width:250px" required="true">
                                                <apex:selectOptions value="{!accounts}"/>
                                            </apex:selectlist>
                                        </apex:pageBlockSectionItem>
                                    </apex:pageBlockSection>
                                </td>
                                <td width="33%" style="border:1px solid #dddddd;border-radius:5px;">
                                    <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_sumpackage__c.inlineHelpText}">
                                            <apex:inputField id="sohdr_sumpackage__c" value="{!o.rstk__sohdr_sumpackage__c}" />
                                            <apex:outputLabel value="{!f.rstk__sohdr_sumpackage__c.label}"/>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_packageamt__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_packageamt__c.label}"/>
                                            <apex:inputField id="sohdr_packageamt__c" value="{!o.rstk__sohdr_packageamt__c}" />
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_packageacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_extn.rstk__sohdrextn_packageacct__c.label}"/>
                                            <apex:selectList id="sohdrextn_packageacct__c" value="{!sohdrextn.rstk__sohdrextn_packageacct__c}" 
                                                size="1" style="width:250px" required="true">
                                                <apex:selectOptions value="{!accounts}"/>
                                            </apex:selectlist>
                                        </apex:pageBlockSectionItem>
                                    </apex:pageBlockSection>
                                </td>
                                <td width="34%" style="border:1px solid #dddddd;border-radius:5px;{!IF(pageOptions.showAltPricing,'', 'display:none;')}">
                                    <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_alt1ordertotal__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_alt1ordertotal__c.label}"/>
                                            <apex:outputPanel >
                                                <apex:outputField id="sohdr_alt1ordertotal__c" value="{!o.rstk__sohdr_alt1ordertotal__c}" rendered="{!!o.rstk__sohdr_custcurrency__c}"/>
                                                <apex:outputField id="sohdr_alt1ordertotalcc__c" value="{!o.rstk__sohdr_alt1ordertotalcc__c}" rendered="{!o.rstk__sohdr_custcurrency__c}"/>
                                                <span name="maintenanceCurrencySymbol">{!maintenanceCurrencySymbol}</span>
                                            </apex:outputPanel>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_alt2ordertotal__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_alt2ordertotal__c.label}"/>
                                            <apex:outputPanel >
                                                <apex:outputField id="sohdr_alt2ordertotal__c" value="{!o.rstk__sohdr_alt2ordertotal__c}" rendered="{!!o.rstk__sohdr_custcurrency__c}"/>
                                                <apex:outputField id="sohdr_alt2ordertotalcc__c" value="{!o.rstk__sohdr_alt2ordertotalcc__c}" rendered="{!o.rstk__sohdr_custcurrency__c}"/>
                                                <span name="maintenanceCurrencySymbol">{!maintenanceCurrencySymbol}</span>
                                            </apex:outputPanel>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ordertotal__c.inlineHelpText}">
                                            <apex:outputLabel value="{!$Label.rstk__ordertotalusingstandardprices}"/>
                                            <apex:outputPanel >
                                                <apex:outputField id="sohdr_ordertotal__c" value="{!o.rstk__sohdr_ordertotal__c}" rendered="{!!o.rstk__sohdr_custcurrency__c}"/>
                                                <apex:outputField id="sohdr_ordertotalcc__c" value="{!o.rstk__sohdr_ordertotalcc__c}" rendered="{!o.rstk__sohdr_custcurrency__c}"/>
                                                <span name="maintenanceCurrencySymbol">{!maintenanceCurrencySymbol}</span>
                                            </apex:outputPanel>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_antcosttotal__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_antcosttotal__c.label}"/>
                                            <apex:outputField id="sohdr_antcosttotal__c" value="{!o.rstk__sohdr_antcosttotal__c}" />
                                        </apex:pageBlockSectionItem>
                                    </apex:pageBlockSection>
                                </td>
                            </tr>
                            <tr width="100%">
                                <td width="33%" style="border:1px solid #dddddd;border-radius:5px;">
                                    <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_sumhand__c.inlineHelpText}">
                                            <apex:inputField id="sohdr_sumhand__c" value="{!o.rstk__sohdr_sumhand__c}" />
                                            <apex:outputLabel value="{!f.rstk__sohdr_sumhand__c.label}"/>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_handlingamt__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_handlingamt__c.label}"/>
                                            <apex:inputField id="sohdr_handlingamt__c" value="{!o.rstk__sohdr_handlingamt__c}" />
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_handlingacct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f_extn.rstk__sohdrextn_handlingacct__c.label}"/>
                                            <apex:selectList id="sohdrextn_handlingacct__c" value="{!sohdrextn.rstk__sohdrextn_handlingacct__c}" 
                                                size="1" style="width:250px" required="true">
                                                <apex:selectOptions value="{!accounts}"/>
                                            </apex:selectlist>
                                        </apex:pageBlockSectionItem>
                                    </apex:pageBlockSection>
                                </td>
                                <td width="33%" style="border:1px solid #dddddd;border-radius:5px;">
                                    <apex:pageBlockSection columns="1">
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_taxexempt__c.inlineHelpText}">
                                            <apex:inputField id="sohdr_taxexempt__c" value="{!o.rstk__sohdr_taxexempt__c}" />
                                            <apex:outputLabel value="{!f.rstk__sohdr_taxexempt__c.label}"/>
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_discpct__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_discpct__c.label}"/>
                                            <apex:inputField id="sohdr_discpct__c" value="{!o.rstk__sohdr_discpct__c}" />
                                        </apex:pageBlockSectionItem>
                                        <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_pricebook__c.inlineHelpText}">
                                            <apex:outputLabel value="{!f.rstk__sohdr_pricebook__c.label}"/>
                                            <c:LocalSelect id="sohdr_pricebook__c" value="{!o.rstk__sohdr_pricebook__c}" width="200px"/>
                                        </apex:pageBlockSectionItem>
                                    </apex:pageBlockSection>
                                </td>
                            </tr>
                        </table>
                    </apex:tab>
                     
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_credit}" style="{!IF(isQuote,'display:none;','')}">
                        <div style="width:800px">
                        <apex:pageBlockSection >
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_creditorg__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_creditorg__c.label}"/>
                                <c:LocalSelect id="sohdr_creditorg__c" value="{!o.rstk__sohdr_creditorg__c}" width="200px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_unbilledorders__c.inlineHelpText}">
                                <apex:outputLabel style="width:150px" value="{!f_socust.rstk__socust_unbilledorders__c.label}"/>
                                <apex:outputField id="socust_unbilledorders__c" value="{!fcust.rstk__socust_unbilledorders__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_terms__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_terms__c.label}"/>
                                <c:LocalSelect id="sohdr_terms__c" value="{!o.rstk__sohdr_terms__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_maxunbilled__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_socust.rstk__socust_maxunbilled__c.label}"/>
                                <apex:outputField id="socust_maxunbilled__c" value="{!fcust.rstk__socust_maxunbilled__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_hold__c.inlineHelpText}">
                                <apex:inputField id="sohdr_hold__c" value="{!o.rstk__sohdr_hold__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_hold__c.label}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_arbalance__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_socust.rstk__socust_arbalance__c.label}"/>
                                <apex:outputField id="socust_arbalance__c" value="{!fcust.rstk__socust_arbalance__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_manholdreason__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_manholdreason__c.label}"/>
                                <apex:selectlist id="sohdr_manholdreason__c" value="{!o.rstk__sohdr_manholdreason__c}" size="1" style="width:250px">
                                    <apex:selectOptions value="{!reasons}"/>
                                </apex:selectlist>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_creditlimit__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_socust.rstk__socust_creditlimit__c.label}"/>
                                <apex:outputField id="socust_creditlimit__c" value="{!fcust.rstk__socust_creditlimit__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_ccardorder__c.inlineHelpText}">
                                <apex:outputField value="{!o.rstk__sohdr_ccardorder__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_ccardorder__c.label}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_prepayonly__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_socust.rstk__socust_prepayonly__c.label}"/>
                                <apex:outputPanel >
                                <input type="checkbox" id="socust_prepayonly__c"/>
                                <script>
                                   jQuery("input[id$=socust_prepayonly__c]").attr('checked', {!IF(fcust.socust_prepayonly__c,'"checked"','""')});
                                </script>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_cctxnid__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_cctxnid__c.label}"/>
                                <apex:outputField value="{!o.rstk__sohdr_cctxnid__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_credithold__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_credithold__c.label}"/>
                                <apex:inputField id="sohdr_credithold__c" value="{!o.rstk__sohdr_credithold__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_custcurrency__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_custcurrency__c.label}"/>
                                <apex:outputPanel >
                                <apex:outputField value="{!o.rstk__sohdr_custcurrency__c}" rendered="{!!isNew}"/>
                                <apex:inputField id="sohdr_custcurrency__c" value="{!o.rstk__sohdr_custcurrency__c}" style="display:none;"/>
                               <apex:outputText id="sohdr_currexchrate__c" value="{!o.rstk__sohdr_currexchrate__c}" style="display:none;"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f_socust.rstk__socust_fincust__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_socust.rstk__socust_fincust__c.label}"/>
                                <apex:outputPanel >
                                    <apex:outputField id="socust_fincust__c" value="{!socust.rstk__socust_fincust__c}" rendered="{!!isNew}"/>
                                    <apex:outputPanel rendered="{!isNew}">
                                        <a id="fincust" href="#"></a>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                             <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_sellerpaysbc__c.inlineHelpText}" rendered="{!AND(!isNew, isPayBankCharge)}">
                                <apex:outputLabel value="{!f.rstk__sohdr_sellerpaysbc__c.label}"/>
                                <apex:inputField id="sohdr_sellerpaysbc__c" value="{!o.rstk__sohdr_sellerpaysbc__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!AND(isRootStockFinancials, o.rstk__sohdr_custcurrency__c)}">                            
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem rendered="{!AND(isRootStockFinancials, o.rstk__sohdr_custcurrency__c)}">
                            	<input type="button" class="btn" name="ovrExchButton" value="{!$Label.rstk__override_exchange_rate}" onclick="blockUI();checkForOverrideExchangePopUp();" />
                            </apex:pageBlockSectionItem>                            
                          </apex:pageBlockSection>
                        </div>
                    </apex:tab>

                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_contact}">
                        <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem helpText="{!f_extn.rstk__sohdrextn_socontact__c.inlineHelpText}">
                                <apex:outputLabel value="{!f_extn.rstk__sohdrextn_socontact__c.label}"/>
                                <c:LocalSelect id="sohdrextn_socontact__c" value="{!sohdrextn.rstk__sohdrextn_socontact__c}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_conemail__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_conemail__c.label}"/>
                                <apex:inputField id="sohdr_conemail__c" value="{!o.rstk__sohdr_conemail__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_conphone__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_conphone__c.label}"/>
                                <apex:inputField id="sohdr_conphone__c" value="{!o.rstk__sohdr_conphone__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_confax__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_confax__c.label}"/>
                                <apex:inputField id="sohdr_confax__c" value="{!o.rstk__sohdr_confax__c}" />
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_conmethod__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_conmethod__c.label}"/>
                                <apex:selectlist id="sohdr_conmethod__c" value="{!o.rstk__sohdr_conmethod__c}" size="1">
                                    <apex:selectOptions value="{!contactMethods}"/>
                                </apex:selectlist>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_cancel_reverse}" rendered="{!o.Id != null}">
                        <apex:pageBlockSection columns="2">
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_cancelled__c.inlineHelpText}">
                                <apex:inputField id="sohdr_cancelled__c" value="{!o.rstk__sohdr_cancelled__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_cancelled__c.label}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_closed__c.inlineHelpText}">
                                <apex:inputField id="sohdr_closed__c" value="{!o.rstk__sohdr_closed__c}" />
                                <apex:outputLabel value="{!f.rstk__sohdr_closed__c.label}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_canreason__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_canreason__c.label}"/>
                                <apex:selectlist id="sohdr_canreason__c" value="{!o.rstk__sohdr_canreason__c}" size="1" style="width:250px">
                                    <apex:selectOptions value="{!reasons}"/>
                                </apex:selectlist>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem />
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_candate__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_candate__c.label}"/>
                                <apex:inputField id="sohdr_candate__c" value="{!o.rstk__sohdr_candate__c}" />
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_comments}" >
                        <div style="width:800px">
                            <c:HelpLabel label="{!f.rstk__sohdr_intcomment__c.label}" helpText="{!f.rstk__sohdr_intcomment__c.inlineHelpText}"/>
                            <apex:inputTextarea id="sohdr_intcomment__c" value="{!o.rstk__sohdr_intcomment__c}" rows="6" richtext="true" disabled="{!readOnlyUser}"/>
                            <br></br>
                            <c:HelpLabel label="{!f.rstk__sohdr_extcomment__c.label}" helpText="{!f.rstk__sohdr_extcomment__c.inlineHelpText}"/>
                            <apex:inputTextarea id="sohdr_extcomment__c" value="{!o.rstk__sohdr_extcomment__c}" rows="6" richtext="true" disabled="{!readOnlyUser}"/>
                        </div>
                    </apex:tab>
                    <apex:tab label="{!customFieldTabName}" name="tab_Custom" id="tab_Custom" rendered="{!hasCustomFields}">
                        <apex:pageblocksection columns="2" id="pbsRSF">
                            <apex:repeat value="{!customFields}" var="hcf">
                                <apex:inputfield value="{!o[hcf.fieldPath]}" required="{!OR(hcf.required, hcf.dbrequired)}"/>  
                            </apex:repeat>  
                        </apex:pageblocksection>
                    </apex:tab>
                     <apex:tab label="{!$Label.rstk__pagetab_salesorder_audit}" style="{!IF(isQuote,'display:none;','')}" ontabenter="audit_load(false);" rendered="{!!isNew}">

            <c:FrameGrid height="400px" preLoad="false" jsController="audit" page="/apex/SalesOrderAudit" rootId="{!o.Id}"/>

                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_quotedetails}" style="{!IF(isQuote||wasQuote,'','display:none;')}">
                        <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_expdate__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_expdate__c.label}"/>
                                <apex:outputpanel >
                                    <apex:inputField id="sohdr_expdate__c" value="{!o.rstk__sohdr_expdate__c}" rendered="{!isQuote}"/>
                                    <apex:outputField id="static_sohdr_expdate__c" value="{!o.rstk__sohdr_expdate__c}" rendered="{!!isQuote}"/>
                                </apex:outputpanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_convertdate__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_convertdate__c.label}"/>
                                <apex:outputField id="static_sohdr_convertdate__c" value="{!o.rstk__sohdr_convertdate__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_directpurchases}" rendered="{!directPurchasesEnabled}" ontabenter="dp_load(false);">

           <c:FrameGrid height="400px" preLoad="false" jsController="dp" page="/apex/directPO" rootId="{!o.Id}"/>
 
                    </apex:tab>
                   <apex:tab label="{!$Label.rstk__pagetab_salesorder_emailtemplates}">
                        <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_emailtack__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_emailtack__c.label}"/>
                                <c:LocalSelect id="sohdr_emailtack__c" value="{!o.rstk__sohdr_emailtack__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_emailtquote__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_emailtquote__c.label}"/>
                                <c:LocalSelect id="sohdr_emailtquote__c" value="{!o.rstk__sohdr_emailtquote__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_emailtpack__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_emailtpack__c.label}"/>
                                <c:LocalSelect id="sohdr_emailtpack__c" value="{!o.rstk__sohdr_emailtpack__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_emailtinv__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_emailtinv__c.label}"/>
                                <c:LocalSelect id="sohdr_emailtinv__c" value="{!o.rstk__sohdr_emailtinv__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_emailtcredit__c.inlineHelpText}">
                                <apex:outputLabel value="{!f.rstk__sohdr_emailtcredit__c.label}"/>
                                <c:LocalSelect id="sohdr_emailtcredit__c" value="{!o.rstk__sohdr_emailtcredit__c}" width="150px"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                   </apex:tab>
                    
                   <apex:tab label="{!$Label.rstk__pagetab_salesorder_special}" rendered="{!AND(o.Id != null, !readOnlyUser)}">
                         <apex:pageBlockSection columns="1">
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__change_the_customer_associated_with_this_order}">
                                <apex:commandButton value="{!$Label.rstk__pagebtn_salesorder_changecustomer}" onclick="changeCustomer(); return false;" style="width:120px;"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1"> <!--  rendered="{!!isStandaloneHeader}">  -->
                            <apex:pageBlockSectionItem helpText="{!$Label.rstk__update_the_dimension_values_and_case_on_all_lines_for_the_sales_order}">
                                <apex:commandButton value="{!$Label.rstk__pagebtn_salesorder_globallineupdate}" onclick="showGlobalLineUpdatePopup(); return false;" style="width:120px;" disabled="{!sohdr.rstk__sohdr_closed__c}"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="soexport" columns="2" rendered="{!soimpexpenabled}">
                            <apex:commandButton value="{!$Label.rstk__pagebtn_salesorder_exportforaccess}" immediate="true" action="{!soExport}" rerender="pageMessages,sodocdownload" onclick="blockUI();" oncomplete="unblockUI();" style="width:120px;"/>
                            <apex:outputPanel id="sodocdownload">
                                <apex:outputPanel rendered="{!sodoc.Id!=null}">
                                    {!$Label.Download_the_Export_file_here}: 
                                    <a target="_blank" id="sodocdl" href="{!URLFOR($Action.Attachment.Download, sodoc.Id)}" download="{!sodoc.name}">{!sodoc.name}</a>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection id="soimport" columns="2" rendered="{!soimpexpenabled}">
                            <input type="button" class="btn" value="{!$Label.salesorder_pagebtn_Import_from_Access}" onclick="jQuery('#soupdoc')[0].click();" style="width:120px;"/>
                            <input type="file" id="soupdoc" onchange="processSOImportFile();" style='display:none;'/>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1" rendered="{!IsSOMarkupsAndMarginsEnabled}">
                            <apex:pageBlockSectionItem >
                                <apex:commandButton value="{!$Label.rstk__pagebtn_salesorder_markupandmargins}" onclick="return invokeMarkupAndMargins();" style="width:120px;"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                        <apex:pageBlockSection columns="1" rendered="{!pageOptions.congigSOE}">
                            <apex:pageBlockSectionItem >
                                <input type="button" class="btn" value="{!$Label.salesorder_pagebtn_ProductConfigurator}" onclick="return openProductConfigurator(false, true);" style="width:120px;"/>
                            </apex:pageBlockSectionItem>
                        </apex:pageBlockSection>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstk__pagetab_salesorder_info}" name="Info" id="Info" rendered="{!o.Id != null}">
                        <c:infoSection cntr="{!controller}" showHeader="false"/>
                    </apex:tab>

                </apex:tabPanel>
            </apex:pageBlockSection>
            <script>
              if ({!socntl.rstk__socntl_advopen__c}) {
               twistSection(document.getElementById('{!$Component.advancedBlock}').getElementsByTagName('img')[0])
              }
            </script>
            
            <c:Popup popupId="markupAndMarginsPopup" title="{!$Label.rstk__pagepopup_markupsandmargins}" onOk="mkpmgns.applyChanges();" okCaption="Apply Changes" onCustom1="mkpmgns.saveChanges();" custom1Caption="Save Changes">
                <c:FrameGrid height="425px" preLoad="false" jsController="mkpmgns" page="/apex/MarkupsAndMargins" rootId="{!o.Id}"/>
            </c:Popup>
            <script>
                mkpmgns_isloading = false;
                function invokeMarkupAndMargins() {
                    try {
                        if (!_isDialogOpen()) {
                            _showDialog('markupAndMarginsPopup',1300);
                        }
                        if (mkpmgns != null) {
                            mkpmgns.onSaved = function() {
                                showTopDialog('pleaseWaitPopup');
                                doView();
                                return false;
                            }
                            closeTopDialog();
                         } else {
                             // Wait until the page is loaded
                            if (!mkpmgns_isloading) {
                                mkpmgns_load();
                                mkpmgns_isloading = true;
                                showTopDialog('pleaseWaitPopup');
                            }
                            setTimeout(invokeMarkupAndMargins, 200);
                        }
                    } finally {
                        return false;
                    }
                }
            </script>

        <c:Popup popupId="quickEntryGridPopup" title="{!$Label.rstk__pagepopup_quicksolineentry}" onOk="qesolines.saveAndClose();" buttonsOnTop="true">
            <c:FrameGrid height="500px" preLoad="false" jsController="qesolines" page="/apex/QuickEntrySolines" rootId="{!o.Id}"/>
        </c:Popup>
        <script>
          qesolines_isloading = false;
          function showQuickEntryGrid() {
              if (!_isDialogOpen()) {
                _showDialog('quickEntryGridPopup',1300);
              }
              if (qesolines != null) {
                  qesolines.onSaved = function() {
                    showTopDialog('pleaseWaitPopup');
                    doView();
                    return false;
                  }
                  closeTopDialog();
              } else {
                  // Wait until the page is loaded
                  if (!qesolines_isloading) {
                      qesolines_load();
                      qesolines_isloading = true;
                      showTopDialog('pleaseWaitPopup');
                  }
                  setTimeout(showQuickEntryGrid, 200);
              }
              return false;
          }
        </script>

        <c:Popup popupId="authAndPaymentPopup" title="{!$Label.rstk__processauthorizationsandpayments}" onOk="authAndPayment_saveAndClose();" buttonsOnTop="true" okCaption="{!$Label.rstk__commit}">
            <iframe id="authAndPaymentFrame" height="400px" width="800px" frameborder="0" src="about:blank"></iframe>
        </c:Popup>
        <script>
          qesolines_isloading = false;
          function showAuthAndPaymentPopup() {
             jQuery("#authAndPaymentFrame").attr("src", "/apex/sopayment?id=" + sohdrId);
             _showDialog('authAndPaymentPopup',900);
          }
          function authAndPayment_saveAndClose() {
            var frame = jQuery("#authAndPaymentFrame");
            if (frame.length > 0) {
              var w = frame[0].contentWindow;
              try {
                w.commit(function() { _closeDialog(); doView(); });
              } catch (e) {
                console.log(e.stack);
                alert("{!$Label.rstk__error_closing_payment_window}"+e);
              }
            }
          }
        </script>
            
            <apex:pageBlockSection id="pbs_lineitems" showHeader="true" columns="1" title="{!$Label.rstk__pagetab_salesorder_lineitems}" collapsible="false" rendered="{!!isStandaloneHeader}">
            <apex:pageBlockSectionItem >
            <apex:outputpanel >
                <table style="width:100%;">
                    <tr style="width:100%;">
                    <td style="width:40%;">
                    <apex:outputPanel rendered="{!!readOnlyUser}">
                        <input type="button" class="btn" name="addButton" value="{!$Label.salesorder_pagebtn_Add}" onclick="return insertLine(false);" style="width:75px;"/>
                        <input name="showSearchProductsBtn" type="button" class="btn" onclick="return showSearchProductsDialog();" value="{!$Label.salesorder_pagebtn_CustomerProductLookup}"/>
                        <input type="button" class="btn" name="removeButton" value="{!$Label.salesorder_pagebtn_Remove}" onclick="return removeLines();" style="width:75px;"/>
                        <apex:outputpanel id="newProductPanel" rendered="{!pageOptions.addNewProductEnabled}">
                            <input type="button" class="btn" value="{!$Label.salesorder_pagebtn_CreateNewProduct}" onclick="return openCreateProduct();" style="width:125px;"/>
                        </apex:outputpanel>
                     <apex:outputpanel id="productConfigurator" rendered="{!pageOptions.congigSOE}">
                            <input type="button" class="btn" value="{!$Label.saleorder_pagebtn_ProductConfigurator}" onclick="return openProductConfigurator();" style="width:125px;"/>
                        </apex:outputpanel>
                       <apex:outputpanel rendered="{!geoStatus.taxLookup}">
                        <input type="button" class="btn"  value="{!$Label.saleorder_pagebtn_CalculateTax}" onclick="return updateAllTaxLines();" style="width:100px;"/>
                        </apex:outputpanel>
                     </apex:outputPanel>
                    </td>
                    <td style="width:30%;font-size:1.5em;">
                        <apex:outputLabel value="{!$Label.rstk__orderlinestotal}: "/>
                        <span name="SOtotal">{!o.rstk__sohdr_ordertotal__c}</span>
                    </td>
                    <td style="width:30%;font-size:1.5em;">
                        <apex:outputLabel value="{!$Label.rstk__pretaxtotal}: "/>
                        <span name="PretaxTotal"></span>
                    </td>
                    </tr>
                </table>
                </apex:outputpanel>
            </apex:pageBlockSectionItem>
                <apex:pageBlockTable id="pbt_lineitems" onclick="rowclicked()" value="{!lineItems}" var="d" style="display:none;" html-linesRemaining="{!LinesRemaining}">
                    <apex:column headerValue="" style="width:25px;" title="{!f_sl.rstk__soline_temp_select__c.inlineHelpText}">
                        <apex:facet name="header">
                           <a href="#" onclick="selectDeselectAll(); return false;">{!f_sl.rstk__soline_temp_select__c.label}</a> 
                        </apex:facet>
                        <apex:inputField id="soline_temp_select__c" value="{!d.rstk__soline_temp_select__c}" style="width:35px" />
                        <apex:outputPanel id="soline_errormessage__c" rendered="{!d.rstk__soline_errormessage__c != null}"><c:errorimage title="{!d.rstk__soline_errormessage__c}"/>&nbsp;&nbsp;</apex:outputPanel>
                    </apex:column>
                    <apex:column id="h_soline_line__c" headerValue="{!f_sl.rstk__soline_line__c.label}" style="width:25px;white-space:nowrap;" title="{!f_sl.rstk__soline_line__c.inlineHelpText}" rendered="{!o.Id != null}">
                        <span id="line_number__c">{!Round(d.rstk__soline_line__c, 0)}</span>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_prodtype__c.label}" title="{!f_sl.rstk__soline_prodtype__c.inlineHelpText}" rendered="{!d.id == null}">
                        <apex:selectlist size="1" id="soline_prodtype__c" value="{!d.rstk__soline_prodtype__c}" style="width:110px">
                            <apex:selectOptions value="{!soLineProdTypes}"/>
                        </apex:selectlist>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_prodtype__c.label}" title="{!f_sl.rstk__soline_prodtype__c.inlineHelpText}" rendered="{!d.id != null}">
                        <apex:outputField id="dsp_soline_prodtype__c" value="{!d.rstk__soline_prodtype__c}" style="width:110px"/>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_prod__c.label}" title="{!f_sl.rstk__soline_prod__c.inlineHelpText}" rendered="{!d.id == null}">
                        <apex:inputText id="soline_prod__c" value="{!d.rstk__soline_prod__c}" style="display:none"/>
                        <apex:inputText id="soline_textproduct__c" styleClass="ac_input" style="width:250px;"/>
                        <script>
                          var acId    = document.getElementById('{!$Component.soline_prod__c}');
                          var acInput = jQuery(acId).closest('tr').find('input.ac_input');
                          setupAutocompleteFieldData(acInput[0],acId, []);
                          acInput.val(editingProductNames[acId.value]);
                         </script>
                        <a name='invinfo' href="#" onclick="showInventoryItemPopup(); return false;" title="{!$Label.SalesOrder_Click_to_modify_the_product_s_Inventory_Item}">
                          <img height="8" width="8" src="/img/msg_icons/info16.png"/>
                        </a>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_prod__c.label}" title="{!f_sl.rstk__soline_prod__c.inlineHelpText}" rendered="{!d.id != null}">
                        <apex:outputpanel rendered="{!AND(geoStatus.taxLookup, d.soline_prod__r.rstk__soprod_avataxcodefrm__c == null)}">
                        <c:errorimage title="{!$Label.rstk__withavataxactive_theproductgroupavalaraproducttaxcodemustbespecified}"/>&nbsp;&nbsp;</apex:outputpanel>
                        <apex:outputField id="dsp_soline_prod__c" value="{!d.rstk__soline_prod__c}" style="width:250px;word-wrap: break-word;"/>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_invrev__c.label}" title="{!f_sl.rstk__soline_invrev__c.inlineHelpText}" value="{!d.rstk__soline_invrev__c}" rendered="{!pageOptions.showInvRevision}"/>
                    <apex:column headerValue="{!f_sl.rstk__soline_qtyorder__c.label}" title="{!f_sl.rstk__soline_qtyorder__c.inlineHelpText}">
                         <apex:inputField id="soline_qtyorder__c" value="{!d.rstk__soline_qtyorder__c}" onfocus="orderQtyFocused(this, '{!d.id}');" style="width:75px" styleClass="rl-rightalign" />
                        <apex:outputPanel rendered="{!d.Id != null}">
                        <script>
                            document.getElementById('{!$Component.soline_qtyorder__c}').disabled = {!d.rstk__soline_closed__c};
                            removeTrailingZeros["soline_qtyorder__c"] = false;
                        </script>
                        </apex:outputPanel>
                        <a name='lineinfo' href="#" onclick="showQtyOHPopup(); return false;" title='{!$Label.Click_to_see_the_quantity_currently_available_for_the_product}'>
                          <img height="8" width="8" src="/img/msg_icons/info16.png"/>
                        </a>
                    </apex:column>      
                    <apex:column headerValue="{!f_sl.rstk__soline_price__c.label}" title="{!f_sl.rstk__soline_price__c.inlineHelpText}">
                        <apex:inputField id="soline_price__c" value="{!d.rstk__soline_price__c}" style="width:85px" styleClass="rl-rightalign" />
                        <apex:outputPanel rendered="{!d.Id != null}">
                        <script>
                            document.getElementById('{!$Component.soline_price__c}').disabled = {!d.rstk__soline_closed__c};
                            removeTrailingZeros["soline_price__c"] = false;
                        </script>
                        </apex:outputPanel>
                        <a name='sourceInfo' href="#" onclick="showSourcePopup(); return false;" title='{!$Label.Click_to_see_the_source_of_the_initial_price}'>
                          <img height="8" width="8" src="/img/msg_icons/info16.png"/>
                        </a>
                    </apex:column>          
                    <apex:column headerValue="{!f_sl.rstk__soline_discpct__c.label}" style="width:50px" title="{!f_sl.rstk__soline_discpct__c.inlineHelpText}">
                        <apex:inputField id="soline_discpct__c" value="{!d.rstk__soline_discpct__c}" style="width:50px" styleClass="rl-rightalign" />
                        <apex:outputPanel rendered="{!d.Id != null}">
                        <script>
                            document.getElementById('{!$Component.soline_discpct__c}').disabled = {!d.rstk__soline_closed__c};
                            removeTrailingZeros["soline_discpct__c"] = false;
                        </script>
                        </apex:outputPanel>
                    </apex:column>
                    <apex:column headerValue="{!$Label.rstk__extended}" style="width:50px" title="{!$Label.rstk__theextendedamount_thepricelessthediscounttimestheorderquantity}">
                        <input type="text" name="soline_extendedamount" value="" style="width:85px" class="rl-rightalign" disabled="true"/>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_duedate__c.label}" title="{!f_sl.rstk__soline_duedate__c.inlineHelpText}">
                        <c:inputDateNoLink > 
                        <apex:inputField id="soline_duedate__c" value="{!d.rstk__soline_duedate__c}" style="width:75px" />
                        <apex:outputPanel rendered="{!d.Id != null}">
                        <script>document.getElementById('{!$Component.soline_duedate__c}').disabled = {!d.rstk__soline_closed__c};</script>
                        </apex:outputPanel>
                        </c:inputDateNoLink>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_shipdiv__c.label}" title="{!f_sl.rstk__soline_shipdiv__c.inlineHelpText}">
                        <apex:selectlist id="soline_shipdiv__c" value="{!d.rstk__soline_shipdiv__c}" size="1" style="width:100px">
                            <apex:selectOptions value="{!divisions}"/>
                        </apex:selectlist>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_project__c.label}" title="{!f_sl.rstk__soline_project__c.inlineHelpText}">
                        <apex:inputHidden id="soline_project__c" value="{!d.rstk__soline_project__c}"/>
                        <apex:inputText id="soline_textproject__c" styleClass="ac_input" style="width:200px"/>
                        <script>
                            var acId    = document.getElementById('{!$Component.soline_project__c}');
                            var acInput = jQuery(document.getElementById('{!$Component.soline_textproject__c}'));
                            setupAutocompleteFieldData(acInput[0],acId, []);
                            acInput.val(editingProjectNames[acId.value]);
                        </script>
                    </apex:column>
                    <apex:column headerValue="{!f_sl.rstk__soline_uom__c.label}" title="{!f_sl.rstk__soline_uom__c.inlineHelpText}">
                        <apex:selectlist size="1" id="soline_uom__c" value="{!d.rstk__soline_uom__c}" style="width:75px">
                            <apex:selectOptions value="{!UOMs}"/>
                        </apex:selectlist>
                        <script>
                            document.getElementById('{!$Component.soline_uom__c}').disabled = {!d.id != null };
                        </script>
                    </apex:column>      
                    <apex:column headerValue="{!f_sl.rstk__soline_firm__c.label}" title="{!f_sl.rstk__soline_firm__c.inlineHelpText}" rendered="{!!isQuote}">
                        <apex:inputField id="soline_firm__c" value="{!d.rstk__soline_firm__c}" style="width:35px" />
                        <apex:outputField id="soline_linestatustext__c" value="{!d.rstk__soline_linestatustext__c}" />
                        <apex:outputPanel rendered="{!d.rstk__soline_cancelled__c}"> / {!$Label.rstk__cancelled}</apex:outputPanel>
                        <apex:outputPanel rendered="{!d.Id != null}">
                        <script>document.getElementById('{!$Component.soline_firm__c}').disabled = {!isQuote || d.rstk__soline_closed__c || d.rstk__soline_qtyalloc__c > 0 || d.rstk__soline_qtyissue__c > 0};</script>
                        </apex:outputPanel>
                    </apex:column>
                    <apex:column style="width:160px">
                        <button id="lineDetailBtn" type="button" onClick="showLineDetails(this);">{!$Label.saleorder_pagebtn_Additional}</button>
                        <apex:outputPanel rendered="{!d.Id != null}">
                            <button id="componentsBtn" type="button" onclick="return showComponents('{!d.id}');">{!$Label.saleorder_pagebtn_Components}</button>
                            <br/>
                            <a id="notesBtn{!d.id}" href="#" onclick="return showNotesAndAttachments('{!d.id}');"
                             style="font-weight:bold;">{!$Label.Sales_Order_Notes_and_Attachments}</a>
                        </apex:outputPanel>
                        <apex:outputPanel html-nonumberformat="true" style="display:none">
                            <apex:inputHidden id="soline_removeind__c" value="{!d.rstk__soline_removeind__c}" />
                            <apex:inputHidden id="soline_line__c" value="{!d.rstk__soline_line__c}" />
                            <apex:inputHidden id="soline_product__c" value="{!d.rstk__soline_prod__c}" rendered="{!d.id != null}" />
                            <apex:inputHidden id="soline_producttype__c" value="{!d.rstk__soline_prodtype__c}" rendered="{!d.id != null}" />
                            <apex:inputHidden id="soline_shiptomethod__c" value="{!d.rstk__soline_shiptomethod__c}" />
                            <apex:inputHidden id="soline_shiptoaddr__c" value="{!d.rstk__soline_shiptoaddr__c}" />
                            <apex:inputHidden id="soline_fterms__c" value="{!d.rstk__soline_fterms__c}" />
                            <apex:inputHidden id="soline_carrier__c" value="{!d.rstk__soline_carrier__c}" />
                            <apex:inputHidden id="soline_shiptoaltline__c" value="{!d.rstk__soline_shiptoaltline__c}" />
                            <apex:inputHidden id="soline_shipvia__c" value="{!d.rstk__soline_shipvia__c}" />
                            <apex:inputHidden id="soline_fob__c" value="{!d.rstk__soline_fob__c}" />
                            <apex:inputHidden id="soline_freightamt__c" value="{!d.rstk__soline_freightamt__c}" />
                            <apex:inputHidden id="soline_packageamt__c" value="{!d.rstk__soline_packageamt__c}" />
                            <apex:inputHidden id="soline_handlingamt__c" value="{!d.rstk__soline_handlingamt__c}" />
                            <apex:inputHidden id="soline_taxexempt__c" value="{!d.rstk__soline_taxexempt__c}" />
                            <apex:inputHidden id="soline_taxoverride__c" value="{!d.rstk__soline_taxoverride__c}" />
                            <apex:inputHidden id="soline_taxamount__c" value="{!d.rstk__soline_taxamount__c}" />
                            <apex:inputHidden id="soline_salesacct__c" value="{!d.rstk__soline_salesacct__c}" />
                            <apex:inputHidden id="soline_cospendacct__c" value="{!d.rstk__soline_cospendacct__c}" />
                            <apex:inputHidden id="soline_cosacct__c" value="{!d.rstk__soline_cosacct__c}" />
                            <apex:inputHidden id="soline_cospendamt__c" value="{!d.rstk__soline_cospendamt__c}" />
                            <apex:inputHidden id="soline_cosamt__c" value="{!d.rstk__soline_cosamt__c}" />
                            <apex:inputHidden id="soline_sysprice__c" value="{!d.rstk__soline_sysprice__c}" />
                            <apex:inputHidden id="soline_pricesrce__c" value="{!d.rstk__soline_pricesrce__c}" />
                            <apex:inputHidden id="soline_pricebook__c" value="{!d.rstk__soline_pricebook__c}" />
                            <apex:inputHidden id="soline_uomcf__c" value="{!d.rstk__soline_uomcf__c}" />
                            <apex:inputHidden id="soline_agreement__c" value="{!d.rstk__soline_agreement__c}" />
                            <apex:inputField id="soline_schdate__c" value="{!d.rstk__soline_schdate__c}" />
                            <apex:inputHidden id="soline_resp__c" value="{!d.rstk__soline_resp__c}" />
                            <apex:inputHidden id="soline_qtyissue__c" value="{!d.rstk__soline_qtyissue__c}" />
                            <apex:inputHidden id="soline_qtypackage__c" value="{!d.rstk__soline_qtypackage__c}" />
                            <apex:inputHidden id="soline_discamt__c" value="{!d.rstk__soline_discamt__c}" />
                            <apex:inputHidden id="soline_qtyship__c" value="{!d.rstk__soline_qtyship__c}" />
                            <apex:inputHidden id="soline_qtyalloc__c" value="{!d.rstk__soline_qtyalloc__c}" />
                            <apex:inputHidden id="soline_baseprice__c" value="{!d.rstk__soline_baseprice__c}" />
                            <apex:inputHidden id="soline_pricecalcbase__c" value="{!d.rstk__soline_pricecalcbase__c}" />
                            <apex:inputHidden id="soline_pricecalcdisc__c" value="{!d.rstk__soline_pricecalcdisc__c}" />
                            <apex:inputHidden id="soline_dfltdiscsrce__c" value="{!d.rstk__soline_dfltdiscsrce__c}" />
                            <apex:inputHidden id="soline_dfltdiscpct__c" value="{!d.rstk__soline_dfltdiscpct__c}" />
                            <apex:inputField id="soline_reqdate__c" value="{!d.rstk__soline_reqdate__c}" />
                            <apex:inputHidden id="soline_origqtyord__c" value="{!d.rstk__soline_origqtyord__c}" />
                            <apex:inputHidden id="soline_shipsite__c" value="{!d.rstk__soline_shipsite__c}" />
                            <apex:inputHidden id="soline_shiplocid__c" value="{!d.rstk__soline_shiplocid__c}" />
                            <apex:inputHidden id="soline_shiplocnum__c" value="{!d.rstk__soline_shiplocnum__c}" />
                            <apex:inputHidden id="soline_useconfig__c" value="{!d.rstk__soline_useconfig__c}" />
                            <apex:inputHidden id="soline_usestock__c" value="{!d.rstk__soline_usestock__c}" />
                            <apex:inputHidden id="soline_wocstordno__c" value="{!d.rstk__soline_wocstordno__c}" />
                            <apex:inputHidden id="soline_wocstordnodesc__c" value="{!d.soline_wocstordno__r.rstk__wocst_ordno__c}" />
                            
                            <apex:inputHidden id="soline_intcomment__c" value="{!d.rstk__soline_intcomment__c}" />
                            <apex:inputHidden id="soline_extcomment__c" value="{!d.rstk__soline_extcomment__c}" />
                            <apex:inputHidden id="soline_allshipped__c" value="{!d.rstk__soline_allshipped__c}" />
                            <apex:inputHidden id="soline_allissued__c" value="{!d.rstk__soline_allissued__c}" />
                            <apex:inputHidden id="soline_oshiptoaddr__c" value="{!d.rstk__soline_oshiptoaddr__c}" rendered="{!!ISNULL(d.rstk__soline_oshiptoaddr__c)}"/>
                            <apex:inputField id="soline_custrequestdate__c" value="{!d.rstk__soline_custrequestdate__c}" style="display:none"/>
                            <apex:outputText id="sydiv_multisiteind__c" value="{!d.soline_shipdiv__r.rstk__sydiv_multisiteind__c}" />
                            <apex:outputText id="s_soprod_multshipdiv__c" value="{!d.soline_prod__r.rstk__soprod_multshipdiv__c}" />
                            <apex:outputText id="s_soprod_icitem__c" value="{!d.soline_prod__r.rstk__soprod_icitem__c}" />

                            <apex:outputText id="sycmp_numdims__c"   value="{!d.soline_shipdiv__r.sydiv_cmpno__r.rstk__sycmp_numdims__c}" />
                            <apex:outputText id="sycmp_nodims__c"   value="{!d.soline_shipdiv__r.sydiv_cmpno__r.rstk__sycmp_nodims__c}" />
                            <apex:inputHidden id="dimvals_dimval1__c" value="{!d.soline_dimvals__r.rstk__dimval1__c}" />
                            <apex:inputHidden id="dimvals_dimval2__c" value="{!d.soline_dimvals__r.rstk__dimval2__c}" />
                            <apex:inputHidden id="dimvals_dimval3__c" value="{!d.soline_dimvals__r.rstk__dimval3__c}" />
                            <apex:inputHidden id="dimvals_dimval4__c" value="{!d.soline_dimvals__r.rstk__dimval4__c}" />
                            <apex:inputHidden id="dimvals_dimval5__c" value="{!d.soline_dimvals__r.rstk__dimval5__c}" />
                            <apex:inputHidden id="dimvals_dimval6__c" value="{!d.soline_dimvals__r.rstk__dimval6__c}" />
                            <apex:inputHidden id="dimvals_dimval7__c" value="{!d.soline_dimvals__r.rstk__dimval7__c}" />
                            <apex:inputHidden id="dimvals_dimval8__c" value="{!d.soline_dimvals__r.rstk__dimval8__c}" />
                            <apex:outputText id="line_number_id__c" value="{!d.id}" />
                            <apex:inputHidden id="soline_hold__c" value="{!d.rstk__soline_hold__c}" />
                            <apex:outputText id="soline_initiallyfirm__c" value="{!d.rstk__soline_firm__c}"/>
                            <apex:outputText id="solineinit_shipdiv__c" value="{!d.rstk__soline_shipdiv__c}"/>
                            <apex:inputHidden id="soline_configlabor__c" value="{!d.rstk__soline_configlabor__c}" />
                            <apex:inputHidden id="soline_useactuals__c" value="{!d.rstk__soline_useactuals__c}" />
                            <apex:inputHidden id="soline_itemizemtl__c" value="{!d.rstk__soline_itemizemtl__c}" />
                            <apex:inputHidden id="soline_itemizelab__c" value="{!d.rstk__soline_itemizelab__c}" />
                            <apex:inputHidden id="soline_mtlmarkuppct__c" value="{!d.rstk__soline_mtlmarkuppct__c}" />
                            <apex:inputHidden id="soline_labmarkuppct__c" value="{!d.rstk__soline_labmarkuppct__c}" />
                            <apex:inputHidden id="soline_labprice__c" value="{!d.rstk__soline_labprice__c}" />
                            <apex:inputHidden id="soline_pricemethmtl__c" value="{!d.rstk__soline_pricemethmtl__c}" />
                            <apex:inputHidden id="soline_pricemethlab__c" value="{!d.rstk__soline_pricemethlab__c}" />
                            <apex:inputHidden id="soline_ovrtaxrate__c" value="{!d.rstk__soline_ovrtaxrate__c}" />
                            <apex:inputHidden id="soline_ovrtax__c" value="{!d.rstk__soline_ovrtax__c}" />
                            <apex:inputHidden id="soline_ovrshippingtax__c" value="{!d.rstk__soline_ovrshippingtax__c}" />
                            <apex:inputHidden id="soline_verifiedtaxind__c" value="{!d.rstk__soline_verifiedtaxind__c}" />
                            <apex:inputHidden id="soline_recalculateprice__c" value="{!d.rstk__soline_recalculateprice__c}" />
                            <apex:inputHidden id="soline_ignorerollup__c" value="{!d.rstk__soline_ignorerollup__c}" />
                            <apex:outputText id="soline_origignorerollup__c" value="{!d.rstk__soline_ignorerollup__c}" />
                            <apex:outputText id="originalLinePrice__c" value="{!d.rstk__soline_price__c}" />
                            <apex:outputText id="taxcode__c" value="{!d.soline_prod__r.rstk__soprod_avataxcodefrm__c}" />
                            <apex:outputText id="proddesc__c" value="{!d.soline_prod__r.rstk__soprod_descr__c}" />
                            <apex:outputText id="prodcode__c" value="{!d.soline_prod__r.rstk__soprod_prod__c}" />
                            <apex:outputText id="isserial__c" value="{!d.soline_prod__r.soprod_icitem__r.icitem_item__r.rstk__peitem_tracksrl_pl__c}" />
                            <apex:inputHidden id="soline_weight__c" value="{!d.rstk__soline_weight__c}" />
                            <apex:inputHidden id="soline_height__c" value="{!d.rstk__soline_height__c}" />
                            <apex:inputHidden id="soline_width__c" value="{!d.rstk__soline_width__c}" />
                            <apex:inputHidden id="soline_length__c" value="{!d.rstk__soline_length__c}" />
                            <apex:inputHidden id="soline_estind__c" value="{!d.rstk__soline_estind__c}" />
                            <apex:inputHidden id="soline_altprice1__c" value="{!d.rstk__soline_altprice1__c}" />
                            <apex:inputHidden id="soline_altprice2__c" value="{!d.rstk__soline_altprice2__c}" />
                            <apex:inputField id="triggerdate__c" value="{!d.rstk__triggerdate__c}" />
                            <apex:inputText id="triggercount__c" value="{!d.rstk__triggercount__c}" />
                            <apex:inputField id="soline_savestate__c" value="{!d.rstk__soline_savestate__c}" />
                            <apex:inputField id="soline_intersystem__c" value="{!d.rstk__soline_intersystem__c}" />
                            <apex:inputField id="soline_intracompany__c" value="{!d.rstk__soline_intracompany__c}" />
                            <apex:inputHidden id="soline_case__c" value="{!d.rstk__soline_case__c}" />
                            <apex:inputHidden id="soline_installaddr__c" value="{!d.rstk__soline_installaddr__c}" />
                            <apex:outputText id="soline_pricecc__c" value="{!d.rstk__soline_pricecc__c}"/>
                            <apex:inputText id="soline_ustat__c" value="{!d.rstk__soline_ustat__c}"/>
                            <apex:inputText id="soline_confsess__c" value="{!d.rstk__soline_confsess__c}"/>
                            <apex:inputText id="soline_socontract__c" value="{!d.rstk__soline_socontract__c}"/>
                            <apex:inputHidden id="soline_bypasssupersession__c" value="{!d.rstk__soline_bypasssupersession__c}"/>
                           <apex:inputText id="soline_orgid__c" value="{!d.rstk__soline_orgid__c}"/>
                            <apex:inputHidden id="soline_nopartials__c" value="{!d.rstk__soline_nopartials__c}"/>
                            <apex:inputHidden id="soline_nopartialset__c" value="{!d.rstk__soline_nopartialset__c}"/>
                            <apex:inputHidden id="soline_shipsetid__c" value="{!d.rstk__soline_shipsetid__c}"/>
                            <apex:inputText id="soline_extweight__c" value="{!d.rstk__soline_extweight__c}"/>
                            <apex:inputText id="soline_covereditem__c" value="{!d.rstk__soline_covereditem__c}"/>
                            <apex:outputText id="static_soline_freightcost__c" value="{!d.rstk__soline_freightcost__c}" />
                            <apex:outputText id="static_soline_qtypickpackship__c" value="{!d.rstk__soline_qtypickpackship__c}" />
                            <apex:inputHidden id="soline_linecredit__c" value="{!d.rstk__soline_linecredit__c}"/>
                            <apex:inputHidden id="soline_povend__c" value="{!d.rstk__soline_povend__c}"/>
                            <apex:inputHidden id="soline_icitem__c" value="{!d.rstk__soline_icitem__c}"/>
                            <apex:inputHidden id="soline_sozone__c" value="{!d.rstk__soline_sozone__c}"/>
                            <apex:outputText id="initial_soline_shiptoaddr__c" value="{!d.rstk__soline_shiptoaddr__c}"/>
                            <apex:outputText id="initial_soline_installaddr__c" value="{!d.rstk__soline_installaddr__c}"/>
                            <apex:inputHidden id="soline_nopickifnorcpt__c" value="{!d.rstk__soline_nopickifnorcpt__c}"/>
                            <apex:inputHidden id="soline_nopickifnoalloc__c" value="{!d.rstk__soline_nopickifnoalloc__c}"/>
                            <apex:inputText id="soline_wbs__c" value="{!d.rstk__soline_wbs__c}"/>
                            <apex:inputHidden id="soline_wotype__c" value="{!d.rstk__soline_wotype__c}"/>
                            <apex:inputText id="soline_syvatclass__c" value="{! d.soline_syvatclass__c}"/>
                        </apex:outputPanel>
                    </apex:column>      
                </apex:pageBlockTable>
            <apex:pageBlockSectionItem >
            <apex:outputpanel >
                <table style="width:100%;">
                    <tr style="width:100%;">
                    <td style="width:40%;">
                    <input type="button" class="btn" name="addButton" value="{!$Label.salesorder_pagebtn_Add}" onclick="return insertLine(false);" style="width:75px;"/>
                    <input name="showSearchProductsBtn" type="button" class="btn" onclick="return showSearchProductsDialog();" value="{!$Label.salesorder_pagebtn_CustomerProductLookup}"/>
                    <input type="button" class="btn" name="removeButton" value="{!$Label.salesorder_pagebtn_Remove}" onclick="return removeLines();" style="width:75px;"/>
                    <apex:outputpanel id="newProductPanel2" rendered="{!pageOptions.addNewProductEnabled}">
                        <input type="button" class="btn" value="{!$Label.salesorder_pagebtn_CreateNewProduct}" onclick="return openCreateProduct();" style="width:125px;"/>
                    </apex:outputpanel>
                    </td>
                    <td style="width:30%;font-size:1.5em;">
                        <apex:outputLabel value="{!$Label.rstk__orderlinestotal}:"/>
                        <span name="SOtotal">{!o.rstk__sohdr_ordertotal__c}</span>
                    </td>
                    <td style="width:30%;font-size:1.5em;">
                        <apex:outputLabel value="{!$Label.rstk__pretaxtotal}: "/>
                        <span name="PretaxTotal"></span>
                    </td>
                    </tr>
                </table>
            </apex:outputpanel>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
                    
            <c:GeoDialogs validationObj="validateAddr"/>
             
             <div id="pleaseWaitPopup" style="display:none">
                 <apex:outputPanel styleClass="topPopupBackground" layout="block"/>
                 <apex:outputPanel styleClass="topPopup">
                    <apex:image url="{!$Resource.rstk__busy}"/>
                 </apex:outputPanel>
             </div>

            <c:Popup popupId="changeCustomerErrorPopup" title="{!$Label.rstk__pagepopup_salesorder_changecustomer}">
              <textarea id="customerErrorText" style="width:95%;font-weight:bold;" rows="8" readonly="readonly">X</textarea>
            </c:Popup>

            <c:Popup popupId="changeCustomerPopup" title="{!$Label.rstk__pagepopup_salesorder_changecustomer}" onOk="_closeDialog(); doChangeCustomer();" okCaption="Save">
            <apex:pageBlockSection columns="1">
              <apex:pageBlockSectionItem helpText="{!$Label.rstk__the_customer_currently_associated_with_this_order}">
                    <apex:outputLabel value="{!$Label.rstk__currentcustomer}"/>
                        <a id="currentCustomer" href="#"></a>
              </apex:pageBlockSectionItem>
              <apex:pageBlockSectionItem helpText="{!$Label.rstk__the_new_customer_to_be_associated_with_this_order}">
                    <apex:outputLabel value="{!$Label.rstk__newcustomer}"/>
                    <apex:outputPanel >
                    <input class="ac_input" id="newCustomer_autocomplete" name="newCustomer_autocomplete" style="width:250px" value="" autocomplete="off"/>
                    <input id="newCustomer" name="newCustomer" style="display:none" value=""/>
                    <script>autocompleteParms["newCustomer"] = {query:"select id, name from socust__c where socust_inactive__c = false",
                                    queryParms:[], codeColumn:"id", descColumn:"name", displayColumn:"name", minChars:{!CustMinCharForAutoComplete}, secondarySearchColumn:""};
                    </script>
                    </apex:outputPanel>
              </apex:pageBlockSectionItem>
              <apex:pageBlockSectionItem helpText="{!$Label.rstk__update_cust_defaults_on_the_sales_order_to_the_values_derived_from_the_new_cust}">
                    <input type="checkbox" id="updateCustomerDefaults"/>
                    <apex:outputLabel value="{!$Label.rstk__updatecustomerdefaultsonthesalesorder}"/>
              </apex:pageBlockSectionItem>
              <apex:pageBlockSectionItem />
              <apex:pageBlockSectionItem >
                    <apex:image value="/img/msg_icons/warning16.png"/>
                    <apex:outputLabel value="{!$Label.rstk__warninganyunsaveddatawillbelostwhenthecustomerischanged}"/>
              </apex:pageBlockSectionItem>
            </apex:pageBlockSection>
            </c:Popup>

     <c:Popup popupId="globalLineUpdatePopup" title="{!$Label.rstk__pagepopup_salesorder_globallineupdate}" onOk="if (doGlobalLineUpdate()) { _closeDialog(); }" buttonsOnTop="true" okCaption="{!$Label.rstk__salesorder_pagebtn_updateselectedlines}">

       <apex:pageBlockSection showHeader="true" title="{!$Label.rstk__pagetab_salesorder_miscellaneous}" columns="2" collapsible="false">
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_case__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_case__c.label}"/>
               <apex:selectlist id="globalLine_case" size="1" style="width:250px">
                   <apex:selectOptions value="{!cases}"/>
               </apex:selectlist>
          </apex:pageBlockSectionItem>
          <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_fob__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_fob__c.label}"/>
               <c:LocalSelect id="globalLine_fob__c" width="250px"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_carrier__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_carrier__c.label}"/>
                <c:LocalSelect id="globalLine_carrier__c" width="250px"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_fterms__c.inlineHelpText}">
                <apex:outputLabel value="{!f_sl.rstk__soline_fterms__c.label}"/>
                <c:LocalSelect id="globalLine_fterms__c" width="250px"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_shipvia__c.inlineHelpText}">
                <apex:outputLabel value="{!f_sl.rstk__soline_shipvia__c.label}"/>
                <c:LocalSelect id="globalLine_shipvia__c" width="250px"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_slextn.rstk__solineextn_sydivaddr__c.inlineHelpText}">
                <apex:outputLabel value="{!f_slextn.rstk__solineextn_sydivaddr__c.label}"/>
                <c:LocalSelect id="globalLine_sydivaddr__c"/>
             </apex:pageBlockSectionItem>
       </apex:pageBlockSection>

       <apex:pageBlockSection id="pbs_globalDimensions" showHeader="true" title="{!$Label.rstk__pagetab_salesorder_dimensionvalues}" columns="2" collapsible="false">
            <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval1__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval1__c.label}"/>
                   <select size="1" id="globalLine_dimval1" name="globalLine_dimval1" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval5__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval5__c.label}"/>
                    <select size="1" id="globalLine_dimval5" name="globalLine_dimval5" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval2__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval2__c.label}"/>
                    <select size="1" id="globalLine_dimval2" name="globalLine_dimval2" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval6__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval6__c.label}"/>
                    <select size="1" id="globalLine_dimval6" name="globalLine_dimval6" style="width:250px"/>
           </apex:pageBlockSectionItem>

           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval3__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval3__c.label}"/>
                    <select size="1" id="globalLine_dimval3" name="globalLine_dimval3" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval7__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval7__c.label}"/>
                    <select size="1" id="globalLine_dimval7" name="globalLine_dimval7" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval4__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval4__c.label}"/>
                    <select size="1" id="globalLine_dimval4" name="globalLine_dimval4" style="width:250px"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_dimvals.rstk__dimval8__c.inlineHelpText}">
                   <apex:outputLabel value="{!f_dimvals.rstk__dimval8__c.label}"/>
                    <select size="1" id="globalLine_dimval8" name="globalLine_dimval8" style="width:250px"/>
           </apex:pageBlockSectionItem>                        
       </apex:pageBlockSection>

     <apex:pageBlockSection showHeader="true" title="{!$Label.rstk__pagetab_salesorder_salesorderlines}" columns="1" collapsible="false">
           <apex:pageBlockSectionItem >
            <div id="globalLineUpdateMessage"/>
           </apex:pageBlockSectionItem>

            <apex:pageBlockTable var="d" value="{!serverLineItems}" columnsWidth="3%,3%,6%,17%,6%,6%,17%,10%,10%,10%,12%">
                <apex:column headerValue="">
                  <apex:facet name="header">
                     <a href="#" onclick="globalLines.selectAll(); return false;">Select</a> 
                  </apex:facet>
                  <input type="checkbox" class="globalLines-SELECTED"/>
                </apex:column>
                <apex:column headerValue="{!f_sl.rstk__soline_line__c.label}">
                   <apex:outputpanel styleclass="globalLines-soline_line__c">
                   <apex:outputField value="{!d.rstk__soline_line__c}"/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!f_sl.rstk__soline_prodtype__c.label}">
                   <apex:outputpanel styleclass="globalLines-soline_prodtype__c">
                   <apex:outputField value="{!d.rstk__soline_prodtype__c}"/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!f_sl.rstk__soline_prod__c.label}">
                   <apex:outputpanel styleclass="globalLines-soline_prod__c">
                   <apex:outputField value="{!d.rstk__soline_prod__c}"/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!f_sl.rstk__soline_qtyorder__c.label}">
                   <apex:outputpanel styleclass="globalLines-soline_qtyorder__c">
                   <apex:outputField value="{!d.rstk__soline_qtyorder__c}"/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!f_sl.rstk__soline_qtyissue__c.label}">
                   <apex:outputpanel styleclass="globalLines-soline_qtyissue__c">
                   <apex:outputField value="{!d.rstk__soline_qtyissue__c}"/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__case}">
                   <apex:outputpanel styleclass="globalLines-case__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval1}" rendered="{!numDims >= 1}">
                   <apex:outputpanel styleclass="globalLines-DimVal1__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval2}" rendered="{!numDims >= 2}">
                   <apex:outputpanel styleclass="globalLines-DimVal2__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval3}" rendered="{!numDims >= 3}">
                   <apex:outputpanel styleclass="globalLines-DimVal3__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval4}" rendered="{!numDims >= 4}">
                   <apex:outputpanel styleclass="globalLines-DimVal4__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval5}" rendered="{!numDims >= 5}">
                   <apex:outputpanel styleclass="globalLines-DimVal5__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval6}" rendered="{!numDims >= 6}">
                   <apex:outputpanel styleclass="globalLines-DimVal6__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval7}" rendered="{!numDims >= 7}">
                   <apex:outputpanel styleclass="globalLines-DimVal7__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
                <apex:column headerValue="{!$Label.rstk__dimval8}" rendered="{!numDims >= 8}">
                   <apex:outputpanel styleclass="globalLines-DimVal8__g">
                   <apex:outputText value=""/>
                   </apex:outputpanel>
                </apex:column>
            </apex:pageBlockTable>
        
        </apex:pageBlockSection>
        <script>
          var globalLines = new Object();
          globalLines.numRows={!serverLineItems.size};
          globalLines.getRowValue=function(rowIdx, colName) {
            var el = jQuery(".globalLines-"+colName+":eq("+rowIdx+")");
            if (el.length == 0) {
              return null;
            }
            var subA = el.find("a");
            if (subA.length > 0) {
              var onFocus = subA.attr('onfocus');
              if (onFocus != null) {
                var val = (''+onFocus).match(/\/(.*?)\//)
                if (val != null && val.length > 1) {
                    return val[1];
                }
              }
              el = subA;
            } else {
                var subSpan = el.find("span");
                if (subSpan.length > 0) {
                  el = subSpan;
                }
            }
            return el.text();
          }
          
          globalLines.setRowValue=function(rowIdx, colName, value) {
            var el = jQuery(".globalLines-"+colName+":eq("+rowIdx+")");
            if (el.length == 0) {
              return false;
            }
            var subA = el.find("a");
            if (subA.length > 0) {
              return false; // Can't update a link, the text would show ok but the link would go to the wrong location
            }
            var subSpan = el.find("span");
            if (subSpan.length > 0) {
              el = subSpan;
            }
            el.text(value);
            return true;
          }
          
        globalLines.selectAll = function() {
            var selectableRows = jQuery("input.globalLines-SELECTED");
            var selected = jQuery('input.globalLines-SELECTED:checked');
            var selectAll = (selected.length < selectableRows.length);
            
            selectableRows.each(function() {
                var chkBox = jQuery(this);
                if (chkBox.size() > 0)
                {
                    chkBox[0].checked = selectAll;
                }
            });
        }
        
        globalLines.selectRow = function(rowIdx, isSelected) {
            var chkBox = jQuery(".globalLines-SELECTED:eq("+rowIdx+")");
            if (chkBox.size() > 0) {
               chkBox[0].checked = isSelected;
            }
        }

        globalLines.isSelected = function(rowIdx) {
            var chkBox = jQuery(".globalLines-SELECTED:eq("+rowIdx+")");
            if (chkBox.size() > 0) {
               return chkBox[0].checked;
            }
            return false;
        }
                
        globalLines.getNumSelectedRows = function() {
            var selected = jQuery('input.globalLines-SELECTED:checked');
            return selected.length;
        }
          
        </script>

     </c:Popup>

     <c:Popup popupId="qtyOHPopup" title="{!$Label.rstk__pagepopup_salesorder_quantityavailable}" cancelCaption="{!$Label.rstk__sales_order_close}" buttonsOnTop="true">
       <apex:pageBlockSection showHeader="false" columns="1" collapsible="false">
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_icitem__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_icitem__c.label}"/>
               <div id="qty_soline_icitem__c" style="width:100%; font-weight:bold;text-align:left;"/>
           </apex:pageBlockSectionItem>
       </apex:pageBlockSection>
       <apex:pageBlockSection showHeader="false" columns="2" collapsible="false">
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyoh__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyoh__c.label}"/>
               <div id="icitemsiteproj_qtyoh__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_div__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_div__c.label}"/>
               <div id="icitemsiteproj_div__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyalloc__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyalloc__c.label}"/>
               <div id="icitemsiteproj_qtyalloc__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_proj__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_proj__c.label}"/>
               <div id="icitemsiteproj_proj__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyavail__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyavail__c.label}"/>
               <div id="icitemsiteproj_qtyavail__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_site__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_site__c.label}"/>
               <div id="icitemsiteproj_site__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
         </apex:pageBlockSection>
         <apex:pageBlockSection columns="1">
          <apex:pageBlockSectionItem >
           <table style="display:none" width="100%" class="list" id="icitemsiteprojs">
             <thead width="100%" class="rich-table-thead">
             <tr width="100%" class="headerRow">
                <th width="40%" class="headerRow" scope="col">{!f_icitemsiteproj.rstk__icitemsiteproj_site__c.label}</th>
                <th width="20%" class="headerRow" scope="col">{!f_icitemsiteproj.rstk__icitemsiteproj_qtyoh__c.label}</th>
                <th width="20%" class="headerRow" scope="col">{!f_icitemsiteproj.rstk__icitemsiteproj_qtyalloc__c.label}</th>
                <th width="20%" class="headerRow" scope="col">{!f_icitemsiteproj.rstk__icitemsiteproj_qtyavail__c.label}</th>
             </tr>
             </thead>
             <tbody id="icitemsiteprojsBody">
                
             </tbody>
           </table>
           </apex:pageBlockSectionItem>
         </apex:pageBlockSection>
     </c:Popup>

     <c:Popup popupId="sourcePopup" title="{!$Label.rstk__pagepopup_salesorder_pricesource}" cancelCaption="{!$Label.rstk__sales_order_close}">
       <apex:pageBlockSection showHeader="false" columns="2" collapsible="false">
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricecalcbase__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_pricecalcbase__c.label}"/>
               <div id="sp_soline_pricecalcbase__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricesrce__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_pricesrce__c.label}"/>
               <div id="sp_soline_pricesrce1__c" style="width:300px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricecalcdisc__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_pricecalcdisc__c.label}"/>
               <div id="sp_soline_pricecalcdisc__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_pricesrce__c.inlineHelpText}">
               <apex:outputLabel value="{!$Label.rstk__pricediscountsource}"/>
               <div id="sp_soline_pricesrce2__c" style="width:300px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_sysprice__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_sysprice__c.label}"/>
               <div id="sp_soline_sysprice__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem />

           <apex:pageBlockSectionItem helpText="{!$Label.rstk__the_standard_sale_price_for_the_product}">
               <apex:outputLabel value="{!$Label.rstk__productsaleprice}"/>
               <div id="sp_productprice__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem />
           
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_dfltdiscpct__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_dfltdiscpct__c.label}"/>
               <div id="sp_soline_dfltdiscpct__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_dfltdiscsrce__c.inlineHelpText}">
               <apex:outputLabel value="{!f_sl.rstk__soline_dfltdiscsrce__c.label}"/>
               <div id="sp_soline_dfltdiscsrce__c" style="width:300px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
         </apex:pageBlockSection>
         <apex:pageBlockSection id="PriceTrace" columns="1">
            Price Trace:<br/>
            <table id="priceTraceTable" class="list">
            <thead>
             <tr class="headerRow">
              <th class="headerRow"><div>{!$Label.salesOrder_Section}</div></th>
              <th class="headerRow"><div>{!$Label.salesOrder_Description}</div></th>
             </tr>
            </thead>
            <tbody Id='priceTraceBody'>
            </tbody>
            </table>
        </apex:pageBlockSection>
     </c:Popup>

     <c:Popup popupId="autoProjDimsPopup" title="{!$Label.rstk__pagepopup_salesorder_auto_projectdimensionvalues}" okCaption="{!$Label.rstk__salesorder_save}" onOk="saveProjDims();" onCancel="">
       <table class="list" id="autoProjDimsTable">
         <thead class="rich-table-thead">
         <tr class="headerRow">
            <th class="headerRow" scope="col">{!$Label.rstk__salesorder_line_number}</th>
            <th class="headerRow" scope="col">{!$Label.rstk__salesorder_product}</th>
            <th class="headerRow" scope="col">{!$Label.rstk__salesorder_dimension_values}</th>
         </tr>
         </thead>
         <tbody id="autoProjDimsTableBody">
            
         </tbody>
       </table>
     </c:Popup>

     <c:Popup popupId="createPackagesStatusPopup" title="{!$Label.rstk__pagepopup_createpackagestatus}" onOk="_closeDialog();" onCancel="">
       <table class="list" id="packageStatusTable">
         <thead class="rich-table-thead">
         <tr class="headerRow">
            <th width="20%" class="headerRow" scope="col">{!f_pkg.sopackage_soline__c.label}</th>
            <th width="50%" class="headerRow" scope="col">{!$Label.packagesCreated}</th>
            <th width="30%" class="headerRow" scope="col">{!$Label.pagepopup_salesordercomponents_Error}</th>
         </tr>
         </thead>
         <tbody id="packageStatusTableBody">
            
         </tbody>
       </table>
     </c:Popup>

     <c:Popup popupId="orderPackageDetailsPopup" title="{!$Label.rstk__pagepopup_orderpackagedetails}" onOk="_closeDialog();" onCancel="" buttonsOnTop="true">
       <table class="list" id="orderPackageDetailsTable">
         <thead class="rich-table-thead">
         <tr class="headerRow">
            <!-- th class="headerRow" scope="col"> </th  -->
            <th class="headerRow" scope="col">{!f_pkg.sopackage_soline__c.label}</th>
            <th class="headerRow" scope="col">{!f_sl.rstk__soline_prod__c.label}</th>
            <th class="headerRow" scope="col">{!f_pkg.sopackage_qty__c.label}</th>
            <th class="headerRow" scope="col">{!f_ctype.socontype_type__c.label}</th>
            <th class="headerRow" scope="col">{!f_pkg.sopackage_freightamt__c.label}</th>
         </tr>
         </thead>
         <tbody id="orderPackageDetailsBody">
            
         </tbody>
       </table>
     </c:Popup>

     </apex:pageBlock>

    <div id="invSelect" class="topFrame" style="display:none" rendered="{!prodConvertable}">
        <iframe class="topFrame" id="invSelectFrame" src="" width="100%" height="700px" seamless="true" frameborder="0" marginwidth="0" marginheight="0"></iframe>
    </div>

    <c:Popup popupId="createContractPopup" buttonsOnTop="true" title="{!$Label.rstk__pagepopup_salesorder_createcontract}" okCaption="{!$Label.rstk__salesorder_pagebtn_close}" onOk="contractPopupClosed();" onCancel="">
        <iframe id="createContractFrame" width="100%" height="600px" seamless="true" frameborder="0" marginwidth="0" marginheight="0" src="about:blank"></iframe>
    </c:Popup>

    <c:Popup popupId="changeProductPopup" title="{!$Label.rstk__pagepopup_salesorder_changeproduct}">
    <apex:pageBlockSection columns="1">
      <apex:pageBlockSectionItem helpText="{!f.rstk__sohdr_order__c.inlineHelpText}">
            <apex:outputLabel value="{!f.rstk__sohdr_order__c.label}"/>
            <apex:outputField value="{!o.rstk__sohdr_order__c}"/>
      </apex:pageBlockSectionItem>
      <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_line__c.inlineHelpText}">
          <apex:outputLabel value="{!f_sl.rstk__soline_line__c.label}"/>
          <span id="g_soline_line__c"></span>
      </apex:pageBlockSectionItem>
      <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_prod__c.inlineHelpText}">
          <apex:outputLabel value="{!f_sl.rstk__soline_prod__c.label}"/>
          <span id="g_soline_prod__c"></span>
      </apex:pageBlockSectionItem>
      <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_qtyorder__c.inlineHelpText}">
          <apex:outputLabel value="{!f_sl.rstk__soline_qtyorder__c.label}"/>
          <span id="g_soline_qtyorder__c"></span>
      </apex:pageBlockSectionItem>
      <apex:pageBlockSectionItem helpText="{!$Label.rstk__convert_generic_product_to_individual_plates}">
          <input type="checkbox" id="g_soline_prodconvert__c"/>
          <apex:outputLabel value="{!$Label.rstk__convertgenericproducttoindividualplates}"/>
      </apex:pageBlockSectionItem>
      <apex:pageBlockSectionItem helpText="{!$Label.rstk__convert_generic_product_to_individual_plates}">
          <input type="button" class="btn" value="{!$Label.salesorder_pagebtn_SelectNewProducts}" onclick="return openInvSelect();"/>
      </apex:pageBlockSectionItem>
    </apex:pageBlockSection>
    </c:Popup>

    <!--  c:Popup popupId="realTimePricingPopup" title="{!$Label.pagepopup_salesorder_RealTimePricing}"  onOk="saveRealTimePricing();" >
    <apex:pageBlockSection columns="1">
      <table class="list" width="100%">
        <tr class="headerRow" width="100%">
          <th>PM Weight</th>
          <th>* (</th>
          <th>Spot</th>
          <th>Operator</th>
          <th>Premium 1</th>
          <th>) +</th>
          <th>Premium 2</th>
          <th>=</th>
          <th>Unit Price</th>
          <th>*</th>
          <th>Quantity</th>
          <th>=</th>
          <th>Extended Value</th>
        </tr>
        <tr class="dataRow" width="100%">
          <td class="dataCell"><span id="x_pmweight"/></td>
          <td class="dataCell">* (</td>
          <td class="dataCell"><input id="x_spot" onchange="realTimePricingUpdateExt();"/></td>
          <td class="dataCell"><span id="x_operator"/></td>
          <td class="dataCell"><input id="x_premium1" onchange="realTimePricingUpdateExt();"/></td>
          <td class="dataCell">) +</td>
          <td class="dataCell"><input id="x_premium2" onchange="realTimePricingUpdateExt();"/></td>
          <td class="dataCell">=</td>
          <td class="dataCell"><span id="x_unitPrice"/></td>
          <td class="dataCell">*</td>
          <td class="dataCell"><input id="x_quantity" onchange="realTimePricingUpdateExt();"/></td>
          <td class="dataCell">=</td>
          <td class="dataCell"><span id="x_extValue"/></td>
        </tr>
      </table>
    </apex:pageBlockSection>
    </c:Popup -->
    
    <c:Popup popupId="addressPopup" title="{!$Label.rstk__pagepopup_salesorder_address}" cancelCaption="{!$Label.rstk__sales_order_close}">
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address1__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address1__c.label}"/>
                <span id="addr_address1"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_name__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_name__c.label}"/>
                <span id="addr_name"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address2__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address2__c.label}"/>
                <span id="addr_address2"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_phone__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_phone__c.label}"/>
                <span id="addr_phone"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_address3__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_address3__c.label}"/>
                <span id="addr_address3"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_fax__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_fax__c.label}"/>
                <span id="addr_fax"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_city__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_city__c.label}"/>
                <span id="addr_city"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_email__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_email__c.label}"/>
                <span id="addr_email"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_state__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_state__c.label}"/>
                <span id="addr_state"/>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_socontact__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_socontact__c.label}"/>
                <span id="addr_socontact"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_country__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_country__c.label}"/>
                <span>
                    <span id="addr_country"/>
                    &nbsp;(<span id="addr_isocountry"/>)
                </span>
            </apex:pageBlockSectionItem>
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_conmethod__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_conmethod__c.label}"/>
                <span id="addr_conmethod"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
        <apex:pageBlockSection >
            <apex:pageBlockSectionItem helpText="{!f_soaddr.rstk__soaddr_zip__c.inlineHelpText}">
                <apex:outputLabel value="{!f_soaddr.rstk__soaddr_zip__c.label}"/>
                <span id="oaddr_zip"/>
            </apex:pageBlockSectionItem>
        </apex:pageBlockSection>
    </c:Popup>

     <c:Popup popupId="inventoryItemPopup" title="{!f_sl.rstk__soline_icitem__c.label}" onOk="saveInventoryItem();">
       <apex:pageBlockSection showHeader="false" columns="2" collapsible="false">
           <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_icitem__c.inlineHelpText}">
                <apex:outputLabel value="{!f_sl.rstk__soline_icitem__c.label}"/>
               <select id="popup_soline_icitem__c" style="width:200px" onchange="onInvicitemChanged(); return false;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem />
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyoh__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyoh__c.label}"/>
               <div id="inv_icitemsiteproj_qtyoh__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_div__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_div__c.label}"/>
               <div id="inv_icitemsiteproj_div__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyalloc__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyalloc__c.label}"/>
               <div id="inv_icitemsiteproj_qtyalloc__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_proj__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_proj__c.label}"/>
               <div id="inv_icitemsiteproj_proj__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyavail__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_qtyavail__c.label}"/>
               <div id="inv_icitemsiteproj_qtyavail__c" style="width:100px; font-weight:bold;text-align:right;"/>
           </apex:pageBlockSectionItem>
           <apex:pageBlockSectionItem helpText="{!f_icitemsiteproj.rstk__icitemsiteproj_site__c.inlineHelpText}">
               <apex:outputLabel value="{!f_icitemsiteproj.rstk__icitemsiteproj_site__c.label}"/>
               <div id="inv_icitemsiteproj_site__c" style="width:100px; font-weight:bold;"/>
           </apex:pageBlockSectionItem>
         </apex:pageBlockSection>
     </c:Popup>

    <apex:actionRegion >
      <apex:actionStatus onstart="showTopDialog('pleaseWaitPopup');" onstop="closeTopDialog();" id="pleaseWaitStatus"/>
      <apex:actionFunction name="searchProducts" action="{!searchProducts}" status="pleaseWaitStatus" immediate="true" reRender="searchprod_message, searchprod_tables">
         <apex:param name="search" value=""/>
         <apex:param name="mode" value=""/>
         <apex:param name="customer" value=""/>
         <apex:param name="productType" value=""/>
         <apex:param name="spaceSepStrOptions" value=""/>
         <apex:param name="limitToCustomerProduct" value=""/>
      </apex:actionFunction>
    
    <c:Popup popupId="chooseProductPopup" title="{!$Label.rstk__pagepopup_salesorder_customerproductlookup}">
    <apex:pageBlockSection columns="2">
      <apex:pageBlockSectionItem helpText="{!$Label.rstk__salesorder_enter_search_values_here}">
          <apex:outputPanel >
            <input id="ProductSearchCriteria" style="width:300px;" value=""/>
            <input type="button" class="btn" id="chooseProductSearchButton" value="{!$Label.salesorder_pagebtn_Search}" onclick="doSearchProducts(); return false;"/><br/><br/>
            <table>
              <tr>
                <td align="right">{!$Label.SpaceSeparatedStringOptions}</td>
                <td align="left">
                    <select name="spaceSelectOption">:
                        <option value="AND">{!$Label.ProductSpaceSearchAll}</option>
                        <option value="OR">{!$Label.ProductSpaceSearchOR}</option>
                        <option value="EXACT">{!$Label.ProductSpaceSearchExact}</option>
                    </select><br/><br/>
                </td>
              </tr>
              <tr>
                <td align="right">{!$Label.LimitSearchToCustomerProducts}</td>
                <td align="left"><input type="checkbox" name="limitToCustomerProduct" onchange="limitToCustomerProductChanged()"/></td>
              </tr>
            </table>
          </apex:outputPanel>
      </apex:pageBlockSectionItem>

      <apex:pageBlockSectionItem helpText="{!$Label.rstk__salesorder_entry_criteria}">
          <apex:outputPanel >
             <input type="radio" name="selectType" value="ProductNumber"/>
             <apex:outputLabel value="{!$Label.rstk__customerproductnumber}"/><br/>
             <input type="radio" name="selectType" value="ProductDescription"/>
             <apex:outputLabel value="{!$Label.rstk__customerproductdescription}"/><br/>
             <input type="radio" name="selectType" value="RSProductNumber"/>
             <apex:outputLabel value="{!$Label.rstk__rootstockproductnumber}"/><br/>
             <input type="radio" name="selectType" value="RSProductDescription"/>
             <apex:outputLabel value="{!$Label.rstk__rootstockproductdescription}"/><br/>
             <input type="radio" name="selectType" value="All" checked="true"/>
             <apex:outputLabel value="{!$Label.rstk__all}"/>
          <script>
            if ({!socntl.rstk__socntl_dlftcustprodsrch__c}) {
              jQuery("input[name=limitToCustomerProduct]").attr("checked", "checked");
            } else {
              jQuery("input[value=ProductNumber]").attr("disabled", "disabled");
              jQuery("input[value=ProductDescription]").attr("disabled", "disabled");
            }
          </script>
          </apex:outputPanel>
      </apex:pageBlockSectionItem>
     </apex:pageBlockSection>
     
     <apex:pageBlockSection id="searchprod_message" columns="1">
       <apex:outputPanel rendered="{!!ISNULL(productSearchMessage)}">
            <apex:image value="/img/msg_icons/warning16.png"/>&nbsp;{!productSearchMessage}
       </apex:outputPanel>
     </apex:pageBlockSection>
     
     <apex:pageBlockSection id="searchprod_tables" columns="1">

            <apex:pageBlockTable id="searchprod_table" var="s" value="{!productSearchResults}" rendered="{!productSearchResults.size > 0}">
                    <apex:column headerValue="{!$Label.rstk__customerproductnumber}">
                        <a href="#" onclick="setProduct('{!s.rstk__sopc_soprod__c}'); return false;">{!s.rstk__sopc_prodname__c}</a>
                     </apex:column>
                    <apex:column headerValue="{!$Label.rstk__customerproductdescription}">
                        <a href="#" onclick="setProduct('{!s.rstk__sopc_soprod__c}'); return false;">{!s.rstk__sopc_proddesc__c}</a>
                     </apex:column>
                    <apex:column headerValue="{!$Label.rstk__standardproductnumber}">
                        <a href="#" onclick="setProduct('{!s.rstk__sopc_soprod__c}'); return false;">{!s.sopc_soprod__r.rstk__soprod_prod__c}</a>
                     </apex:column>
                    <apex:column headerValue="{!$Label.rstk__standardproductdescription}">
                        <a href="#" onclick="setProduct('{!s.rstk__sopc_soprod__c}'); return false;">{!s.sopc_soprod__r.rstk__soprod_descr__c}</a>
                     </apex:column>
            </apex:pageBlockTable>
            <apex:pageBlockTable id="rssearchprod_table" var="s" value="{!rsProductSearchResults}" rendered="{!rsProductSearchResults.size > 0}">
                    <apex:column headerValue="{!$Label.rstk__customerproductnumber}">
                        
                     </apex:column>
                    <apex:column headerValue="{!$Label.rstk__customerproductdescription}">
                        
                     </apex:column>
                    <apex:column headerValue="{!$Label.rstk__standardproductnumber}">
                       <a href="#" onclick="setProduct('{!s.Id}'); return false;">{!s.rstk__soprod_prod__c}</a>
                      </apex:column>
                    <apex:column headerValue="{!$Label.rstk__standardproductdescription}">
                        <a href="#" onclick="setProduct('{!s.Id}'); return false;">{!s.rstk__soprod_descr__c}</a>
                     </apex:column>
            </apex:pageBlockTable>
        </apex:pageBlockSection>

     <apex:pageBlockSection id="searchprod_permmessage" columns="1">
       {!$Label.rstk__dependingoncriteriaproductsearchingmaytakeseveralminutes}
     </apex:pageBlockSection>
    </c:Popup> 
    </apex:actionRegion>

    <c:Popup title="{!$Label.rstk__notificationtitle}" popupId="dealPriceAllocationConfirmDialog"
             onOk="_closeDialog(); showTopDialog('pleaseWaitPopup'); performDealPriceAllocation();" okCaption="{!$Label.rstk__pagebtn_continue}">
      <span style="font-weight:bold;" id="DealPriceAllocNumLines">{!$Label.salesOrder_TEXT}</span>
      <br/><br/>
      <span>{!$Label.Warning_Any_unsaved_data_will_be_lost_when_the_Allocation_is_performed}</span>
    </c:Popup>

    <c:Popup title="{!$Label.rstk__duedateoverridetitle}" popupId="dateOverridePopup" onOk="dateOverridePopupOk();" okCaption="{!$Label.rstk__pagebtn_continue}">
        <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_duedate__c.inlineHelpText}">
            <apex:outputLabel value="{!f_sl.rstk__soline_duedate__c.label}"/>
            <apex:inputField id="dueDateOverride" value="{!solineOverrides.rstk__soline_duedate__c}"/>
        </apex:pageBlockSectionItem>
        <apex:pageBlockSectionItem >
            <apex:outputLabel value="{!$Label.rstk__update_partially_shipped_lines}"/>
            <input type="checkbox" id="dueDateOverridePartials"/>
        </apex:pageBlockSectionItem>
        <br/><br/>
        <apex:pageBlockSectionItem >
              <apex:image value="/img/msg_icons/warning16.png"/>
              <apex:outputLabel value="{!$Label.rstk__warninganyunsaveddatawillbelostwhenduedatechanged}"/>
        </apex:pageBlockSectionItem>
    </c:Popup>

     <c:Popup popupId="relatedCustomerAddressPopup" title="{!$Label.rstk__pagepopup_relatedcustomeraddress}" okCaption="{!$Label.rstk__salesorder_save}" onOk="saveRelatedCustomerAddress();">
        <apex:pageBlockSectionItem helpText="{!f_sl.rstk__soline_icitem__c.inlineHelpText}">
           <span style="font-weight:bold;color:blue;">{!$Label.rstk__highlightordoubleclickaddressselection}</span>
       </apex:pageBlockSectionItem>
       <table class="list" id="relatedCustomerAddressTable">
         <thead>
         <tr class="headerRow">
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_custno__c.label}</th>
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_name__c.label}</th>
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_address1__c.label}</th>
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_city__c.label}</th>
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_state__c.label}</th>
            <th class="headerCell" scope="col">{!f_socaddr.rstk__socaddr_zip__c.label}</th>
         </tr>
         </thead>
         <tbody id="relatedCustomerAddressTableBody">
         </tbody>
       </table>
     </c:Popup>

     <c:Popup title="{!$Label.rstk__override_exchange_rate}" popupId="showOverrideexchratePopup">
         <apex:pageBlockSection id="pb_edit_overrideexchratesch" columns="1"> 
             <apex:pageBlockSectionItem helpText="{!f_customext.rstk__so_exchrate_schedule__c.inlineHelpText}" id="pb_edit_si_overrideexchratesch">
                 <apex:outputLabel value="{!f_customext.rstk__so_exchrate_schedule__c.label}"/>
                 <apex:outputPanel id="pb_edit_op_overrideexchratesch">                            
                     <apex:inputField id="so_exchrate_schedule" value="{!customext.rstk__so_exchrate_schedule__c}" onchange="blockPopupUI('pleaseWaitPopup');exchrateScheduleChangedFunction(this.value);"/>                            
                 </apex:outputPanel>
             </apex:pageBlockSectionItem>
             <apex:pageBlockSectionItem helpText="{!f_customext.rstk__so_override_schedule__c.inlineHelpText}" id="pb_edit_op_override_schedule">
                 <apex:outputLabel value="{!f_customext.rstk__so_override_schedule__c.label}"/>
                 <apex:outputPanel >
                     <apex:selectList id="so_override_schedule__c" value="{!customext.rstk__so_override_schedule__c}" onchange="blockPopupUI('pleaseWaitPopup');overrideScheduleChanged(this.value);" size="5">
                         <apex:selectOptions value="{!syforexschednos}" />
                     </apex:selectList>
                 </apex:outputPanel>
             </apex:pageBlockSectionItem> 
             <apex:pageBlockSectionItem helpText="{!f_customext.rstk__so_override_exchrate__c.inlineHelpText}" id="pb_edit_si_overrideexchrate">
                 <apex:outputLabel value="{!f_customext.rstk__so_override_exchrate__c.label}"/>
                 <apex:outputPanel id="pb_edit_op_overrideexchrate">                            
                     <apex:outputField id="so_override_exchrate" value="{!customext.rstk__so_override_exchrate__c}" />                            
                 </apex:outputPanel>
             </apex:pageBlockSectionItem>
             <apex:pageBlockSectionItem />          
             <apex:pageBlockSectionItem >          
                 <apex:outputPanel rendered="true">
                     <apex:outputLabel value=""/>
                     <input type="button" name="useSchButton" class="btn" value="{!$Label.Use_Selected_Override_Schedule}" onclick="blockUI();saveOverrideRateCheck('false');" />
                     <input type="button" name="revSchButton" class="btn" value="{!$Label.Revert_to_Current_Spot_Rate}" onclick="blockUI();saveOverrideRateCheck('true');" />
                 </apex:outputPanel>                                
             </apex:pageBlockSectionItem>
         </apex:pageBlockSection>
     </c:Popup>    
     <div id="pleaseWaitPopup" class="overlay">
         <span style="border-radius: 5px;color: #000;background-color: #fff;">
         </span>
     </div>
    </apex:form>
  <apex:outputpanel rendered="{!!complexOpRequired}">
    <apex:outputpanel rendered="{!AND(o.id != null, isStandaloneHeader)}">
      <table style="width:100%;">
        <tr style="width:100%;">
          <td style="width:40%;"> </td>
          <td style="width:30%;font-size:1.5em;">
            <apex:outputLabel value="{!$Label.rstk__orderlinestotal}: "/>
              <span name="SOtotal">{!o.rstk__sohdr_ordertotal__c}</span>
          </td>
          <td style="width:30%;font-size:1.5em;">
              <apex:outputLabel value="{!$Label.rstk__pretaxtotal}: "/>
              <span name="PretaxTotal"></span>
          </td>
        </tr>
      </table>
      <apex:relatedList list="solines__r" pageSize="200"/>
      <table style="width:100%;">
        <tr style="width:100%;">
          <td style="width:40%;"> </td>
          <td style="width:30%;font-size:1.5em;">
            <apex:outputLabel value="{!$Label.rstk__orderlinestotal}: "/>
              <span name="SOtotal">{!o.rstk__sohdr_ordertotal__c}</span>
          </td>
          <td style="width:30%;font-size:1.5em;">
              <apex:outputLabel value="{!$Label.rstk__pretaxtotal}: "/>
              <span name="PretaxTotal"></span>
          </td>
        </tr>
      </table>
    </apex:outputpanel>
  </apex:outputpanel>

    <apex:relatedList list="CombinedAttachments" rendered="{!AND(o.id != null, !complexOpRequired)}" subject="{!o.id}" />
    <apex:relatedList id="sohdrpays" list="sohdrpays__r" rendered="{!AND(o.id != null, !complexOpRequired)}" subject="{!o.id}" />
    <apex:relatedList id="sogateauds" list="sogateauds__r" rendered="{!AND(o.id != null, showSOGateAudits)}" subject="{!o.id}" />

    <c:footerInclude cntr="{!controller}" showActivities="{!AND(o.id != null, !complexOpRequired)}" showHistory="{!AND(o.id != null, !complexOpRequired)}"/>
    <apex:dynamicComponent componentValue="{!DynamicRelatedLists}" rendered="{!o.id != null}"/>
     
   <script>
        var InvalidPageMode = "{!$Label.rstk__invalidpagemodetype}";
        var PriceChangeFutureOnly = "{!$Label.rstk__priceaffectsfutureshippersonly}";
        var LABEL_ThisWouldClearOutOverrideAddrInfo_WishToCont = "{!$Label.rstk__thiswouldclearoutoverrideaddrinfo_wishtocont}";
        var LABEL_AreYouSureYouWantToChangeOrdQty = "{!$Label.rstk__areyousureyouwanttochangeordqty}";
        var LABEL_ThisUnsetsLineOverrideAddr_WishToCont = "{!$Label.rstk__thisunsetslineoverrideaddr_wishtocont}";
        var LABEL_NoSOLineRowsSelected_WishToCont = "{!$Label.rstk__nosolinerowsselected_wishtocont}";
        var LABEL_All = "{!$Label.rstk__all}";
        var LABEL_DimensionValueNotValid = "{!$Label.rstk__dimensionvaluenotvalid}";
        var LABEL_Specified_VAT_Class_has_been_marked_as_inactive_and_must_be_changed = "{!$Label.rstk__specified_vat_class_has_been_marked_as_inactive_and_must_be_changed}";
        var LABEL_No_Override_or_Locked_In_Exchange_Rate_Schedules_exist_for_this_transaction_curr = "{!$Label.rstk__no_override_or_locked_in_exchange_rate_schedules_exist_for_this_transaction_curr}";
    </script>

    <script type="text/javascript">
      jQuery(document).ready(() => {
        jQuery('.addressesBtn').removeAttr('disabled');
      });
    </script>
</apex:page>