<apex:page id="pg" standardController="rstkf__arcashh__c" extensions="rstkf.ControllerExtnArcashh2,rstkf.RemoteQueryController,rstkf.ControllerJobStatus" sideBar="false" showHeader="true" action="{!doBeforePageLoad}">
    <apex:variable var="o" value="{!rstkf__arcashh__c}" />
    <apex:variable var="f" value="{!$ObjectType.rstkf__arcashh__c.fields}" />
    <apex:variable var="f_arcashd" value="{!$ObjectType.rstkf__arcashd__c.fields}" />
    <apex:variable var="f_glbankacct" value="{!$ObjectType.rstkf__glbankacct__c.fields}" />
    <apex:variable var="f_glacct" value="{!$ObjectType.rstkf__glacct__c.fields}" />
    <apex:variable var="f_customextf" value="{!$ObjectType.rstkf__customextf__c.fields}" />
    
    <c:standardHeader cntr="{!controller}" displayListLink="true" title="{!$Label.rstkf__cash_receipt}" enableAutocomplete="true"/>
    
    <apex:stylesheet value="{!$Resource.rstkf__ModalPopup_css}"/>
    <apex:includeScript value="{!$Resource.rstkf__RowHandler_js}"/>
    <apex:includeScript value="{!$Resource.rstkf__hover_popup}" />
    <apex:includeScript value="{!$Resource.rstkf__BlockUI}" />
    <apex:includeScript value="{!$Resource.rstkf__jquerytoolsoverlay}" />
    <apex:includeScript value="{!$Resource.rstkf__hover_popup}" />
    <style>
        .overlay {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 40000;
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%;
            text-align: center;
            background-color: rgba(0,0,0,0.4);
        }
        
        .Processing
        {
            position: fixed;
            background: url({!$Resource.rstkf__busy});
            background-repeat: no-repeat;
            background-position: center;
            width: 100%;
            height: 100%;
            z-index: 2004;
            left: 0%;
            top: 0%;
        }
        
        input:disabled {
            background: #dddddd;
        }
        
        .sort {display:inline}
        .numSort {display:inline}
        
        .floatingStyle { 
            background-color:#829DC0 !important;
        }
    </style>
    <apex:form id="fm">
        <apex:actionStatus id="statusProcessingCashRcpts" startStyleClass="Processing"/>
        <apex:actionFunction name="doView" action="{!view}" immediate="false"/>
        <apex:actionFunction name="doEdit" action="{!edit}" immediate="false"/>
        <apex:actionFunction name="doDelete" action="{!doDelete}" immediate="false"/>
        <apex:actionFunction name="doCancel" action="{!cancel}" immediate="false"/>
        <apex:actionFunction name="doSave" action="{!save}"/>
        <apex:actionFunction name="doCashToGL" action="{!doCashToGL}" onComplete="openCashToGL();" rerender="op_c2gl_popup" immediate="false" status="statusProcessingCashRcpts"/>
        <apex:actionFunction name="postDeposit" action="{!postDeposit}" immediate="false" rerender="pageMessages,op_vars" oncomplete="doAfterPostDeposit();" status="statusProcessingCashRcpts"/>
        <apex:actionFunction name="recreateApplications" action="{!recreateApplications}" immediate="false" rerender="pageMessages,op_vars" oncomplete="checkJobStatus();" status="statusProcessingCashRcpts"/>
        <apex:actionFunction name="setToPending" action="{!setToPending}" immediate="false" status="statusProcessingCashRcpts"/>
        <apex:actionFunction name="deleteSelectedPayments" action="{!deleteSelectedPayments}" immediate="false"/>
        <apex:actionFunction name="bankAcctChanged" action="{!bankAcctChanged}" 
            rerender="pageMessages, op_arcashh_glbankacct_curr_c, op_arcashh_glbankacct_acct_c, op_arcashh_bankhomeexchrate__c, op_vars"  
            oncomplete="bankhomeexchrateChanged();" immediate="false" status="statusProcessingCashRcpts"/>
            
        <apex:actionFunction name="releaseDepositLock" action="{!releaseDepositLock}" immediate="false"/>
        <apex:outputpanel id="op_vars">
            <script>
                var isEdit = {!isEdit};
                var isNew = {!isNew};
                var bankCurrSameAsHomeCurr = '{!bankCurrSameAsHomeCurr}';
                var isPostedSuccessfully = '{!isPostedSuccessfully}';
                var batchamthome = '{!o.rstkf__arcashh_batchamthome__c}';
                var paymentshome = '{!o.rstkf__arcashh_paymentshome__c}';
                var isnopay = '{!o.rstkf__arcashh_nopay__c}';
            </script>
        </apex:outputpanel>
        <apex:outputPanel id="op_JobStatus">
           <input type="hidden" id="processlogId" value="{!processlogId}"/>
        </apex:outputPanel>
        <apex:pageBlock id="pb" mode="detail" >
            <apex:pageBlockButtons >
                <c:standardButtons cntr="{!controller}" rendered="{!!isPosted && canMaintainDeposit}"/>
                <apex:commandButton id="newArcashh" value="{!$Label.rstkf__btn_new}" onclick="window.location.href = '/apex/arcashh2'; return false;" rendered="{!isView && !isPosted && canMaintainDeposit}" style="width:70px"/>
                <apex:commandButton id="cashToGl" value="{!$Label.rstkf__btn_cashtogl}" onclick="doCashToGL(); return false;" rendered="{!isView && !isPosted && canMaintainDeposit}"/>
                <apex:commandButton Id="setToPending" value="{!$Label.rstkf__btn_settopending}" onclick="setToPending();return false;" rendered="{!isView && canMaintainDeposit && arcashh.rstkf__arcashh_poststatus__c == 'Entry Incomplete'}" />
                <apex:commandButton Id="postDeposit" value="{!$Label.rstkf__btn_postdeposit}" onclick="postDeposit();return false;" rendered="{!isView && canMaintainDeposit && !arcntl.rstkf__arcntl_arbatchopt__c && arcashh.rstkf__arcashh_poststatus__c == 'Pending'}" />
                <!-- <apex:commandButton id="cashReceiptsWB" value="{!$Label.btn_CashReceiptsWB}" onclick="openCashReceiptsWB(); return false;" rendered="{!isView && canMaintainDeposit && !isPosted}"/> -->
                <apex:commandButton id="releaseLock" value="{!$Label.rstkf__btn_releasedepsositlock}" onclick="releaseDepositLock(); return false;" rendered="{!isView && canMaintainDeposit && !isPosted}"/>
                <apex:commandButton value="{!$Label.rstkf__changedepositdate}" onclick="_showDialog('DepositDatePopup'); return false;" rendered="{!isView && !isPosted && canMaintainDeposit}" />
                <apex:commandButton value="{!$Label.rstkf__btn_recreateapplications}" onclick="doRecreateApplications(); return false;" rendered="{!showRecreateApplics}" />
            </apex:pageBlockButtons>
            
            <apex:pageBlockSection id="pbs_main" columns="2" rendered="{!OR(isNew,isEdit)}">
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_glcmp__c.inlineHelpText}" labelStyle="width:13%">
                    <apex:outputLabel value="{!f.rstkf__arcashh_glcmp__c.label}" />
                    <apex:outputField value="{!o.rstkf__arcashh_glcmp__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_batchno__c.inlineHelpText}" labelStyle="width:13%">
                    <apex:outputLabel value="{!f.rstkf__arcashh_batchno__c.label}" />
                    <apex:outputField value="{!o.rstkf__arcashh_batchno__c}"/>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_glbankacct__c.inlineHelpText}" labelStyle="width:13%">
                    <apex:outputLabel value="{!f.rstkf__arcashh_glbankacct__c.label}" />
                    <apex:outputpanel >
                        <apex:selectList id="arcashh_glbankacct__c" value="{!o.rstkf__arcashh_glbankacct__c}" 
                            size="1" style="width:250px;" onchange="bankAcctChanged();" 
                            tabindex="61" rendered="{!isNew}">
                            <apex:selectOptions value="{!glbankaccts}" /> 
                        </apex:selectList>
                        <apex:outputField value="{!o.rstkf__arcashh_glbankacct__c}" rendered="{!isEdit}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f_glacct.rstkf__glacct_acct__c.inlineHelpText}" labelStyle="width:13%">
                    <apex:outputLabel value="{!$Label.rstkf__label_glcashaccount}" />
                    <!-- Set when bank account is selected -->
                    <apex:outputpanel id="op_arcashh_glbankacct_acct_c">
                        <apex:outputField value="{!glbankacct.glbankacct_glacct__r.rstkf__glacct_acct__c}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_batchamtbank__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_batchamtbank__c.label}" />
                    <apex:inputField id="arcashh_batchamtbank__c" value="{!o.rstkf__arcashh_batchamtbank__c}" onchange="batchamtbankChanged();" />
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_discountgracedays__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_discountgracedays__c.label}" />
                    <apex:inputField id="arcashh_discountgracedays__c" value="{!o.rstkf__arcashh_discountgracedays__c}" onchange="discountgracedaysChanged();"/>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_depref__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_depref__c.label}" />
                    <apex:outputpanel >
                        <apex:inputField id="arcashh_depref__c" value="{!o.rstkf__arcashh_depref__c}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_nopay__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_nopay__c.label}" />
                    <apex:inputField id="arcashh_nopay__c" value="{!o.rstkf__arcashh_nopay__c}" onchange="nopayChanged()"/>
                </apex:pageBlockSectionItem>
                
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_depdate__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_depdate__c.label}" />
                    <apex:outputpanel id="op_depositdate" >
                        <apex:inputField id="arcashh_depdate__c" value="{!o.rstkf__arcashh_depdate__c}" rendered="{!isNew}" onchange="bankAcctChanged();"/>
                        <apex:outputField value="{!o.rstkf__arcashh_depdate__c}" rendered="{!!isNew}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f_glbankacct.rstkf__glbankacct_curr__c.inlineHelpText}" labelStyle="width:13%">
                    <apex:outputLabel value="{!$Label.rstkf__label_bankcurrency}" />
                    <!-- Set when bank account is selected -->
                    <apex:outputpanel id="op_arcashh_glbankacct_curr_c">
                        <apex:outputField value="{!glbankacct.rstkf__glbankacct_curr__c}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                
                <!-- apex:pageBlockSectionItem helpText="{!f.arcashh_trandate__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.arcashh_trandate__c.label}" />
                    <apex:outputpanel >
                        <apex:inputField id="arcashh_trandate__c" value="{!o.arcashh_trandate__c}" rendered="{!isNew}"/>
                        <apex:outputField value="{!o.arcashh_trandate__c}" rendered="{!isEdit}"/>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem-->
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_poststatus__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_poststatus__c.label}" />
                    <apex:inputField id="arcashh_poststatus__c" value="{!o.rstkf__arcashh_poststatus__c}"/>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_bankhomeexchrate__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_bankhomeexchrate__c.label}" />
                    <apex:outputpanel id="op_arcashh_bankhomeexchrate__c">
                        <apex:inputField id="arcashh_bankhomeexchrate__c" value="{!o.rstkf__arcashh_bankhomeexchrate__c}" onchange="bankhomeexchrateChanged();" />
                        <script>jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = true;</script>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                
                <!--  apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_poststatus__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_poststatus__c.label}" />
                    <apex:inputField id="arcashh_poststatus__c" value="{!o.rstkf__arcashh_poststatus__c}"/>
                </apex:pageBlockSectionItem-->
                <apex:pageBlockSectionItem >
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_batchamthome__c.inlineHelpText}">
                    <apex:outputLabel value="{!f.rstkf__arcashh_batchamthome__c.label}" />
                    <apex:outputpanel id="op_arcashh_batchamthome__c">
                        <apex:inputField id="arcashh_batchamthome__c" value="{!o.rstkf__arcashh_batchamthome__c}"  />
                        <script>jQuery('input[id*=arcashh_batchamthome__c]')[0].disabled = true;</script>
                    </apex:outputpanel>
                </apex:pageBlockSectionItem>
                
            </apex:pageBlockSection>
            
            
            <apex:pageBlockSection id="pbs_main2" columns="2" rendered="{!isView}"  >
                <apex:outputField value="{!o.rstkf__arcashh_glcmp__c}"/>
                <apex:outputField value="{!o.rstkf__arcashh_batchno__c}"/>
                <apex:outputField value="{!o.rstkf__arcashh_glbankacct__c}"/>
                 <apex:outputField value="{!glbankacct.glbankacct_glacct__r.rstkf__glacct_acct__c}"/>
                 <apex:outputField value="{!o.rstkf__arcashh_batchamtbank__c}"/>
                 <apex:outputField value="{!o.rstkf__arcashh_discountgracedays__c}"/>
                 <apex:outputField value="{!o.rstkf__arcashh_depref__c}"/>
                 <apex:outputField value="{!o.rstkf__arcashh_nopay__c}"/>
                 <apex:outputField value="{!o.rstkf__arcashh_depdate__c}"/>
                <apex:outputField value="{!glbankacct.rstkf__glbankacct_curr__c}"/>
                <apex:outputField value="{!o.rstkf__arcashh_poststatus__c}"/>
                <!--  apex:outputField value="{!o.arcashh_trandate__c}"/-->
                <apex:outputField value="{!o.rstkf__arcashh_bankhomeexchrate__c}"/>
                <apex:outputLabel value=""/>
                <apex:outputField value="{!o.rstkf__arcashh_batchamthome__c}"/>
                
            </apex:pageBlockSection>
            
            <apex:pageBlockSection id="pbs_advanced" columns="1" collapsible="true" showHeader="true" title="Advanced">
                <apex:tabPanel switchType="client" selectedtab="tab_depositconstraints" id="depositTabPanel">
                    <apex:tab label="{!$Label.rstkf__tab_constraints}" name="tab_depositconstraints" id="tab_depositconstraints" immediate="false" >
                        <apex:pageBlock >
                            <apex:pageBlockSection columns="2">
                                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_crossdiv__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstkf__arcashh_crossdiv__c.label}" />
                                    <apex:outputPanel >
                                        <apex:inputField id="arcashh_crossdiv__c" label="{!f.rstkf__arcashh_crossdiv__c.label}" value="{!o.rstkf__arcashh_crossdiv__c}" taborderhint="81" rendered="{!!isView}"/>
                                        <apex:outputField value="{!o.rstkf__arcashh_crossdiv__c}" rendered="{!isView}"/>                                                                                                                                              
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_nodivisanydiv__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstkf__arcashh_nodivisanydiv__c.label}" />
                                    <apex:outputPanel >
                                        <apex:inputField id="arcashh_nodivisanydiv__c" label="{!f.rstkf__arcashh_nodivisanydiv__c.label}" value="{!o.rstkf__arcashh_nodivisanydiv__c}" taborderhint="84" rendered="{!!isView}"/>
                                        <apex:outputField value="{!o.rstkf__arcashh_nodivisanydiv__c}" rendered="{!isView}"/>                                                                                                                                              
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_crossprojects__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstkf__arcashh_crossprojects__c.label}" />
                                    <apex:outputPanel >
                                        <apex:inputField id="arcashh_crossprojects__c" label="{!f.rstkf__arcashh_crossprojects__c.label}" value="{!o.rstkf__arcashh_crossprojects__c}" taborderhint="82" rendered="{!!isView}"/>
                                        <apex:outputField value="{!o.rstkf__arcashh_crossprojects__c}" rendered="{!isView}"/>                                                                                                                                              
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_noprojisanyproj__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstkf__arcashh_noprojisanyproj__c.label}" />
                                    <apex:outputPanel >
                                        <apex:inputField id="arcashh_noprojisanyproj__c" label="{!f.rstkf__arcashh_noprojisanyproj__c.label}" value="{!o.rstkf__arcashh_noprojisanyproj__c}" taborderhint="85" rendered="{!!isView}"/>
                                        <apex:outputField value="{!o.rstkf__arcashh_noprojisanyproj__c}" rendered="{!isView}"/>                                                                                                                                              
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem helpText="{!f.rstkf__arcashh_crosscurrs__c.inlineHelpText}">
                                    <apex:outputLabel value="{!f.rstkf__arcashh_crosscurrs__c.label}" />
                                    <apex:outputPanel >
                                        <apex:inputField id="arcashh_crosscurrs__c" label="{!f.rstkf__arcashh_crosscurrs__c.label}" value="{!o.rstkf__arcashh_crosscurrs__c}" rendered="{!!isView}"/>
                                        <apex:outputField value="{!o.rstkf__arcashh_crosscurrs__c}" rendered="{!isView}"/>                                                                                                                                              
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>
                                
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstkf__tab_totals}" name="tab_totals" id="tab_totals" immediate="false" rendered="{!!isNew}">
                        <apex:pageBlock >
                            <apex:pageBlockSection columns="1">
                                <apex:outputField value="{!o.rstkf__arcashh_paycountsum__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_paymentshome__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_paymentsbank__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_openhome__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_openbank__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_netappliedhome__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_netappliedbank__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_bankhomerounding__c}"/>
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </apex:tab>
                    <apex:tab label="{!customFieldTabName}" name="tab_Custom" id="tab_Custom" rendered="{!hasCustomFields}">
                        <c:customFields cntr="{!controller}" cols="2"/>
                    </apex:tab>
                    <apex:tab label="{!$Label.rstkf__pagetab_info}" name="tab_Info" id="tab_Info" rendered="{!!isNew}">
                        <apex:pageBlock >
                            <c:InfoSection cntr="{!controller}" showHeader="flase"/>
                        
                            <apex:pageBlockSection columns="2" showHeader="false" >
                                <apex:outputField value="{!o.rstkf__arcashh_initialuser__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_lastuser__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_glyear__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_period__c}"/>
                                <apex:outputField value="{!o.rstkf__arcashh_postdate__c}"/>
                            </apex:pageBlockSection>
                        </apex:pageBlock>
                    </apex:tab>
                </apex:tabPanel>
            </apex:pageBlockSection>
            
            <apex:pageBlockSection id="pbs_payments" columns="1" rendered="{!isView}" collapsible="false" showHeader="true" title="{!$Label.rstkf__btn_payments}">
                <apex:outputPanel rendered="{!!isPosted && canMaintainDeposit}">
                    <apex:outputLink styleClass="btn" style="text-decoration:none;padding:4px;" value="{!URLFOR($Action.rstkf__arcashd__c.New, null, [arcashhId=o.Id, retURL=o.Id])}" target="_top">{!$Label.rstkf__btn_newpayment}</apex:outputLink>
                    <input type="button" id="paymentQuickEntry" value="{!$Label.btn_PaymtQuickEntry}" class="btn" onclick="_showDialogCustom('arcashd_popup', window.getWindowWidth(), window.getWindowHeight())" />&nbsp;
                    <apex:commandButton id="delete" value="{!$Label.rstkf__btn_deleteselected}" onclick="blockUI();deleteSelectedPayments(); return false;"/>
                </apex:outputPanel>  
                <apex:pageBlockTable id="pbt_payments" value="{!arcashdRecs}" var="rec" columnsWidth="5%,10%,5%,20%,5%,10%,15%,10%,10%,15%">
                    <apex:column headerValue="{!$Label.rstkf__pagevalselect}">
                        <apex:inputCheckbox id="selected" value="{!rec.selected}"/>
                    </apex:column>
                    <apex:column headerValue="Action" style="white-space: nowrap;">
                        <apex:outputLink value="{!URLFOR($Action.rstkf__arcashd__c.Edit, rec.arcashd.id)}" target="_top" rendered="{!!isPosted && canMaintainDeposit}">{!$Label.rstkf__edit} |</apex:outputLink> &nbsp;&nbsp;
                        <apex:outputLink value="{!URLFOR($Action.rstkf__arcashd__c.View, rec.arcashd.id)}" target="_top">{!$Label.rstkf__view}</apex:outputLink> &nbsp;&nbsp;
                    </apex:column>
                    <apex:column headerValue="Applications" style="white-space: nowrap;">
                        <apex:outputLink value="javascript:{}" 
                        	rendered="{!!isPosted && canMaintainDeposit && rec.arcashd.rstkf__arcashd_paycust__c != null}" 
                        	ondblclick="return false;"
                        	onclick="openNewApplications('{!rec.arcashd.id}');">{!$Label.rstkf__new} |</apex:outputLink> &nbsp;&nbsp;
                        <apex:outputLink value="javascript:{}" 
                        	rendered="{!!isPosted && canMaintainDeposit && rec.arcashd.rstkf__arcashd_paycust__c != null}" 
                        	ondblclick="return false;"
                        	onclick="openEditApplications('{!rec.arcashd.id}')">{!$Label.rstkf__edit}</apex:outputLink>
                    </apex:column>
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_paycust__c.label}" value="{!rec.arcashd.rstkf__arcashd_paycust__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_paymenttype__c.label}" value="{!rec.arcashd.rstkf__arcashd_paymenttype__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_checkorref__c.label}" value="{!rec.arcashd.rstkf__arcashd_checkorref__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_payamt__c.label}" value="{!rec.arcashd.rstkf__arcashd_payamt__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_payunapplied__c.label}" value="{!rec.arcashd.rstkf__arcashd_payunapplied__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_nopay__c.label}" value="{!rec.arcashd.rstkf__arcashd_nopay__c}" />
                    <apex:column headerValue="{!f_arcashd.rstkf__arcashd_paycurr__c.label}" value="{!rec.arcashd.rstkf__arcashd_paycurr__c}" />
                </apex:pageBlockTable>
                                    
            </apex:pageBlockSection>
        </apex:pageBlock>
        
        <apex:outputPanel >
            <c:Popup popupId="arcashd_popup" title="Payments Quick Entry" onOk="arcashdCtl_saveAndClose();">
                <apex:outputPanel id="op_arcashdGrid">
                    <apex:pageBlock id="pb_arcashd_popup" mode="detail" >
                    	<apex:pageBlockSection id="pbs_arcashd_popup" columns="2" collapsible="false" showHeader="false">
                    		<apex:outputField value="{!o.rstkf__arcashh_outstandingamtbank__c}"/>
                            <apex:outputField value="{!o.rstkf__arcashh_paymentsbank__c}"/>
                    	</apex:pageBlockSection>
                    </apex:pageBlock>
                    <c:PageableGrid jsController="arcashdCtl" data="{!arcashdGrid}" editable="true" disableDelete="false" noselects="false" pageSize="5"/>
                    <script>
                        arcashdCtl.onGridLoad = function() {
                             self = this;
                             this.getVisibleRows().each(function (index, el) {
                                var row = jQuery(this);
                                var arcashdId = self.getRowValue(row, 'Id');
                                if(arcashdId.length == 0) {
                                    arcashdCtl.getRowObj(row, 'arcashd_paycurr__c').attr('disabled', true);
                                    arcashdCtl.setRowValue(row, 'triggeroptions__c', '{"apikey":"API_CRLIB"}');
                                }
                            }); 
                        }
                        
                        arcashdCtl.resetRow = function(row) {
                            self=this;
                            arcashdCtlHandler.prototype.resetRow.call(self, row);
                        }   
                        
                        arcashdCtl.onSaved = function() {
                            unblockUI();
                            window.location.reload();
                        }
                        
                        arcashdCtl.onSaveFailed = function() {
                            unblockUI();
                        }
                        
                        arcashdCtl.addRow = function(rowCallback) {
                            self = this;
                            arcashdCtlHandler.prototype.addRow.call(self, rowCallback);
                            this.getVisibleRows().each(function (index, el) {
                                var row = jQuery(this);
                                arcashdCtl.setRowValue(row, 'triggeroptions__c', '{"apikey":"API_CRLIB"}');
                            });
                            
                        }
                        
                        arcashdCtl_saveAndClose = function() {
                            if(arcashdCtl.validate()) {
                                 blockUI();
                                 arcashdCtl_save();                            
                            }
                        }
                        
                        arcashdCtl.deleteSelectedRows = function() {
		                	self = this;
		                	var candelete = true;
		                    this.getSelectedRows().each(function (index, el) {
		                        var row = jQuery(this);
                                var arcashdId = self.getRowValue(row, 'Id');
		                        
		                        if(arcashdId.length > 0) {
		                            alert('{!$Label.CantDeletePaymentsFromGrid_PlzDeleteFromDepositOrPaymentMaintPage}');
		                            candelete = false;
		                            return false;;
		                        }
		                     });
		                     
		                     if(candelete) {
		                     	arcashdCtlHandler.prototype.deleteSelectedRows.call(this);
		                     }
		                }
                        
                        arcashdCtl.validate = function() {
                            self = this;
                            var isvalid = true;
                            var totaldramt = 0;
                            var totalcramt = 0;
                            this.getVisibleRows().each(function (index, el) {
                                var row = jQuery(this);
                                var arcashdId = self.getRowValue(row, 'Id');
                                if(isvalid && arcashdId.length == 0) {
                                    var paycust = self.getRowValue(row, 'arcashd_paycust__c');
                                    var nopay = self.getRowValue(row, 'arcashd_nopay__c');
                                    var checkorref = self.getRowValue(row, 'arcashd_checkorref__c');
                                    if(paycust.length == 0) {
                                        alert('{!$Label.plzSpecifyCustomer}');
                                        isvalid = false;
                                    }
                                    else if(checkorref.length == 0) {
                                    	alert('{!$Label.plzSpecifyPayref}');
                                        isvalid = false;
                                    }
                                    else if(nopay == false) {
                                        var paycurr = self.getRowValue(row, 'arcashd_paycurr__c');
                                        var paymenttype = self.getRowValue(row, 'arcashd_paymenttype__c');
                                        var payamt = self.getRowValue(row, 'arcashd_payamt__c');
                                        
                                        if(paycurr.length == 0) {
                                            alert('{!$Label.plzSpecifyPaymentCurrency}');
                                            isvalid = false;
                                        }
                                        else if(paymenttype.length == 0) {
                                            alert('{!$Label.plzSpecifyPaymentMethod}');
                                            isvalid = false;
                                        }
                                        else if(getLocaleFloat(payamt) == 0) {
                                            alert('{!$Label.plzSpecifyValidPayAmt}');
                                            isvalid = false;
                                        }
                                    }
                                }
                            }); 
                            return isvalid;
                        }
                        
                        arcashdCtl.entryChanged = function(row, rowNum, name, value) {
                            if (name == 'arcashd_paycust__c') {
                                var arcashhId = self.getRowValue(row, 'arcashd_arcashh__c');
                                var paycust = self.getRowValue(row, 'arcashd_paycust__c');
                                if(paycust.length > 0) {
                                    var arcashhs = execQuery("select arcashh_glcmp__c from arcashh__c where Id = '"+arcashhId+"'");
                                    var glcmpId = arcashhs[0].arcashh_glcmp__c;
                                    
                                    var socustcmpnos = execQuery("select socustcmpno_maintcurr__c from socustcmpno__c where socustcmpno_cmpno__c = '"+glcmpId+"' and socustcmpno_socust__c = '"+ paycust +"'");
                                    var maintcurr = socustcmpnos[0].socustcmpno_maintcurr__c;
                                    arcashdCtl.setRowValue(row, 'arcashd_paycurr__c', maintcurr);
                                }
                                
                                arcashdCtl.getRowObj(row, 'arcashd_paycurr__c').attr('disabled', true);
                            }
                            else if (name == 'arcashd_payamt__c') {
                                arcashdCtl.setRowValue(row, 'arcashd_bankamt__c', value);
                                arcashdCtl.setRowValue(row, 'arcashd_homeamt__c', value);
                            }
                            else if (name == 'arcashd_nopay__c') {
                                var nopay = self.getRowValue(row, 'arcashd_nopay__c');
                                if(nopay == true) {
                                    arcashdCtl.setRowValue(row, 'arcashd_payamt__c', '');
                                    arcashdCtl.setRowValue(row, 'arcashd_bankamt__c', '');
                                    arcashdCtl.setRowValue(row, 'arcashd_homeamt__c', '');
                                    //arcashdCtl.setRowValue(row, 'arcashd_paycurr__c', '');
                                    arcashdCtl.setRowValue(row, 'arcashd_paymenttype__c', '');
                                    //arcashdCtl.setRowValue(row, 'arcashd_checkorref__c', '');
                                    
                                    arcashdCtl.getRowObj(row, 'arcashd_payamt__c').attr('disabled', true);
                                    arcashdCtl.getRowObj(row, 'arcashd_paycurr__c').attr('disabled', true);
                                    arcashdCtl.getRowObj(row, 'arcashd_paymenttype__c').attr('disabled', true);
                                    //arcashdCtl.getRowObj(row, 'arcashd_checkorref__c').attr('disabled', true);
                                }
                                else {
                                    arcashdCtl.getRowObj(row, 'arcashd_payamt__c').attr('disabled', false);
                                    arcashdCtl.getRowObj(row, 'arcashd_paycurr__c').attr('disabled', false);
                                    arcashdCtl.getRowObj(row, 'arcashd_paymenttype__c').attr('disabled', false);
                                    arcashdCtl.getRowObj(row, 'arcashd_checkorref__c').attr('disabled', false);
                                } 
                            }
                        }
                        
                    </script>
                </apex:outputPanel>
            </c:Popup>
        </apex:outputPanel>
        <div id="pleaseWaitPopup" style="display:none">
            <apex:outputPanel styleClass="topPopupBackground" layout="block"/>
            <apex:outputPanel styleClass="topPopup">
                <apex:image url="{!$Resource.rstkf__busy}"/>
            </apex:outputPanel>
        </div>
    </apex:form> 
    
    <apex:outputpanel id="op_c2gl_popup">
        <div id="c2gl" style="height: 330px; display:none; z-index: 10;">
            <apex:outputPanel id="op_c2gl" rendered="{!isView}">
                <apex:pageMessages id="c2glPageMessages"/>
                <apex:form id="fm2">
                <apex:actionStatus id="statusProcessingCashRcpts" startStyleClass="Processing"/>
                <apex:actionFunction name="saveCashToGL" action="{!saveCashToGL}" onComplete="window.location.reload();" immediate="false" status="statusProcessingCashRcpts"/>
                    <apex:pageBlock id="pb_c2gl" mode="detail" title="{!$Label.rstkf__title_newcashtogl}">
                        <apex:pageBlockButtons location="top">
                            <apex:commandButton value="{!$Label.rstkf__btn_save}" onclick="doSaveCashToGL();return false;"/>
                            <apex:commandButton value="{!$Label.rstkf__btn_cancel}" onclick="unblockUI();return false;"/>
                        </apex:pageBlockButtons>
                        <apex:pageBlockSection id="pbs_c2gl" showHeader="false" columns="1" collapsible="false" >
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="{!$Label.rstkf__cashaccount}" />
                                <apex:outputField value="{!o.arcashh_glbankacct__r.glbankacct_glacct__r.Name}"/>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="{!f_customextf.rstkf__cashtogl_cashamt__c.label}" />
                                <apex:outputpanel >
                                	<apex:inputField id="cashtogl_cashamt__c" label="{!f_customextf.rstkf__cashtogl_cashamt__c.label}" value="{!customextf.rstkf__cashtogl_cashamt__c}" onchange="cashamtChanged();"/>
                                	&nbsp;&nbsp;&nbsp;
                                	<apex:outputText value="({!o.arcashh_glcmp__r.glcmp_cmpno__r.rstk__sycmp_homecurr__r.rstk__sycurr_currency__c})"/>
                                </apex:outputpanel>
                            </apex:pageBlockSectionItem>
                             
                        </apex:pageBlockSection>
                        
                        <script>var cashtoglRows = {}; var index = 0;</script>
                        <apex:pageBlockSection id="pbs_cashToGLEntryTable" showHeader="false" columns="2" collapsible="false" >
                            <apex:pageBlockTable id="pbt_c2glrecs" value="{!cashToGlRecs}" var="rec">
                                <apex:column headerValue="{!$Label.rstkf__col_creditaccount}">
                                    <c:simpleSelectList id="cashreceipts_glcashcracct__c" 
                                        value="{!rec.customextf.rstkf__cashreceipts_glcashcracct__c}" 
                                        options="{!cashAccounts}"/>
                                </apex:column>
                                <apex:column headerValue="{!$Label.rstkf__col_amount}">
                                    <apex:inputField id="cashtogl_cashamt__c" label="Amount" value="{!rec.customextf.rstkf__cashtogl_cashamt__c}" onchange="cashamtRowChanged('{!rec.key}');"/>
                                    <script>
                                        cashtoglRows["{!rec.key}"] = {
                                            key: "{!rec.key}",
                                            cashreceipts_glcashcracct: jQuery('select[name*=cashreceipts_glcashcracct__c]')[index],
                                            cashtogl_cashamt: document.getElementById("{!$Component.cashtogl_cashamt__c}")
                                        }
                                        index++;
                                    </script>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:pageBlockSection>
                    </apex:pageBlock>
                </apex:form>    
            </apex:outputPanel>
        </div>
    </apex:outputpanel>
   
    <apex:outputpanel id="op_arinvdue_popup">
        <div id="arinvdue" style="display:none">
            <iframe id="popArinvdue" src="" width="100%" height="500px" seamless="true" frameborder="0" marginwidth="0" marginheight="0"></iframe>
        </div>
    </apex:outputpanel>
    
    <apex:outputpanel id="op_arapplic_popup">
        <apex:outputpanel >
        <div id="arapplic" style="display:none">
            <iframe id="popArapplic" src="" width="100%" height="500px" seamless="true" frameborder="0" marginwidth="0" marginheight="0"></iframe>
        </div>
        </apex:outputpanel>
    </apex:outputpanel>
    
    <apex:outputpanel Id="depositdtpopup">
        <c:Popup popupId="DepositDatePopup" title="{!$Label.rstkf__change_deposit_date}" onOk="blockUI();depositDateChanged();" onCancel="_closeDialog();" okCaption="Save" buttonsOnTop="false">
	    	<apex:pageMessages id="depDatePageMessages"/>
	    	<apex:form id="depositdtpopup">
	    		<apex:actionFunction name="depositDateChanged" action="{!depositDateChanged}" oncomplete="checkJobStatus();" immediate="false" rerender="depDatePageMessages,op_JobStatus" />
	    		<apex:pageBlock >
		       		<apex:pageBlockSection id="pbs_jobpopup" showHeader="false" columns="1">
		       		    <apex:pageBlockSectionItem helpText="{!f_customextf.rstkf__deposit_date__c.inlineHelpText}" >
		                    	<apex:outputLabel value="{!f_customextf.rstkf__deposit_date__c.label}" />
		                    	<apex:inputField id="deposit_date__c" value="{!customextf.rstkf__deposit_date__c}"  />
			            </apex:pageBlockSectionItem>
			       </apex:pageBlockSection>
	        	</apex:pageBlock>
			    
			    <div id="depositDateWaitPopup" class="overlay">
                <span style="padding: 5px; border-radius: 5px;color: #000;background-color: #fff;">
                    Please wait...
                </span>
            </div> 
		    </apex:form>  
	    </c:Popup>
	    </apex:outputpanel>
       

    <c:footerInclude cntr="{!controller}" hideNotesAndAttachments="true"/>
    
    <script>
        
        setRequired('arcashh_bankhomeexchrate__c', true);
        setRequired('arcashh_batchamtbank__c', true);
        setRequired('arcashh_batchamthome__c', true);
        setRequired('arcashh_depdate__c', true);
		//setRequired('arcashh_trandate__c', true);
        setRequired('arcashh_poststatus__c', true);
        setSelectListRequired('arcashh_glbankacct__c');
        
        var arcashhId = "{!o.Id}";
        function openNewApplications(arcashdId) {
            var arinvdueFrame = jQuery('iframe[id*=popArinvdue]')[0];
            arinvdueFrame.src = "/apex/newpaymentapplication?arcashdId=" + arcashdId + "&arcashhId="+ arcashhId;
            showPopup('#arinvdue', 1300, 570);
        }
        
        function openEditApplications(arcashdId) {
            var arinvdueFrame = jQuery('iframe[id*=popArapplic]')[0];
            arinvdueFrame.src = "/apex/editpaymentapplication?arcashdId=" + arcashdId + "&arcashhId="+ arcashhId;
            showPopup('#arapplic', 1300, 570);
        }
        
        function newPayment() {
            window.open('/apex/' + nsp + 'arcashd', '_self');
            return false;
        }
        
        function doRecreateApplications() {
        	 recreateApplications();
            
        }
    
    
        function showPopup(popName, popWidth, popHeight) {
            var top = ((jQuery(window).height() - popHeight) / 2);
            var width = jQuery(window).width();
            var left = (width - popWidth) / 2;
            if (popWidth > width) {
                left = 0;
            } else {
                width = popWidth;
            }
            
            jQuery.blockUI({
                message: jQuery(popName),
                baseZ: 1,
                css: {
                    backgroundColor:'#fff',
                    left: (left + 'px'),
                    top: (top + 'px'),
                    width:(width + 'px'),
                    height:(popHeight + 'px'),
                    padding:'15px',
                    textAlign:'left',
                    fontSize:'1em',
                    border:'2px solid #333',
                    
                    opacity:'1.0',
                    '-moz-border-radius':'6px',
                    '-webkit-border-radius':'6px',
                    '-moz-box-shadow': '0 0 50px #ccc',
                    '-webkit-box-shadow': '0 0 50x #ccc'
                }
            });
        }

        function _showDialogCustom(forId, width, height, top)
        {
          var jel = jQuery('#'+escapeId(forId));
                    
          // Need to show the dialog before the offeset can be changed
          jel.show();
          _openDialog = jel;
          var thePopup=jel.find('.modalPopup');
          var theWin=jQuery(window);
          if (width != null) {
            thePopup.width(width);
          }
          if (height != null) {
            thePopup.height(height);
          }
                    
          if (!height)
            thePopup.css('max-height',theWin.height()*3/4);
          
          var topOffset = 200;
          if (top != null) {
            topOffset = top;
          }
        
          thePopup.offset({
            top  : topOffset + theWin.scrollTop(),
            left  : (theWin.width() - thePopup.width()) / 2
          });
          
          fixupDialog();
        
          jel.find('[tabindex]:first').focus();
          jel.keypress(function(e) {
            if (e.which == 13) // return key pressed
            {
              if (!(getSourceElement(e) instanceof HTMLTextAreaElement))
              {
                // treat as close request unless it's a TextArea
                e.preventDefault();
                _closeDialog();
              }
            }
          });
        }  
    
        function openCashToGL() {
            showPopup('#c2gl', 800, 330);
            return false;
        }

        function doSaveCashToGL() {
            var sumval = 0;
            var cashamt = getLocaleFloat(jQuery('input[id*=cashtogl_cashamt__c]')[0].value);
            
            if(cashamt <= 0) {
                alert('{!$Label.PlzSpecifyCashToGlAmtGT0}');
                return false;
            }
            
            for(var i = 0; i < 4; i++) {
                var cashtoglRow = cashtoglRows[Object.keys(cashtoglRows)[i]];
                var cashamtval = getLocaleFloat(cashtoglRow.cashtogl_cashamt.value);
                var glcashcracct = cashtoglRow.cashreceipts_glcashcracct.value;
                sumval = sumval + cashamtval;
                
                if(cashamtval > 0 && (!glcashcracct || glcashcracct.length == 0)) {
                    alert('{!$Label.CrAcctMustBeSpecifiedIfAmtIsSpecified}');
                    return false;
                }
            }
            
            sumval = sumval.toFixed(2);
            if(sumval != cashamt) {
                alert('{!$Label.SumOfAmtsDoNotMatchCashToGlAmt}');
                return false;
            }
            
            var batchamthomeVal = Number(batchamthome);
            var paymentshomeVal = Number(paymentshome);
            var availableDeposit = batchamthomeVal - paymentshomeVal;
            availableDeposit = availableDeposit.toFixed(2);
            if(cashamt > availableDeposit) {
                alert('{!$Label.cashtoglAmtCantBeGTAvailableDepositAmt}' + formatLocaleFloat(availableDeposit, 2));
                return false;
            }
            
            saveCashToGL();
            return true;
        }

        function cashamtChanged() {
            var batchamthomeVal = Number(batchamthome);
            var paymentshomeVal = Number(paymentshome);
            var availableDeposit = batchamthomeVal - paymentshomeVal;
            availableDeposit = availableDeposit.toFixed(2);
            var cashamt = getLocaleFloat(jQuery('input[id*=cashtogl_cashamt__c]')[0].value);
            
            if(cashamt > availableDeposit) {
                alert('{!$Label.cashtoglAmtCantBeGTAvailableDepositAmt}' + formatLocaleFloat(Number(availableDeposit), 2));
                return false;
            }
            
            var cashtoglRow = cashtoglRows[Object.keys(cashtoglRows)[0]];
            if(cashtoglRow.cashtogl_cashamt.value.length == 0) { 
                cashtoglRow.cashtogl_cashamt.value = jQuery('input[id*=cashtogl_cashamt__c]')[0].value;
            }
            return false;
        }

        function cashamtRowChanged(key) {
            console.log('key: ', key);
            var cashamt = getLocaleFloat(jQuery('input[id*=cashtogl_cashamt__c]')[0].value);
            var sumval = 0;
            for(var i = 0; i < 4; i++) {
                var cashtoglRow = cashtoglRows[Object.keys(cashtoglRows)[i]];
                if(isNaNLocale(cashtoglRow.cashtogl_cashamt.value)) {
                    alert('{!$Label.plzSpecifyAmtGTZero}');
                    cashtoglRow.cashtogl_cashamt.value = '0';
                    return false;
                }
                
                var thisRowCashAmt = getLocaleFloat(cashtoglRow.cashtogl_cashamt.value);
                if(thisRowCashAmt == 0) {
                	return false;
                }
                
                sumval = sumval + thisRowCashAmt;
                if(cashtoglRow.key == key) {
                    var modifiedRow = cashtoglRow;
                    var nextIndex = i + 1;
                    var nextRowAmount = cashamt - sumval;
                    
                    if(nextIndex < 4) {
                        var nextCashtoglRow = cashtoglRows[Object.keys(cashtoglRows)[nextIndex]];
                        var nextRowCurrAmount = getLocaleFloat(nextCashtoglRow.cashtogl_cashamt.value);
                        if(nextRowCurrAmount == 0 && nextRowAmount > 0) {
                            nextCashtoglRow.cashtogl_cashamt.value = formatLocaleFloat(nextRowAmount, 2);
                        }
                     }
                 }
            }
        }
        
        function resizeSections() {
            var windowWidth = jQuery(window).width();
            windowWidth = windowWidth - 60;
            var cssWidth = '' + windowWidth + 'px';
            document.getElementById('div_pbt_payments').style.width = cssWidth;
        }

        function getLocaleFloat(val) {
            return !isNumber(val) ? 0 : parseLocaleFloat(val);
        }
        
        
        function bankhomeexchrateChanged() {
            var bankhomeexchrate = getLocaleFloat(jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].value);
            var batchamtbankVal = getLocaleFloat(jQuery('input[id*=arcashh_batchamtbank__c]')[0].value); 
            var batchamthome = bankhomeexchrate != 0 ? (batchamtbankVal * bankhomeexchrate) : 0;
            jQuery('input[id*=arcashh_batchamthome__c]')[0].value = formatLocaleFloat(batchamthome, 2);
            if(bankCurrSameAsHomeCurr == 'true') {
                jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = true;
            }
        }
        
        function batchamtbankChanged() {
            var homeAmt = getLocaleFloat(jQuery('input[id*=arcashh_batchamthome__c]')[0].value);
            var bankAmt = getLocaleFloat(jQuery('input[id*=arcashh_batchamtbank__c]')[0].value);
            var bankhomeexchrate = getLocaleFloat(jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].value);
            
            if(bankAmt <= 0) {
            	alert('{!$Label.DepositAmountBankCannotBeLessThanZero}');
            	return false;
            }
            
            if(bankhomeexchrate <= 0) {
                alert('{!$Label.PlzSpecifyExchRate}');
                return false;
            }
            var batchamthomeVal = bankAmt * bankhomeexchrate;
            jQuery('input[id*=arcashh_batchamthome__c]')[0].value = formatLocaleFloat(batchamthomeVal, 2);
        }
        
        function discountgracedaysChanged() {
            var discountgracedaysIsNaN = isNaNLocale(jQuery('input[id*=arcashh_discountgracedays__c]')[0].value);
            if(discountgracedaysIsNaN) {
                alert('{!$Label.discntGraceDayShouldBeGTZero}');
                jQuery('input[id*=arcashh_discountgracedays__c]')[0].value = '0';
            }
            return false;
        }
        
        function doAfterPostDeposit() {
            if(isPostedSuccessfully == 'true') {
                alert('{!$Label.DepositPostedSuccesfully}');
                window.location.reload();
            }
        }
        
        function nopayChanged() {
        	var isnopay = jQuery('input[id*=arcashh_nopay__c]')[0].checked;
        	if(isnopay) {
        		jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].value = '0';
        		jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = true;
        		jQuery('input[id*=arcashh_batchamtbank__c]')[0].value = '0';
        		jQuery('input[id*=arcashh_batchamtbank__c]')[0].disabled = true;
        		jQuery('input[id*=arcashh_batchamthome__c]')[0].value = '0';
        		jQuery('input[id*=arcashh_batchamthome__c]')[0].disabled = true;
        		jQuery('input[id*=arcashh_discountgracedays__c]')[0].value = '0';
        		jQuery('input[id*=arcashh_discountgracedays__c]')[0].disabled = true;
        	}
        	else {
        		jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].value = '';
        		jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = false;
        		jQuery('input[id*=arcashh_batchamtbank__c]')[0].value = '';
        		jQuery('input[id*=arcashh_batchamtbank__c]')[0].disabled = false;
        		jQuery('input[id*=arcashh_batchamthome__c]')[0].value = '';
        		jQuery('input[id*=arcashh_batchamthome__c]')[0].disabled = false;
        		jQuery('input[id*=arcashh_discountgracedays__c]')[0].value = '';
        		jQuery('input[id*=arcashh_discountgracedays__c]')[0].disabled = false;
        	}
        }
        
        function pageInit(){
            if(isEdit) {
            	jQuery('input[id*=arcashh_nopay__c]')[0].disabled = true;
                jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = true;
                jQuery('input[id*=arcashh_batchamthome__c]')[0].disabled = true;
            }
            
            if(isNew || isEdit) {
            	if(isnopay == 'true') {
	        		jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].disabled = true;
	        		jQuery('input[id*=arcashh_batchamtbank__c]')[0].disabled = true;
	        		jQuery('input[id*=arcashh_batchamthome__c]')[0].disabled = true;
	        		jQuery('input[id*=arcashh_discountgracedays__c]')[0].disabled = true;
                }
            }
        }
        
        function saveRecord() {
        	var isnopay = jQuery('input[id*=arcashh_nopay__c]')[0].checked;
        	if(isnopay) {
        		return true;
        	}
        	
        	var bankomeexchrate = getLocaleFloat(jQuery('input[id*=arcashh_bankhomeexchrate__c]')[0].value);
        	if(bankomeexchrate == 0) {
        		alert('{!$Label.PlzSpecifyExchRate}');
				return false;
        	}
        	
        	var bankAmt = getLocaleFloat(jQuery('input[id*=arcashh_batchamtbank__c]')[0].value);
        	if(bankAmt <= 0) {
            	alert('{!$Label.DepositAmountBankCannotBeLessThanZero}');
            	return false;
            }
            
            return true;
        }
        
        function doAfterJobComplete(pl) {
            window.location.reload();
        }
    </script>
</apex:page>